!function e(t,i,n){function o(a,u){if(!i[a]){if(!t[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=i[a]={exports:{}};t[a][0].call(f.exports,function(e){var i=t[a][1][e];return o(i||e)},f,f.exports,e,t,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.Audio=void 0;var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=e("./audio-loader"),a=(e("../utils/utils"),e("./Track"));i.Audio=function(){function e(){n(this,e),this.tag="[Audio.js]";var t=window.AudioContext||window.webkitAudioContext;this.audioContext=new t,this.audioContextEnabled=!1,this.bpm=120,this.tickTime=60/this.bpm/4,this.isPlaying=!1,this.buffers={},this.tracks=[],this.defaultBuffersLoaded=!1,this.defaultTracksLoaded=!1,this.currentTickIndex=1,this.soundURLs={kick:"assets/audio/kick.wav",snare:"assets/audio/snare.wav",hat:"assets/audio/hat.wav",ride:"assets/audio/ride.wav"},this._loadDefaultBuffers()}return o(e,[{key:"_enableAudioContextForiOS",value:function(){}},{key:"_loadDefaultBuffers",value:function(){var e=this,t=this.audioContext,i=this.soundURLs;Promise.all([(0,r.audioLoader)(t,i.kick),(0,r.audioLoader)(t,i.snare),(0,r.audioLoader)(t,i.hat),(0,r.audioLoader)(t,i.ride)]).then(function(t){e.buffers.kick=t[0],e.buffers.snare=t[1],e.buffers.hat=t[2],e.buffers.ride=t[3],e.defaultBuffersLoaded=!0,console.log(e.buffers),e.defaultBuffersLoaded=!0,console.log("Default buffers loaded"),e._initDefaultTracks()})}},{key:"_initDefaultTracks",value:function(){if(this.defaultBuffersLoaded){this.tracks=[];var e=new a.Track(this.audioContext,"kick",this.buffers.kick);e.setTicksFromArray([1,5,9,13]);var t=new a.Track(this.audioContext,"snare",this.buffers.snare);t.setTicksFromArray([5,13]);var i=new a.Track(this.audioContext,"hat",this.buffers.hat);i.setTicksFromArray([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]),this.tracks.push(e),this.tracks.push(t),this.tracks.push(i),this.defaultTracksLoaded=!0,console.log("Default tracks loaded"),console.log(this.tracks),this._start()}}},{key:"_onBpmChanged",value:function(){this.tickTime=60/this.bpm/4}},{key:"_start",value:function(){function e(){o<=i.currentTime+t.tickTime&&(t.tracks.forEach(function(e){if(!e.mute&&e.buffer){var t=e.ticks[r];if(t.active){var n=i.createBufferSource();n.buffer=e.buffer;var a=i.createGain();n.connect(a),a.gain.value=t.volume,a.connect(e.pannerNode),n.start(o)}}}),t.currentTickIndex=r,console.log("Tick "+t.currentTickIndex),o+=t.tickTime,r+=1,r=r>16?1:r),window.setTimeout(e,0)}if(!this.isPlaying&&this.defaultTracksLoaded){this.isPlaying=!0;var t=this,i=this.audioContext,n=i.currentTime,o=n+t.tickTime,r=1;e()}}},{key:"_playSound",value:function(e,t){var i=this.audioContext,n=i.createBufferSource();n.buffer=this.buffers[e],n.connect(i.destination),n.start(t)}},{key:"bpm",get:function(){return this._bpm},set:function(e){e!==this._bpm&&(this._bpm=e,this._onBpmChanged())}},{key:"audioContextEnabled",get:function(){return this._audioContextEnabled},set:function(e){e!==this._audioContextEnabled&&(this._audioContextEnabled=e)}}]),e}()},{"../utils/utils":6,"./Track":3,"./audio-loader":4}],2:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();i.Tick=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;n(this,e),this.active=t,this.volume=i}return o(e,[{key:"volume",get:function(){return this._volume},set:function(e){this._volume=e>1?1:e}}]),e}()},{}],3:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.Track=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=e("./Tick");i.Track=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"track_default",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=(arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:1),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];n(this,e),this.name=i,this.buffer=o,this.mute=u,this.ticks=[],this.gainNode=t.createGain(),this.gainNode.gain.value=r,this.pannerNode=t.createStereoPanner(),this.pannerNode.pan.value=a,this.pannerNode.connect(this.gainNode),this.gainNode.connect(t.destination),this._initTicks()}return r(e,[{key:"setGain",value:function(e){this.gainNode.gain.value=e>1?1:e}},{key:"setPan",value:function(e){this.pannerNode.pan.value=e<-1?-1:e>1?1:e}},{key:"_initTicks",value:function(){this.ticks=[];for(var e=0;e<=16;++e)this.ticks.push(new a.Tick)}},{key:"setTick",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e<1||e>16||(this.ticks[e].volume=i,this.ticks[e].active=t)}},{key:"setTicksFromArray",value:function(e){var t=this;e.forEach(function(e){if("object"===(void 0===e?"undefined":o(e))){if(!e.index||e.index<1||e.index>16)return;var i=t.ticks[e.index];i.volume=e.volume?e.volume:1,i.active=!e.active||e.active}else t.ticks[e].active=!0})}}]),e}()},{"./Tick":2}],4:[function(e,t,i){"use strict";function n(e,t){return new Promise(function(i,n){if(!e)return void n("Missing audio context parameter.");if(!t)return void n("Missing url parameter");var o=new XMLHttpRequest;o.open("GET",t),o.responseType="arraybuffer",o.onload=function(){try{e.decodeAudioData(o.response,function(e){i(e)})}catch(e){n(e)}},o.send()})}Object.defineProperty(i,"__esModule",{value:!0}),i.audioLoader=n},{}],5:[function(e,t,i){"use strict";function n(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}function o(){var e=window.AudioContext||window.webkitAudioContext,t=new e,i=t.createBuffer(1,1,22050),n=t.createBufferSource();n.buffer=i,n.start()}function r(){var e=new a.Audio;(new dat.GUI).add(e,"bpm",60,180).onChange(function(t){e.bpm=Math.floor(e.bpm)}),$("#btn").on("click",function(){e.tracks[0].setTick(2)}),$("#muteBtn").on("click",function(){var t=e.tracks[0];t.mute=!t.mute})}var a=e("./audio/Audio");e("./audio/audio-loader");!function(){n()?($("#iOS").css({visibility:"visible"}),$("#enableAudioBtn").on("click",function(){o(),$("#iOS").css({visibility:"hidden"}),r()})):r()}()},{"./audio/Audio":1,"./audio/audio-loader":4}],6:[function(e,t,i){"use strict";function n(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}Object.defineProperty(i,"__esModule",{value:!0}),i.checkIfiOSdevice=n},{}]},{},[5]);
//# sourceMappingURL=app.bundle.min.js.map
