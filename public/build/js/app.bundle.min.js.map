{"version":3,"sources":["app.bundle.min.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_routes","_drumMachineController","_testController","_trackDirective","_tickSliderDirective","_commentDirective","_savePresetDirective","app","angular","config","initRoutes","controller","drumMachineController","testController","directive","tickSliderDirective","trackDirective","commentDirective","savePresetDirective","supportedAudioFormats","Set","add","socketEvents","newPreset","presetSaved","presetConflict","commentSaved","constant","./components/drum-machine/drumMachineController","./components/test/testController","./directives/commentDirective","./directives/savePresetDirective","./directives/tickSliderDirective","./directives/trackDirective","./routes","2","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","DrumMachine","undefined","_typeof","Symbol","iterator","obj","constructor","prototype","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","_audioLoader","_utils","_Track","this","tag","numberOfBeats","AudioContext","window","webkitAudioContext","audioContext","pannerNodeSupported","bpm","bpmMin","bpmMax","timeSignature","num","den","tickTime","isPlaying","isStopped","buffers","tracks","defaultBuffersLoaded","defaultTracksLoaded","_tracksInSolo","_tracksInMute","currentTickIndex","callBacksInLoop","soundURLs","kick","snare","hat","ride","checkIfiOSdevice","_enableAudioContextForiOS","audioContextEnabled","createStereoPanner","console","log","_this","$","document","ready","btn","visibility","on","buffer","createBuffer","source","createBufferSource","start","trigger","_this2","ctx","urls","Promise","resolve","reject","all","audioLoader","then","values","error","kickTrack","Track","setTicksFromArray","snareTrack","hatTrack","active","index","volume","id","scheduler","self","clearTimeout","timeOutID","nextTickTime","currentTime","each","track","mute","sampleData","decodedAudioBuffer","trackTick","ticks","tickSound","tickGainNode","createGain","connect","gain","gainNode","previousIndex","previousPrevious","firstLoopEnded","forEach","fn","setTimeout","startTime","bufferName","time","sound","destination","trackID","delete","hasOwnProperty","focusTrack","tracksInSolo","tracksInMute","has","solo","size","clear","push","name","keys","_createEmptyTicksArray","soundPath","pan","_this3","pannerNode","data","_this4","_clearTracks","promises","createTrack","category","_this5","trackData","fileName","ticksData","tick","JSON","stringify","get","_bpm","set","val","_onBpmChanged","../utils/utils","./Track","./audio-loader","3","Tick","arguments","4","_Tick","drumMachine","guid","extension","originalBuffer","getArrayAudioBufferFromUrl","getFileNameFromPath","setSampleData","_initTicks","arrayBuffer","decodeAudioData","arrayAudioBuffer","decodedBuffer","getExtensionFromFileName","./Tick","5","audioCtx","url","xhr","XMLHttpRequest","open","responseType","onload","response","send","6","groovyRockPreset","psyTrancePreset","7","$scope","$compile","$http","$interval","FileSaver","Blob","removeTrack","play","preventDefault","stopPropagation","playBtn","css","backgroundColor","backgroundImage","stopBtn","startSequencer","stop","stopSequencer","loadPresetFromJson","json","enableLoadingSpinner","loadPreset","bpmSlider","slider","$apply","disableLoadingSpinner","initExportMidiMenu","API","li","click","exportMidi","find","append","initPanels","initPresetsMenu","categories","remove","baseServerUrl","method","headers","Accept","presetsData","liParent","ulParent","match","_id","categoryPresets","presets","liCategory","ul","preset","after","errorResponse","initSavePresetMenu","savePreset","element","createElement","domElem","body","loadComments","enableCommentsLoadingSpinner","comments","safeApply","disableCommentsLoadingSpinner","loadingContainer","addClass","removeClass","commentsLoadingOverlay","commentsLoadingSpinner","toastError","text","toast","showHideTransition","bgColor","textColor","allowToastClose","hideAfter","stack","textAlign","position","toastOk","_DrumMachine","phase","$root","$$phase","title","ticksElements","integerval","beats","Array","fill","username","commentToPost","invalidUsernameMessage","invalidCommentMessage","categorySelected","accordion","animate","collapsible","heightStyle","beforeActivate","button","icon","updateBeatIndicators","previousTickIndex","tickIndex","beatIndicators","beatIndicatorsContainer","getElementById","getElementsByClassName","addCallBackInLoop","_start","_stop","indicators","addTrack","addEmptyTrack","notes","waitCounter","noteEventData","pitch","velocity","duration","waitParam","Content-Type","blob","type","saveAs","populateCategories","handler","formData","FormData","jsonPreset","buildJsonPreset","setRequestHeader","uploadFiles","postComment","message","onPresetCancel","onPresetSave","socket","io","scope","min","max","orientation","slide","event","ui","draggable","updateSlider","isInRangeBPM","comment","splice","../../audio/DrumMachine","../../audio/presets","8","9","restrict","replace","templateUrl","link","elem","attrs","10","tagHandler","invalidPresetNameMessage","invalidCategoryMessage","11","resizeTick","12","tickElem","ticksContainerWidth","width","Math","floor","handleFiles","files","file","fileExtension","getFileExtension","reader","FileReader","ev","result","readAsArrayBuffer","onDragOver","hasClass","onDrop","originalEvent","dataTransfer","onDragLeave","playSound","onSoloTrack","soloTrack","onMuteTrack","muteTrack","showLabel","13","$routeProvider","when","otherwise","redirectTo","14","test","navigator","userAgent","MSStream","c","random","toString","exec","path","substr","lastIndexOf"],"mappings":"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","file":"app.bundle.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * app.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nvar _routes = require(\"./routes\");\n\nvar _drumMachineController = require(\"./components/drum-machine/drumMachineController\");\n\nvar _testController = require(\"./components/test/testController\");\n\nvar _trackDirective = require(\"./directives/trackDirective\");\n\nvar _tickSliderDirective = require(\"./directives/tickSliderDirective\");\n\nvar _commentDirective = require(\"./directives/commentDirective\");\n\nvar _savePresetDirective = require(\"./directives/savePresetDirective\");\n\n(function () {\n\n    var app = angular.module(\"myApp\", [\"ngRoute\", \"ngFileSaver\", \"ngSanitize\", \"ui.select\"]);\n\n    // configure angular routes\n    app.config([\"$routeProvider\", _routes.initRoutes]);\n\n    // bind controllers\n    app.controller(\"drumMachineController\", [\"$scope\", \"$compile\", \"$http\", \"$interval\", \"FileSaver\", \"Blob\", \"socketEvents\", _drumMachineController.drumMachineController]);\n    app.controller(\"testController\", ['$scope', _testController.testController]);\n\n    // register directives\n    app.directive(\"tickSlider\", _tickSliderDirective.tickSliderDirective);\n    app.directive(\"theTrack\", [\"supportedAudioFormats\", _trackDirective.trackDirective]);\n    app.directive(\"comment\", _commentDirective.commentDirective);\n    app.directive(\"savePreset\", _savePresetDirective.savePresetDirective);\n\n    var supportedAudioFormats = new Set();\n    supportedAudioFormats.add(\"wav\");\n    supportedAudioFormats.add(\"audio/wav\");\n    supportedAudioFormats.add(\"audio/x-wav\");\n    supportedAudioFormats.add(\"mp3\");\n    supportedAudioFormats.add(\"audio/mp3\");\n    supportedAudioFormats.add(\"audio/x-mp3\");\n    supportedAudioFormats.add(\"ogg\");\n    supportedAudioFormats.add(\"audio/ogg\");\n    supportedAudioFormats.add(\"audio/x-ogg\");\n\n    var socketEvents = {\n        newPreset: \"NEW_PRESET\",\n        presetSaved: \"PRESET_SAVED\",\n        presetConflict: \"PRESET_CONFLICT\",\n        commentSaved: \"COMMENT_SAVED\"\n    };\n\n    // constants\n    app.constant(\"supportedAudioFormats\", supportedAudioFormats);\n    app.constant(\"socketEvents\", socketEvents);\n})();\n},{\"./components/drum-machine/drumMachineController\":7,\"./components/test/testController\":8,\"./directives/commentDirective\":9,\"./directives/savePresetDirective\":10,\"./directives/tickSliderDirective\":11,\"./directives/trackDirective\":12,\"./routes\":13}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.DrumMachine = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * ---------------------------------------------------------------------------------------\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * DrumMachine.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * ---------------------------------------------------------------------------------------\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _audioLoader = require(\"./audio-loader\");\n\nvar _utils = require(\"../utils/utils\");\n\nvar _Track = require(\"./Track\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DrumMachine = exports.DrumMachine = function () {\n    function DrumMachine() {\n        _classCallCheck(this, DrumMachine);\n\n        this.tag = \"[DrumMachine.js]\";\n        this.numberOfBeats = 16;\n        var AudioContext = window.AudioContext || window.webkitAudioContext;\n        this.audioContext = new AudioContext();\n        this.pannerNodeSupported = false;\n        this.bpm = 120;\n        this.bpmMin = 30;\n        this.bpmMax = 240;\n        this.timeSignature = {\n            num: 4,\n            den: 4\n        };\n        this.tickTime = 60.0 / this.bpm / 4.0; // 1/16 note\n        this.isPlaying = false;\n        this.isStopped = true;\n        this.buffers = {};\n        this.tracks = {};\n        this.defaultBuffersLoaded = false;\n        this.defaultTracksLoaded = false;\n        this._tracksInSolo = new Set();\n        this._tracksInMute = new Set();\n\n        this.currentTickIndex = 0;\n\n        this.callBacksInLoop = [];\n\n        this.soundURLs = {\n            kick: \"app/assets/audio/kick.wav\",\n            snare: \"app/assets/audio/snare.wav\",\n            hat: \"app/assets/audio/hat.wav\",\n            ride: \"app/assets/audio/ride.wav\"\n        };\n\n        if ((0, _utils.checkIfiOSdevice)()) {\n            this._enableAudioContextForiOS();\n        } else {\n            this.audioContextEnabled = true;\n        }\n\n        if (typeof this.audioContext.createStereoPanner === \"function\") {\n            this.pannerNodeSupported = true;\n            console.log(\"Stereo panner supported\");\n        } else {\n            console.log(\"Stereo panner not supported\");\n        }\n    }\n\n    /*\n     * get bpm\n     */\n\n\n    _createClass(DrumMachine, [{\n        key: \"_enableAudioContextForiOS\",\n        value: function _enableAudioContextForiOS() {\n            var _this = this;\n\n            $(document).ready(function () {\n                var btn = $(\"<button/>\", {\n                    visibility: \"hidden\"\n                });\n\n                btn.on(\"touchstart\", function () {\n                    var buffer = _this.audioContext.createBuffer(1, 1, 22050);\n                    var source = _this.audioContext.createBufferSource();\n                    source.buffer = buffer;\n                    source.start();\n\n                    _this.audioContextEnabled = true;\n                    console.log(\"AudioContext enabled for iOS\");\n                });\n\n                btn.trigger(\"touchstart\");\n            });\n        }\n    }, {\n        key: \"_loadDefaultBuffers\",\n        value: function _loadDefaultBuffers() {\n            var _this2 = this;\n\n            var ctx = this.audioContext;\n            var urls = this.soundURLs;\n\n            return new Promise(function (resolve, reject) {\n                Promise.all([(0, _audioLoader.audioLoader)(ctx, urls.kick), (0, _audioLoader.audioLoader)(ctx, urls.snare), (0, _audioLoader.audioLoader)(ctx, urls.hat), (0, _audioLoader.audioLoader)(ctx, urls.ride)]).then(function (values) {\n                    _this2.buffers[\"kick\"] = values[0];\n                    _this2.buffers[\"snare\"] = values[1];\n                    _this2.buffers[\"hat\"] = values[2];\n                    _this2.buffers[\"ride\"] = values[3];\n                    _this2.defaultBuffersLoaded = true;\n                    console.log(_this2.buffers);\n\n                    _this2.defaultBuffersLoaded = true;\n                    console.log(\"Default buffers loaded\");\n                    // this._initDefaultTracks();\n\n                    resolve(\"Default buffers loaded\");\n                }, function (error) {\n                    reject(error);\n                });\n            });\n        }\n    }, {\n        key: \"_initDefaultTracks\",\n        value: function _initDefaultTracks() {\n\n            if (!this.defaultBuffersLoaded) {\n                return;\n            }\n\n            this.tracks = {};\n\n            var kickTrack = new _Track.Track(this, \"kick\", this.buffers[\"kick\"]);\n            kickTrack.setTicksFromArray([0, 4, 8, 12]);\n            var snareTrack = new _Track.Track(this, \"snare\", this.buffers[\"snare\"], 1, 0.1);\n            snareTrack.setTicksFromArray([4, 12]);\n            var hatTrack = new _Track.Track(this, \"hat\", this.buffers[\"hat\"], 0.85, -1);\n            // hatTrack.setTicksFromArray([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]);\n\n\n            hatTrack.setTicksFromArray([{\n                active: true,\n                index: 0,\n                volume: 0.5\n            }, {\n                active: true,\n                index: 1,\n                volume: 0.5\n            }, {\n                active: true,\n                index: 2,\n                volume: 1.2\n            }, {\n                active: true,\n                index: 3,\n                volume: 0.4\n            }, {\n                active: true,\n                index: 4,\n                volume: 0.9\n            }, {\n                active: true,\n                index: 5,\n                volume: 0.5\n            }, {\n                active: true,\n                index: 6,\n                volume: 1\n            }, {\n                active: true,\n                index: 7,\n                volume: 0.4\n            }, {\n                active: true,\n                index: 8,\n                volume: 0.9\n            }, {\n                active: true,\n                index: 9,\n                volume: 0.5\n            }, {\n                active: true,\n                index: 10,\n                volume: 1\n            }, {\n                active: true,\n                index: 11,\n                volume: 0.4\n            }, {\n                active: true,\n                index: 12,\n                volume: 0.9\n            }, {\n                active: true,\n                index: 13,\n                volume: 0.5\n            }, {\n                active: true,\n                index: 14,\n                volume: 1\n            }, {\n                active: true,\n                index: 15,\n                volume: 0.4\n            }]);\n\n            this.tracks[kickTrack.id] = kickTrack;\n            this.tracks[snareTrack.id] = snareTrack;\n            this.tracks[hatTrack.id] = hatTrack;\n\n            this.defaultTracksLoaded = true;\n            console.log(\"Default tracks loaded\", this.tracks);\n\n            // this._start();\n        }\n    }, {\n        key: \"_onBpmChanged\",\n        value: function _onBpmChanged() {\n            this.tickTime = 60.0 / this.bpm / 4.0; // 1/16 note\n        }\n    }, {\n        key: \"_start\",\n        value: function _start() {\n\n            if (!this.audioContextEnabled) {\n                console.log(\"Cannot play: AudioContext is not enabled.\");\n                return;\n            }\n\n            if (this.isPlaying) {\n                console.log(\"Cannot play: it is already playing.\");\n                return;\n            }\n\n            // if (!this.defaultTracksLoaded) {\n            //     console.log(\"Cannot play: default tracks not loaded.\");\n            //     return;\n            // }\n\n\n            this.isStopped = false;\n            var self = this;\n            var ctx = this.audioContext;\n            var startTime = ctx.currentTime;\n            var nextTickTime = startTime + self.tickTime;\n            var index = 0;\n            var timeOutID = void 0;\n            var firstLoopEnded = false;\n\n            function scheduler() {\n\n                if (self.isStopped) {\n                    clearTimeout(timeOutID);\n                    self.isPlaying = false;\n                    return;\n                }\n\n                if (nextTickTime <= ctx.currentTime + self.tickTime) {\n\n                    self.isPlaying = true;\n                    self.isStopped = false;\n\n                    $.each(self.tracks, function (id, track) {\n\n                        if (track.mute) {\n                            return;\n                        }\n\n                        if (!track.sampleData.decodedAudioBuffer) {\n                            return;\n                        }\n\n                        var trackTick = track.ticks[index];\n\n                        if (!trackTick.active) {\n                            return;\n                        }\n\n                        var tickSound = ctx.createBufferSource();\n                        tickSound.buffer = track.sampleData.decodedAudioBuffer;\n                        var tickGainNode = ctx.createGain();\n                        tickSound.connect(tickGainNode);\n                        tickGainNode.gain.value = trackTick.volume;\n                        tickGainNode.connect(track.gainNode);\n                        tickSound.start(nextTickTime);\n                    });\n\n                    self.currentTickIndex = index;\n                    var previousIndex = index === 0 ? self.numberOfBeats - 1 : index - 1;\n                    var previousPrevious = previousIndex === 0 ? self.numberOfBeats - 1 : previousIndex - 1;\n\n                    // to syncronize web audio api schedule with ui beat indicators\n                    if (firstLoopEnded) {\n                        self.callBacksInLoop.forEach(function (fn) {\n                            fn(previousPrevious, previousIndex);\n                        });\n                    }\n\n                    nextTickTime += self.tickTime;\n                    index = ++index === self.numberOfBeats ? 0 : index;\n                }\n\n                firstLoopEnded = true;\n                timeOutID = window.setTimeout(scheduler, 0);\n            }\n\n            scheduler();\n        }\n    }, {\n        key: \"_stop\",\n        value: function _stop() {\n            this.isStopped = true;\n        }\n    }, {\n        key: \"_playSound\",\n        value: function _playSound(bufferName, time) {\n            var ctx = this.audioContext;\n            var sound = ctx.createBufferSource();\n            sound.buffer = this.buffers[bufferName];\n            sound.connect(ctx.destination);\n            sound.start(time);\n        }\n    }, {\n        key: \"removeTrack\",\n        value: function removeTrack(trackID) {\n            var track = this.tracks[trackID];\n            this._tracksInSolo.delete(track);\n            this._tracksInMute.delete(track);\n            delete this.tracks[trackID];\n        }\n    }, {\n        key: \"soloTrack\",\n        value: function soloTrack(trackID) {\n\n            if (!this.tracks.hasOwnProperty(trackID)) return;\n\n            var focusTrack = this.tracks[trackID];\n            var tracksInSolo = this._tracksInSolo;\n            var tracksInMute = this._tracksInMute;\n\n            // case 1: track is not in solo and not in mute\n            if (!tracksInSolo.has(focusTrack) && !tracksInMute.has(focusTrack)) {\n                tracksInSolo.add(focusTrack);\n                focusTrack.solo = true;\n                focusTrack.mute = false;\n\n                $.each(this.tracks, function (id, track) {\n                    if (id === trackID) {\n                        return;\n                    }\n\n                    if (!tracksInSolo.has(track)) {\n                        tracksInMute.add(track);\n                        track.mute = true;\n                        track.solo = false;\n                    }\n                });\n            }\n\n            // case 2: track is in solo\n            else if (tracksInSolo.has(focusTrack)) {\n                    tracksInSolo.delete(focusTrack);\n                    focusTrack.solo = false;\n\n                    if (tracksInSolo.size > 0) {\n                        tracksInMute.add(focusTrack);\n                        focusTrack.mute = true;\n                    } else {\n                        tracksInMute.clear();\n                        tracksInSolo.clear();\n                        $.each(this.tracks, function (id, track) {\n                            track.mute = false;\n                            track.solo = false;\n                        });\n                    }\n                }\n\n                // case 3: track is in mute\n                else {\n\n                        tracksInSolo.add(focusTrack);\n                        focusTrack.solo = true;\n                        focusTrack.mute = false;\n\n                        if (tracksInSolo.size === 1) {\n                            $.each(this.tracks, function (id, track) {\n                                if (id !== trackID) {\n                                    tracksInMute.add(track);\n                                    track.mute = true;\n                                }\n                            });\n                        }\n                    }\n        }\n    }, {\n        key: \"muteTrack\",\n        value: function muteTrack(trackID) {\n\n            if (!this.tracks.hasOwnProperty(trackID)) return;\n\n            var focusTrack = this.tracks[trackID];\n            var tracksInSolo = this._tracksInSolo;\n            var tracksInMute = this._tracksInMute;\n\n            // case 1: track not in solo or mute\n            if (!tracksInSolo.has(focusTrack) && !tracksInMute.has(focusTrack)) {\n                tracksInMute.add(focusTrack);\n                focusTrack.mute = true;\n                focusTrack.solo = false;\n            }\n\n            // case 2: track is in solo\n            else if (tracksInSolo.has(focusTrack)) {\n                    tracksInSolo.delete(focusTrack);\n                    tracksInMute.add(focusTrack);\n                    focusTrack.solo = false;\n                    focusTrack.mute = true;\n\n                    if (tracksInSolo.size === 0) {\n                        $.each(this.tracks, function (id, track) {\n                            if (id !== trackID) {\n                                tracksInMute.delete(track);\n                                track.mute = false;\n                            }\n                        });\n                    }\n                }\n\n                // case 3: track is in mute\n                else if (tracksInMute.has(focusTrack)) {\n                        if (tracksInSolo.size > 0) {\n                            tracksInMute.delete(focusTrack);\n                            tracksInSolo.add(focusTrack);\n                            focusTrack.mute = false;\n                            focusTrack.solo = true;\n                        } else {\n                            tracksInMute.delete(focusTrack);\n                            focusTrack.mute = false;\n                        }\n                    }\n        }\n    }, {\n        key: \"addCallBackInLoop\",\n        value: function addCallBackInLoop(fn) {\n            if (!(typeof fn === \"undefined\" ? \"undefined\" : _typeof(fn)) === \"function\") return;\n            this.callBacksInLoop.push(fn);\n        }\n    }, {\n        key: \"isInRangeBPM\",\n        value: function isInRangeBPM(value) {\n            if (value >= this.bpmMin && value <= this.bpmMax) {\n                return true;\n            } else {\n                return false;\n            }\n        }\n    }, {\n        key: \"_createEmptyTicksArray\",\n        value: function _createEmptyTicksArray() {\n            var ticks = [];\n            for (var i = 0; i < this.numberOfBeats; i++) {\n\n                ticks.push({\n                    index: i,\n                    volume: 0,\n                    active: false\n                });\n            }\n            return ticks;\n        }\n    }, {\n        key: \"_clearTracks\",\n        value: function _clearTracks() {\n            this._tracksInSolo.clear();\n            this._tracksInMute.clear();\n\n            for (var key in this.tracks) {\n                if (this.tracks.hasOwnProperty(key)) {\n                    delete this.tracks[key];\n                }\n            }\n        }\n    }, {\n        key: \"addEmptyTrack\",\n        value: function addEmptyTrack() {\n            var name = \"track_\" + (Object.keys(this.tracks).length + 1);\n            var track = new _Track.Track(this, name);\n            track.setTicksFromArray(this._createEmptyTicksArray());\n            this.tracks[track.id] = track;\n        }\n    }, {\n        key: \"createTrack\",\n        value: function createTrack(name, soundPath, volume, pan, ticks) {\n            var _this3 = this;\n\n            return new Promise(function (resolve, reject) {\n\n                var track = new _Track.Track(_this3, name, soundPath);\n\n                if (ticks) {\n                    track.setTicksFromArray(ticks);\n                } else {\n                    track.setTicksFromArray(_this3._createEmptyTicksArray());\n                }\n\n                if (volume) {\n                    track.gainNode.gain.value = volume;\n                }\n\n                if (pan) {\n                    if (track.pannerNode) {\n                        track.pannerNode.pan.value = pan;\n                    }\n                }\n\n                resolve(track);\n            });\n        }\n    }, {\n        key: \"loadPreset\",\n        value: function loadPreset(data) {\n            var _this4 = this;\n\n            try {\n                this.bpm = data.bpm;\n                this._clearTracks();\n\n                var promises = [];\n\n                data.tracks.forEach(function (track) {\n                    promises.push(_this4.createTrack(track.name, track.soundPath, track.volume, track.pan, track.ticks));\n                });\n\n                return Promise.all(promises);\n            } catch (e) {\n                return new Promise(function (resolve, reject) {\n                    reject(e);\n                });\n            }\n        }\n    }, {\n        key: \"buildJsonPreset\",\n        value: function buildJsonPreset(name, category) {\n            var _this5 = this;\n\n            var data = {\n                name: name,\n                category: category,\n                bpm: this.bpm,\n                timeSignature: this.timeSignature\n            };\n\n            var tracks = [];\n\n            for (var id in this.tracks) {\n                if (this.tracks.hasOwnProperty(id)) {\n                    (function () {\n\n                        var track = _this5.tracks[id];\n\n                        var trackData = {\n                            name: track.name,\n                            soundPath: category + \"/\" + track.sampleData.fileName,\n                            volume: track.gainNode.gain.value,\n                            pan: _this5.pannerNodeSupported ? track.pannerNode.pan.value : 0\n                        };\n\n                        var ticksData = [];\n\n                        track.ticks.forEach(function (tick) {\n                            ticksData.push({\n                                active: tick.active,\n                                index: tick.index,\n                                volume: tick.volume\n                            });\n                        });\n\n                        trackData.ticks = ticksData;\n\n                        tracks.push(trackData);\n                    })();\n                }\n            }\n\n            data.tracks = tracks;\n\n            console.log(data);\n\n            return JSON.stringify(data);\n        }\n    }, {\n        key: \"bpm\",\n        get: function get() {\n            return this._bpm;\n        }\n\n        /*\n         * set bpm\n         */\n        ,\n        set: function set(val) {\n            if (val !== this._bpm) {\n                this._bpm = val;\n                this._onBpmChanged();\n            }\n        }\n    }]);\n\n    return DrumMachine;\n}();\n},{\"../utils/utils\":14,\"./Track\":4,\"./audio-loader\":5}],3:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * Tick.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Tick = exports.Tick = function Tick() {\n    var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var active = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var volume = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1.0;\n\n    _classCallCheck(this, Tick);\n\n    this.index = index;\n    this.active = active;\n    this.volume = volume;\n}\n\n// get volume() {\n//     return this._volume;\n// }\n//\n// set volume(val) {\n//     this._volume = val > 1 ? 1.0 : val;\n// }\n\n;\n},{}],4:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * Track.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Track = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Tick = require(\"./Tick\");\n\nvar _utils = require(\"../utils/utils\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Track = exports.Track = function () {\n    function Track(drumMachine) {\n        var name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"track_default\";\n        var soundPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n        var volume = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1.0;\n\n        var _this = this;\n\n        var pan = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n        var mute = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;\n\n        _classCallCheck(this, Track);\n\n        this.id = (0, _utils.guid)();\n        this.drumMachine = drumMachine;\n        this.audioContext = drumMachine.audioContext;\n        this.name = name;\n\n        this.sampleData = {\n            fileName: \"\",\n            extension: \"\",\n            originalBuffer: undefined,\n            decodedAudioBuffer: undefined\n        };\n\n        this.solo = false;\n        this.mute = mute;\n        this.ticks = [];\n        this.pannerNodeSupported = false;\n        this.gainNode = this.audioContext.createGain();\n        this.gainNode.gain.value = volume;\n\n        if (drumMachine.pannerNodeSupported) {\n            this.pannerNode = this.audioContext.createStereoPanner();\n            this.pannerNode.pan.value = pan;\n            this.gainNode.connect(this.pannerNode);\n            this.pannerNode.connect(this.audioContext.destination);\n            this.pannerNodeSupported = true;\n        } else {\n            this.gainNode.connect(this.audioContext.destination);\n        }\n\n        if (soundPath) {\n            (0, _utils.getArrayAudioBufferFromUrl)(this.audioContext, soundPath).then(function (buffer) {\n                var fileName = (0, _utils.getFileNameFromPath)(soundPath);\n                _this.setSampleData(fileName, buffer);\n            });\n        }\n\n        this._initTicks();\n    }\n\n    // setGain(val) {\n    //     this.gainNode.gain.value = val > 1 ? 1.0 : val;\n    // }\n\n\n    // setPan(val) {\n    //     if (val < -1) {\n    //         this.pannerNode.pan.value = -1;\n    //     }\n    //     else if (val > 1) {\n    //         this.pannerNode.pan.value = 1;\n    //     }\n    //     else {\n    //         this.pannerNode.pan.value = val;\n    //     }\n    // }\n\n\n    /*\n     *\n     */\n\n\n    _createClass(Track, [{\n        key: \"_initTicks\",\n        value: function _initTicks() {\n            this.ticks = [];\n            for (var i = 0; i < this.drumMachine.numberOfBeats; ++i) {\n                this.ticks.push(new _Tick.Tick(i));\n            }\n        }\n    }, {\n        key: \"setTick\",\n        value: function setTick(index) {\n            var active = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n            var volume = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1.0;\n\n            if (index < 0 || index > this.drumMachine.numberOfBeats - 1) {\n                return;\n            }\n\n            this.ticks[index].volume = volume;\n            this.ticks[index].active = active;\n        }\n    }, {\n        key: \"setTicksFromArray\",\n        value: function setTicksFromArray(data) {\n            var _this2 = this;\n\n            data.forEach(function (e) {\n                if ((typeof e === \"undefined\" ? \"undefined\" : _typeof(e)) === \"object\") {\n                    if (e.index === \"undefined\" || e.index < 0 || e.index > _this2.drumMachine.numberOfBeats - 1) {\n                        return;\n                    }\n\n                    _this2.ticks[e.index].volume = e.volume !== \"undefined\" ? e.volume : 0;\n                    _this2.ticks[e.index].active = e.active !== \"undefined\" ? e.active : false;\n                } else {\n                    _this2.ticks[e].active = true;\n                }\n            });\n        }\n\n        // setBuffer(buffer, fileName) {\n        //     this.buffer = buffer;\n        //     console.log(\"Track \" + this.name + \": audio buffer changed ( \" + fileName + \" )\");\n        // }\n\n\n    }, {\n        key: \"setBuffer\",\n        value: function setBuffer(arrayBuffer, fileName) {\n            var _this3 = this;\n\n            this.originalBuffer = arrayBuffer;\n            this.drumMachine.audioContext.decodeAudioData(arrayBuffer, function (decodedAudioBuffer) {\n                _this3.buffer = decodedAudioBuffer;\n                console.log(\"Track \" + _this3.name + \": audio buffer changed ( \" + fileName + \" )\");\n            });\n        }\n    }, {\n        key: \"playSound\",\n        value: function playSound() {\n            if (!this.audioContext || !this.sampleData.decodedAudioBuffer) return;\n            var sound = this.audioContext.createBufferSource();\n            sound.buffer = this.sampleData.decodedAudioBuffer;\n            sound.connect(this.audioContext.destination);\n            sound.start();\n        }\n    }, {\n        key: \"setSampleData\",\n        value: function setSampleData(fileName, arrayAudioBuffer) {\n            var _this4 = this;\n\n            if (!fileName || !arrayAudioBuffer) {\n                console.log(\"Missing fileName and/or arrayAudioBuffer parameters\");\n                return;\n            }\n\n            this.drumMachine.audioContext.decodeAudioData(arrayAudioBuffer, function (decodedBuffer) {\n                _this4.sampleData.fileName = fileName;\n                _this4.sampleData.extension = (0, _utils.getExtensionFromFileName)(fileName);\n                _this4.sampleData.originalBuffer = arrayAudioBuffer;\n                _this4.sampleData.decodedAudioBuffer = decodedBuffer;\n            });\n        }\n    }]);\n\n    return Track;\n}();\n},{\"../utils/utils\":14,\"./Tick\":3}],5:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * audio-loader.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.audioLoader = audioLoader;\nfunction audioLoader(audioCtx, url) {\n\n    return new Promise(function (resolve, reject) {\n\n        if (!audioCtx) {\n            reject(\"Missing audio context parameter.\");\n            return;\n        }\n\n        if (!url) {\n            reject(\"Missing url parameter\");\n            return;\n        }\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"GET\", url);\n        xhr.responseType = \"arraybuffer\";\n\n        xhr.onload = function () {\n            try {\n                audioCtx.decodeAudioData(xhr.response, function (decodedBuffer) {\n                    resolve(decodedBuffer);\n                });\n            } catch (e) {\n                reject(e);\n            }\n        };\n\n        xhr.send();\n    });\n}\n},{}],6:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * ---------------------------------------------------------------------------------------\n * presets.js\n * ---------------------------------------------------------------------------------------\n */\n\nvar groovyRockPreset = exports.groovyRockPreset = {\n    name: \"Groovy rock\",\n    bpm: 120,\n    category: \"Rock\",\n    timeSignature: {\n        num: 4,\n        den: 4\n    },\n    tracks: [{\n        name: \"kick\",\n        soundPath: \"app/assets/audio/rock-metal/rock-kick.wav\",\n        volume: 1,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 0,\n            volume: 1\n        }, {\n            active: true,\n            index: 4,\n            volume: 1\n        }, {\n            active: true,\n            index: 8,\n            volume: 1\n        }, {\n            active: true,\n            index: 10,\n            volume: 1\n        }, {\n            active: true,\n            index: 12,\n            volume: 1\n        }]\n    }, {\n        name: \"snare\",\n        soundPath: \"app/assets/audio/rock-metal/rock-snare.wav\",\n        volume: 1,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 4,\n            volume: 1\n        }, {\n            active: true,\n            index: 12,\n            volume: 1\n        }]\n    }, {\n        name: \"ghost-snare\",\n        soundPath: \"app/assets/audio/rock-metal/rock-snare-ghost.wav\",\n        volume: 1,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 15,\n            volume: 1\n        }]\n    }, {\n        name: \"hh open\",\n        soundPath: \"app/assets/audio/rock-metal/rock-hh-open.wav\",\n        volume: 0.4,\n        pan: 0.5,\n        ticks: [{\n            active: true,\n            index: 4,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 8,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 12,\n            volume: 0.8\n        }]\n    }, {\n        name: \"crash\",\n        soundPath: \"app/assets/audio/rock-metal/rock-crash.wav\",\n        volume: 0.5,\n        pan: -0.5,\n        ticks: [{\n            active: true,\n            index: 0,\n            volume: 0.8\n        }]\n    }]\n};\n\nvar psyTrancePreset = exports.psyTrancePreset = {\n    name: \"psy-trance\",\n    category: \"Trance\",\n    bpm: 145,\n    timeSignature: {\n        num: 4,\n        den: 4\n    },\n    tracks: [{\n        name: \"kick\",\n        soundPath: \"app/assets/audio/trance/trance-kick.wav\",\n        volume: 1,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 0,\n            volume: 1\n        }, {\n            active: true,\n            index: 4,\n            volume: 1\n        }, {\n            active: true,\n            index: 8,\n            volume: 1\n        }, {\n            active: true,\n            index: 12,\n            volume: 1\n        }]\n    }, {\n        name: \"clap\",\n        soundPath: \"app/assets/audio/trance/trance-clap.wav\",\n        volume: 1,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 4,\n            volume: 1\n        }, {\n            active: true,\n            index: 12,\n            volume: 1\n        }]\n    }, {\n        name: \"hh open\",\n        soundPath: \"app/assets/audio/trance/trance-hh-open.wav\",\n        volume: 0.8,\n        pan: 0.2,\n        ticks: [{\n            active: true,\n            index: 2,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 6,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 10,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 14,\n            volume: 0.8\n        }]\n    }, {\n        name: \"bass\",\n        soundPath: \"app/assets/audio/trance/trance-bass-A1.wav\",\n        volume: 0.8,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 1,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 2,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 3,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 5,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 6,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 7,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 9,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 10,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 11,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 13,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 14,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 15,\n            volume: 0.8\n        }]\n    }]\n};\n},{}],7:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.drumMachineController = drumMachineController;\n\nvar _DrumMachine = require(\"../../audio/DrumMachine\");\n\nvar _presets = require(\"../../audio/presets\");\n\n// const baseServerUrl = \"http://localhost:4500\";\n// const baseServerUrl = \"http://192.168.1.72:4500\";\n// const baseServerUrl = \"http://192.168.1.75:4500\";\nvar baseServerUrl = \"https://groove-monkey.herokuapp.com\"; /**\n                                                            * ---------------------------------------------------------------------------------------\n                                                            * mainController.js\n                                                            * ---------------------------------------------------------------------------------------\n                                                            */\n\nfunction drumMachineController($scope, $compile, $http, $interval, FileSaver, Blob, socketEvents) {\n\n    var drumMachine = new _DrumMachine.DrumMachine();\n    var loadingContainer = $(\"#loadingContainer\");\n    var commentsLoadingOverlay = $(\"#commentsLoadingOverlay\");\n    var commentsLoadingSpinner = $(\"#commentsLoadingSpinner\");\n    var playBtn = $(\"#sequencerPlayButton\");\n    var stopBtn = $(\"#sequencerStopButton\");\n    var bpmSlider = $(\"#sequencerBPMslider\");\n\n    $scope.safeApply = function (fn) {\n        var phase = this.$root.$$phase;\n        if (phase == '$apply' || phase == '$digest') {\n            if (fn && typeof fn === 'function') {\n                fn();\n            }\n        } else {\n            this.$apply(fn);\n        }\n    };\n\n    $scope.title = \"Main Controller\";\n    $scope.tracks = [];\n    $scope.ticksElements = [];\n    $scope.bpm = drumMachine.bpm;\n    $scope.isPlaying = drumMachine.isPlaying;\n    $scope.isStopped = drumMachine.isStopped;\n    $scope.removeTrack = removeTrack;\n    $scope.integerval = /^\\d*$/;\n    $scope.beats = new Array(drumMachine.numberOfBeats).fill(false);\n    $scope.username = \"\";\n    $scope.commentToPost = \"\";\n    $scope.comments = [];\n    $scope.invalidUsernameMessage = \"Give ya a name! (3-32 characters)\";\n    $scope.invalidCommentMessage = \"Write something cool! (3-1000 characters)\";\n\n    $scope.preset = {\n        name: \"\",\n        categorySelected: undefined,\n        categories: []\n    };\n\n    $scope.tracks = drumMachine.tracks;\n    $scope.safeApply();\n\n    /*\n     * ---------------------------------------------------------------------------------------\n     * UI\n     * ---------------------------------------------------------------------------------------\n     */\n\n    $(\"#accordion\").accordion({\n        animate: 200,\n        collapsible: true,\n        active: false,\n        heightStyle: \"content\",\n        // icons: { \"header\": \"ui-icon-plus\", \"activeHeader\": \"ui-icon-minus\" },\n        beforeActivate: function beforeActivate() {\n            if ($scope.comments.length === 0) {\n                loadComments();\n            }\n        }\n    });\n\n    $(\"#postCommentBtn\").button({\n        icon: \"ui-icon-pencil\"\n    });\n\n    /*\n     * ---------------------------------------------------------------------------------------\n     * event listeners\n     * ---------------------------------------------------------------------------------------\n     */\n\n    $(window).ready(function () {\n\n        var beatIndicatorsContainer = document.getElementById(\"beatIndicators\");\n        var beatIndicators = beatIndicatorsContainer.getElementsByClassName(\"beat-indicator\");\n\n        function updateBeatIndicators(previousTickIndex, tickIndex) {\n            $(beatIndicators[previousTickIndex]).removeClass(\"beat-indicator-active\");\n            $(beatIndicators[tickIndex]).addClass(\"beat-indicator-active\");\n        }\n\n        drumMachine.addCallBackInLoop(updateBeatIndicators);\n    });\n\n    /*\n    window.addEventListener(\"keyup\", (e) => {\n        switch (e.keyCode) {\n             case 32:\n                 if($(\"textarea#commentArea, input#usernameInput\").is(\":focus\")){\n                    e.preventDefault();\n                    e.stopPropagation();\n                }\n                else if ($scope.isStopped) {\n                    play(e);\n                } else {\n                    stop(e);\n                }\n                break;\n             default:\n                break;\n        }\n    });\n      // remove scroll down on spacebar\n    window.addEventListener('keydown', function(e) {\n        if(e.keyCode === 32 && e.target === document.body) {\n            e.preventDefault();\n        }\n    });\n    */\n\n    /*\n     * ---------------------------------------------------------------------------------------\n     * public\n     * ---------------------------------------------------------------------------------------\n     */\n\n    $scope.startSequencer = function () {\n        drumMachine._start();\n        $scope.isPlaying = true;\n        $scope.isStopped = false;\n    };\n\n    $scope.stopSequencer = function () {\n        drumMachine._stop();\n        $scope.isPlaying = false;\n        $scope.isStopped = true;\n        var indicators = document.getElementById(\"beatIndicators\").getElementsByClassName(\"beat-indicator\");\n        $(indicators).removeClass(\"beat-indicator-active\");\n    };\n\n    $scope.addTrack = function () {\n        drumMachine.addEmptyTrack();\n    };\n\n    $scope.exportMidi = function () {\n\n        var tracks = [];\n        for (var key in drumMachine.tracks) {\n            if (drumMachine.tracks.hasOwnProperty(key)) {\n                (function () {\n\n                    var track = drumMachine.tracks[key];\n                    var trackData = {\n                        name: track.name,\n                        notes: []\n                    };\n\n                    var waitCounter = 0;\n                    track.ticks.forEach(function (tick) {\n\n                        if (tick.active) {\n                            var noteEventData = {\n                                pitch: [\"C4\"],\n                                velocity: tick.volume,\n                                duration: \"16\" // 1/16\n                            };\n\n                            if (waitCounter > 0) {\n                                var waitParam = \"T\" + waitCounter * 32; //number of ticks to wait (each tick is 1/128)\n                                noteEventData[\"wait\"] = waitParam;\n                            }\n\n                            trackData.notes.push(noteEventData);\n                            waitCounter = 0;\n                        } else {\n                            waitCounter += 1;\n                        }\n                    });\n\n                    tracks.push(trackData);\n                })();\n            }\n        }\n\n        var data = {\n            bpm: drumMachine.bpm,\n            timeSignature: { num: 4, den: 4 },\n            tracks: tracks\n        };\n\n        $http({\n            url: baseServerUrl + '/api/midi',\n            method: \"POST\",\n            responseType: \"arraybuffer\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            data: JSON.stringify(data)\n\n        }).then(function (response) {\n            console.log(response);\n            var blob = new Blob([response.data], { type: 'audio/midi' });\n            // let fileName = response.headers('content-disposition');\n            FileSaver.saveAs(blob, \"loop.mid\");\n        }, function (response) {\n            console.log(response);\n        });\n    };\n\n    $scope.populateCategories = function () {\n        return new Promise(function (resolve, reject) {\n            $http({\n                url: baseServerUrl + \"/api/categories\",\n                method: \"GET\",\n                headers: {\n                    \"Accept\": \"application/json\"\n                }\n            }).then(function (response) {\n                // console.log(response);\n                var categories = response.data;\n                // categories.forEach(c => {\n                //     $scope.categories.push(c.name);\n                // });\n                $scope.preset.categories = categories;\n                resolve(categories);\n            }, function (error) {\n                console.log(error);\n                reject(error);\n            });\n        });\n    };\n\n    $scope.loadPreset = function () {\n\n        $http({\n            url: baseServerUrl + \"/api/presets\",\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n        }).then(function (response) {\n\n            var presets = response.data;\n            if (presets.length === 0) {\n                return;\n            }\n\n            drumMachine.loadPreset(presets[0]).then(function (tracks) {\n\n                tracks.forEach(function (t) {\n                    drumMachine.tracks[t.id] = t;\n                });\n\n                $scope.bpm = drumMachine.bpm;\n                bpmSlider.slider(\"value\", $scope.bpm);\n                $scope.$apply();\n            }, function (error) {\n                console.log(error);\n            });\n        }, function (errorResponse) {\n            console.log(errorResponse);\n        });\n    };\n\n    $scope.savePreset = function () {\n\n        var formData = new FormData();\n        var jsonPreset = drumMachine.buildJsonPreset($scope.preset.name, $scope.preset.categorySelected.name);\n\n        for (var id in drumMachine.tracks) {\n\n            if (drumMachine.tracks.hasOwnProperty(id)) {\n                var track = drumMachine.tracks[id];\n\n                var blob = new Blob([track.sampleData.originalBuffer], {\n                    // type: track.sampleData.extension ? \"audio/\" + track.sampleData.extension : \"octet-stream\"\n                    type: \"octet-stream\"\n                });\n\n                formData.append(\"sample\", blob, track.sampleData.fileName);\n            }\n        }\n\n        formData.append(\"preset\", jsonPreset);\n\n        var xhr = new XMLHttpRequest();\n\n        xhr.open('POST', baseServerUrl + '/api/presets', true);\n        xhr.setRequestHeader(\"Accept\", \"application/json\");\n        xhr.onload = handler;\n        xhr.send(formData);\n\n        function handler(e) {\n            console.log(e);\n        }\n    };\n\n    $scope.uploadFiles = function () {\n\n        var formData = new FormData();\n\n        // $('input[type=\"file\"]').each(function(index) {\n        //\n        //     let fileList = $(this)[0].files;\n        //\n        //     for(let i = 0; i < fileList.length; i++) {\n        //         let file = fileList[i];\n        //         formData.append(file.name, file);\n        //     }\n        // });\n\n\n        // drumMachine.tracks.forEach(track => {\n        //\n        //     console.log(track);\n        //     let buffer = track.buffer;\n        //     let blob = new Blob(buffer);\n        //     formData.append(track.name, blob, \"campione.wav\");\n        //\n        // });\n\n        for (var id in drumMachine.tracks) {\n            if (drumMachine.tracks.hasOwnProperty(id)) {\n                var track = drumMachine.tracks[id];\n\n                var blob = new Blob([track.sampleData.originalBuffer], {\n                    // type: track.sampleData.extension ? \"audio/\" + track.sampleData.extension : \"octet-stream\"\n                    type: \"octet-stream\"\n                });\n\n                formData.append(\"sample\", blob, track.sampleData.fileName);\n            }\n        }\n\n        var obj = {\n            name: \"track\",\n            bpm: 120,\n            tracks: [{\n                name: \"kick\"\n            }, {\n                name: \"snare\"\n            }]\n        };\n\n        formData.append(\"preset\", JSON.stringify(obj));\n\n        var xhr = new XMLHttpRequest();\n\n        xhr.open('POST', baseServerUrl + '/api/upload', true);\n        xhr.setRequestHeader(\"Accept\", \"application/json\");\n        xhr.onload = handler;\n        xhr.send(formData);\n\n        function handler(e) {\n            console.log(e);\n        }\n\n        // $http({\n        //     url: \"http://localhost:4500/upload\",\n        //     method: \"POST\",\n        //     transformRequest: angular.identity,\n        //     header: {\n        //         \"Content-Type\": undefined,\n        //     },\n        //     data: formData\n        // }).then(response => {\n        //     console.log(response);\n        // }, error => {\n        //     console.log(error);\n        // });\n\n    };\n\n    $scope.postComment = function () {\n\n        var data = {\n            username: $scope.username,\n            message: $scope.commentToPost\n        };\n\n        $http({\n            url: baseServerUrl + '/api/comments',\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\"\n            },\n            data: JSON.stringify(data)\n\n        }).then(function (response) {\n            console.log(response);\n        }, function (response) {\n            console.log(response);\n        });\n    };\n\n    $scope.onPresetCancel = function () {\n        $(\".save-preset-container\").remove();\n    };\n\n    $scope.onPresetSave = function () {\n        $scope.savePreset();\n    };\n\n    /*\n     * ---------------------------------------------------------------------------------------\n     * private\n     * ---------------------------------------------------------------------------------------\n     */\n\n    function removeTrack(track) {\n        drumMachine.removeTrack(track.id);\n    }\n\n    function initDefaultTracks($scope, drumMachine) {\n\n        enableLoadingSpinner();\n\n        drumMachine._loadDefaultBuffers().then(function () {\n            drumMachine._initDefaultTracks();\n            $scope.tracks = drumMachine.tracks;\n            $scope.$apply();\n            disableLoadingSpinner();\n        }, function (error) {\n            console.log(error);\n        });\n    }\n\n    function initDATgui(drumMachine) {\n        var gui = new dat.GUI();\n        var bpmController = gui.add(drumMachine, \"bpm\", 50.0, 220.0);\n\n        bpmController.onChange(function (value) {\n            drumMachine.bpm = Math.floor(drumMachine.bpm);\n        });\n    }\n\n    function initSequencerControls(scope, drumMachine) {\n\n        playBtn.on(\"mousedown touchstart\", function (e) {\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            playBtn.css({\n                backgroundColor: \"#444\"\n            });\n        });\n\n        playBtn.on(\"mouseup touchend\", function (e) {\n            play(e);\n        });\n\n        stopBtn.on(\"mousedown touchstart\", function (e) {\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            stopBtn.css({\n                backgroundColor: \"#444\"\n            });\n        });\n\n        stopBtn.on(\"mouseup touchend\", function (e) {\n            stop(e);\n        });\n\n        bpmSlider.slider({\n            min: drumMachine.bpmMin,\n            max: drumMachine.bpmMax,\n            orientation: \"horizontal\",\n            value: scope.bpm,\n            slide: function slide(event, ui) {\n                drumMachine.bpm = ui.value;\n                scope.bpm = ui.value;\n                scope.$apply();\n            }\n        }).draggable();\n\n        scope.updateSlider = function () {\n            if (drumMachine.isInRangeBPM(scope.bpm)) {\n                bpmSlider.slider(\"value\", scope.bpm);\n                drumMachine.bpm = scope.bpm;\n            }\n        };\n    }\n\n    function play(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        playBtn.css({\n            backgroundColor: \"transparent\",\n            backgroundImage: \"url(./app/assets/icons/Play-50-green.png)\"\n        });\n\n        stopBtn.css({\n            backgroundColor: \"transparent\",\n            backgroundImage: \"url(./app/assets/icons/Stop-50-white.png)\"\n        });\n\n        $scope.startSequencer();\n    }\n\n    function stop(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        stopBtn.css({\n            backgroundColor: \"transparent\",\n            backgroundImage: \"url(./app/assets/icons/Stop-50-red.png)\"\n        });\n\n        playBtn.css({\n            backgroundColor: \"transparent\",\n            backgroundImage: \"url(./app/assets/icons/Play-50-white.png)\"\n        });\n\n        $scope.stopSequencer();\n    }\n\n    function loadPresetFromJson(json) {\n\n        enableLoadingSpinner();\n\n        drumMachine.loadPreset(json).then(function (tracks) {\n\n            tracks.forEach(function (t) {\n                drumMachine.tracks[t.id] = t;\n            });\n\n            $scope.bpm = drumMachine.bpm;\n            bpmSlider.slider(\"value\", $scope.bpm);\n            $scope.$apply();\n            disableLoadingSpinner();\n        }, function (error) {\n            console.log(error);\n        });\n    }\n\n    function initExportMidiMenu() {\n\n        var API = $(\"nav#menu\").data(\"mmenu\");\n        var li = $('<li><a href=\"#exportMidi\" >Export midi</a></li>');\n        li.click($scope.exportMidi);\n\n        $(\"#menu-list\").find(\".mm-listview\").append(li);\n\n        API.initPanels($(\"#menu-list\"));\n    }\n\n    function initPresetsMenu(categories) {\n\n        $('li[id=\"presetsMenu\"]').remove();\n\n        $http({\n            url: baseServerUrl + \"/api/presets\",\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n        }).then(function (response) {\n\n            var presetsData = response.data;\n            if (presetsData.length === 0) {\n                return;\n            }\n\n            var liParent = $('<li id=\"presetsMenu\"><a href=\"#\">Presets</a></li>');\n            var ulParent = $(\"<ul></ul>\");\n            liParent.append(ulParent);\n\n            categories.forEach(function (category) {\n\n                var match = presetsData.find(function (e) {\n                    return e._id === category.name;\n                });\n\n                if (!match) {\n                    return;\n                }\n\n                var categoryPresets = match.presets;\n\n                var liCategory = $('<li><a href=\"#\">' + category.name + '</a></li>');\n                var ul = $(\"<ul></ul>\");\n\n                categoryPresets.forEach(function (preset) {\n                    var li = $('<li><a href=\"#\">' + preset.name + '</a></li>');\n                    li.click(function () {\n                        loadPresetFromJson(preset);\n                    });\n\n                    ul.append(li);\n                });\n\n                liCategory.append(ul);\n                ulParent.append(liCategory);\n            });\n\n            var API = $(\"nav#menu\").data(\"mmenu\");\n            $(\"#menu-list\").find(\".mm-listview li:first\").after(liParent);\n            API.initPanels($(\"#menu-list\"));\n        }, function (errorResponse) {\n            console.log(errorResponse);\n            initExportMidiMenu();\n        });\n    }\n\n    function initSavePresetMenu() {\n        var li = $('<li><a href=\"#\">Save preset</a></li>');\n\n        li.click(function () {\n            var savePreset = angular.element(document.createElement('save-preset'));\n            var domElem = $compile(savePreset)($scope);\n            angular.element(document.body).append(domElem);\n        });\n\n        var API = $(\"nav#menu\").data(\"mmenu\");\n        $(\"#menu-list\").find(\".mm-listview\").append(li);\n        API.initPanels($(\"#menu-list\"));\n    }\n\n    function loadComments() {\n\n        enableCommentsLoadingSpinner();\n\n        $http({\n            url: baseServerUrl + '/api/comments',\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n\n        }).then(function (response) {\n            console.log(response);\n            $scope.comments = response.data;\n            $scope.safeApply();\n            disableCommentsLoadingSpinner();\n        }, function (response) {\n            console.log(response);\n        });\n    }\n\n    function enableLoadingSpinner() {\n        setTimeout(function () {\n            loadingContainer.addClass(\"loading-active\");\n        }, 0);\n    }\n\n    function disableLoadingSpinner() {\n        setTimeout(function () {\n            loadingContainer.removeClass(\"loading-active\");\n        }, 1500);\n    }\n\n    function enableCommentsLoadingSpinner() {\n        setTimeout(function () {\n            commentsLoadingOverlay.addClass(\"loading-active\");\n            commentsLoadingSpinner.addClass(\"loading-active\");\n        }, 100);\n    }\n\n    function disableCommentsLoadingSpinner() {\n        setTimeout(function () {\n            commentsLoadingOverlay.removeClass(\"loading-active\");\n            commentsLoadingSpinner.removeClass(\"loading-active\");\n        }, 100);\n    }\n\n    function toastError(text) {\n        $.toast({\n            text: text,\n            showHideTransition: 'slide', // It can be plain, fade or slide\n            bgColor: '#ff4a40', // Background color for toast\n            textColor: '#fff', // text color\n            allowToastClose: false, // Show the close button or not\n            hideAfter: 3000, // `false` to make it sticky or time in miliseconds to hide after\n            stack: 5, // `fakse` to show one stack at a time count showing the number of toasts that can be shown at once\n            textAlign: 'left', // Alignment of text i.e. left, right, center\n            position: 'top-right' // bottom-left or bottom-right or bottom-center or top-left or top-right or top-center or mid-center or an object representing the left, right, top, bottom values to position the toast on page\n        });\n    }\n\n    function toastOk(text) {\n        $.toast({\n            text: text,\n            showHideTransition: 'slide', // It can be plain, fade or slide\n            bgColor: '#05a2fc', // Background color for toast\n            textColor: '#fff', // text color\n            allowToastClose: false, // Show the close button or not\n            hideAfter: 3000, // `false` to make it sticky or time in miliseconds to hide after\n            stack: 5, // `fakse` to show one stack at a time count showing the number of toasts that can be shown at once\n            textAlign: 'left', // Alignment of text i.e. left, right, center\n            position: 'top-right' // bottom-left or bottom-right or bottom-center or top-left or top-right or top-center or mid-center or an object representing the left, right, top, bottom values to position the toast on page\n        });\n    }\n\n    /**\n     * ---------------------------------------------------------------------------------------\n     * init\n     * ---------------------------------------------------------------------------------------\n     */\n\n    var socket = io.connect(baseServerUrl);\n    initSequencerControls($scope, drumMachine);\n\n    $(window).ready(function () {\n        initSavePresetMenu();\n        initExportMidiMenu();\n\n        $scope.populateCategories().then(function (categories) {\n            initPresetsMenu(categories);\n        });\n\n        $interval(function () {\n            $scope.populateCategories().then(function (categories) {\n                console.log(\"$interval: populateCategories\");\n            });\n        }, 20000);\n\n        socket.on(socketEvents.newPreset, function (data) {\n            console.log(socketEvents.presetSaved, data);\n            initPresetsMenu($scope.preset.categories);\n        });\n\n        socket.on(socketEvents.presetSaved, function (data) {\n            toastOk(\"Preset saved!\");\n            $scope.onPresetCancel();\n        });\n\n        socket.on(socketEvents.presetConflict, function (data) {\n            console.log(socketEvents.presetConflict, data);\n            toastError(data);\n        });\n\n        socket.on(socketEvents.commentSaved, function (comment) {\n            // toastOk(\"Comment posted!\");\n            $scope.comments.splice(0, 0, comment);\n            $scope.commentToPost = \"\";\n            $scope.safeApply();\n        });\n    });\n}\n},{\"../../audio/DrumMachine\":2,\"../../audio/presets\":6}],8:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.testController = testController;\n/*\n * ---------------------------------------------------------------------------------------\n * testController.js\n * ---------------------------------------------------------------------------------------\n */\n\nfunction testController($scope) {\n\n    $scope.title = \"Test Controller\";\n    console.log(\"Test Controller\");\n}\n},{}],9:[function(require,module,exports){\n/**\n * ---------------------------------------------------------------------------------------\n * commentDirective.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.commentDirective = commentDirective;\nfunction commentDirective() {\n\n    return {\n        restrict: 'AE',\n        replace: 'false',\n        templateUrl: \"app/directives/templates/commentDirective.html\",\n        link: function link(scope, elem, attrs) {}\n    };\n}\n},{}],10:[function(require,module,exports){\n/**\n * ---------------------------------------------------------------------------------------\n * savePresetDirective.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.savePresetDirective = savePresetDirective;\nfunction savePresetDirective() {\n\n    return {\n        restrict: 'AE',\n        replace: 'false',\n        templateUrl: \"app/directives/templates/savePreset.html\",\n        link: function link(scope, elem, attrs) {\n\n            scope.tagHandler = function (tag) {\n                return null;\n            };\n\n            scope.invalidPresetNameMessage = \"Choose a preset name (6-32 characters)\";\n            scope.invalidCategoryMessage = \"Choose a category\";\n\n            function initUI() {\n\n                $(\"#presetCancelBtn\").button();\n                $(\"#presetSaveBtn\").button();\n            }\n\n            /**\n             * ---------------------------------------------------------------------------------------\n             * init\n             * ---------------------------------------------------------------------------------------\n             */\n\n            initUI();\n        }\n\n    };\n}\n},{}],11:[function(require,module,exports){\n/**\n * ---------------------------------------------------------------------------------------\n * tickSliderDirective.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.tickSliderDirective = tickSliderDirective;\nfunction tickSliderDirective() {\n\n    return {\n        restrict: 'AE',\n        replace: 'false',\n        scope: {\n            tick: \"=\",\n            ticksElements: \"=\",\n            resizeTick: \"=\"\n        },\n        link: function link(scope, elem, attrs) {\n\n            // console.log(scope.tick);\n            scope.ticksElements.push(elem);\n\n            elem.slider({\n                min: 0,\n                max: 100,\n                orientation: \"vertical\",\n                value: scope.tick.active ? scope.tick.volume * 100 : 0,\n                slide: function slide(event, ui) {\n\n                    if (ui.value === 0) {\n                        scope.tick.active = false;\n                    } else {\n                        scope.tick.active = true;\n                    }\n\n                    scope.tick.volume = ui.value * 0.01;\n                    // console.log(scope.tick.volume);\n                }\n            }).draggable();\n\n            // scope.resizeTick(elem);\n        }\n    };\n}\n},{}],12:[function(require,module,exports){\n/**\n * ---------------------------------------------------------------------------------------\n * trackDirective\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.trackDirective = trackDirective;\n\nvar _utils = require(\"../utils/utils\");\n\nfunction trackDirective(supportedAudioFormats) {\n\n    return {\n        restrict: 'AE',\n        replace: 'false',\n        scope: {\n            track: \"=\",\n            ticksElements: \"=\",\n            removeTrack: \"=\"\n        },\n        templateUrl: \"app/directives/templates/trackDirective.html\",\n        link: function link(scope, elem, attrs) {\n\n            scope.resizeTick = resizeTick;\n            scope.handleFiles = handleFiles;\n            scope.playSound = playSound;\n            scope.onSoloTrack = onSoloTrack;\n            scope.onMuteTrack = onMuteTrack;\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * styles & widgets\n             * ---------------------------------------------------------------------------------------\n             */\n\n            elem.find('button[name=\"removeTrackButton\"]').button({\n                icon: \"ui-icon-close\",\n                showLabel: false\n            });\n\n            elem.find('button[name=\"playSoundButton\"]').button({\n                icon: \"ui-icon-circle-triangle-e\",\n                showLabel: false\n            });\n\n            elem.find('div[id=\"trackVolumeSlider\"]').slider({\n                min: 0,\n                max: 100,\n                orientation: \"horizontal\",\n                value: scope.track.gainNode.gain.value * 100,\n                slide: function slide(event, ui) {\n                    scope.track.gainNode.gain.value = ui.value * 0.01;\n                }\n            }).draggable();\n\n            if (scope.track.pannerNodeSupported) {\n                elem.find('div[id=\"trackPanSlider\"]').slider({\n                    min: -100,\n                    max: 100,\n                    orientation: \"horizontal\",\n                    value: scope.track.pannerNode.pan.value * 100,\n                    slide: function slide(event, ui) {\n                        scope.track.pannerNode.pan.value = ui.value * 0.01;\n                    }\n                }).draggable();\n            } else {\n                elem.find('div[id=\"trackPanSlider\"]').remove();\n                elem.find(\".pan-label\").remove();\n\n                // push down volume slider\n                elem.find('div[id=\"trackVolumeSlider\"]').css({\n                    // marginTop: 0,\n                    // position: \"relative\",\n                    // bottom: 0\n                });\n            }\n\n            elem.find('button[name=soloTrackButton]').button({});\n\n            elem.find('button[name=muteTrackButton]').button({});\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * event listeners\n             * ---------------------------------------------------------------------------------------\n             */\n\n            // $(window).resize(() => {\n            //     scope.ticksElements.forEach((e) => {\n            //         resizeTick(e);\n            //     });\n            // });\n\n\n            elem.on(\"dragover\", onDragOver);\n            elem.on(\"drop\", onDrop);\n            elem.on(\"dragleave\", onDragLeave);\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * private functions\n             * ---------------------------------------------------------------------------------------\n             */\n\n            function resizeTick(tickElem) {\n                var ticksContainerWidth = elem.find(\".ticks-container\").width();\n                console.log(ticksContainerWidth);\n                var margin = 8;\n                var tickWidth = Math.floor((ticksContainerWidth - 15 * margin) / 16.0);\n\n                // tickElem.css({\n                //     width: 32,\n                //     marginRight: \"8px !important\"\n                // });\n\n\n                // tickElem.parent().css({\n                //     width: tickWidth,\n                //     marginRight: margin\n                // });\n\n\n                // tickElem.find(\".ui-slider-handle\").css({\n                //\n                // });\n            }\n\n            function handleFiles(files) {\n                if (!files || files.length < 1) return;\n\n                var file = files[0];\n                var fileExtension = (0, _utils.getFileExtension)(file.name);\n\n                // chech if it is an audio file with a supported extension\n                if (!supportedAudioFormats.has(fileExtension)) {\n                    console.log(\"File format not supported by Web Audio API: \", fileExtension);\n                    return;\n                }\n\n                var reader = new FileReader();\n\n                reader.onload = function (ev) {\n                    var arrayBuffer = ev.target.result;\n                    scope.track.setSampleData(file.name, arrayBuffer);\n                };\n\n                reader.readAsArrayBuffer(file);\n            }\n\n            function onDragOver(e) {\n                if (!elem.hasClass(\"track-dragfile\")) {\n                    elem.addClass(\"track-dragfile\");\n                }\n                e.stopPropagation();\n                e.preventDefault();\n            }\n\n            function onDrop(e) {\n                e.stopPropagation();\n                e.preventDefault();\n                handleFiles(e.originalEvent.dataTransfer.files);\n                onDragLeave();\n            }\n\n            function onDragLeave(e) {\n                if (elem.hasClass(\"track-dragfile\")) {\n                    elem.removeClass(\"track-dragfile\");\n                }\n                if (e) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                }\n            }\n\n            function playSound() {\n                scope.track.playSound();\n            }\n\n            function onSoloTrack() {\n                scope.track.drumMachine.soloTrack(scope.track.id);\n            }\n\n            function onMuteTrack() {\n                scope.track.drumMachine.muteTrack(scope.track.id);\n            }\n        }\n    };\n}\n},{\"../utils/utils\":14}],13:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.initRoutes = initRoutes;\n/*\n * ---------------------------------------------------------------------------------------\n * routes.js\n * ---------------------------------------------------------------------------------------\n */\n\nfunction initRoutes($routeProvider) {\n\n    $routeProvider.when('/', {\n        controller: \"drumMachineController\",\n        templateUrl: \"app/components/drum-machine/drumMachineView.html\"\n    });\n\n    $routeProvider.when('/test', {\n        controller: \"testController\",\n        templateUrl: \"app/components/test/testView.html\"\n    });\n\n    $routeProvider.otherwise({ redirectTo: '/' });\n}\n},{}],14:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * utils.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\n/*\n * checkIfiOSdevice\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.checkIfiOSdevice = checkIfiOSdevice;\nexports.guid = guid;\nexports.getExtensionFromFileName = getExtensionFromFileName;\nexports.getFileNameFromPath = getFileNameFromPath;\nexports.getArrayAudioBufferFromUrl = getArrayAudioBufferFromUrl;\nexports.getFileExtension = getFileExtension;\nfunction checkIfiOSdevice() {\n    return (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream\n    );\n}\n\n/*\n * generate uuid\n */\nfunction guid() {\n    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = Math.random() * 16 | 0,\n            v = c == 'x' ? r : r & 0x3 | 0x8;\n        return v.toString(16);\n    });\n    return uuid;\n}\n\nfunction getExtensionFromFileName(fileName) {\n    var re = /(?:\\.([^.]+))?$/;\n    var ext = re.exec(fileName)[1];\n    return ext;\n}\n\nfunction getFileNameFromPath(path) {\n    return path.replace(/^.*[\\\\\\/]/, '');\n}\n\nfunction getArrayAudioBufferFromUrl(audioCtx, url) {\n\n    return new Promise(function (resolve, reject) {\n\n        if (!audioCtx) {\n            reject(\"Missing audio context parameter.\");\n            return;\n        }\n\n        if (!url) {\n            reject(\"Missing url parameter\");\n            return;\n        }\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"GET\", url);\n        xhr.responseType = \"arraybuffer\";\n\n        xhr.onload = function () {\n            resolve(xhr.response);\n        };\n\n        xhr.send();\n    });\n}\n\nfunction getFileExtension(fileName) {\n    return fileName.substr(fileName.lastIndexOf('.') + 1);\n}\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJwdWJsaWMvYXBwL2FwcC5qcyIsInB1YmxpYy9hcHAvYXVkaW8vRHJ1bU1hY2hpbmUuanMiLCJwdWJsaWMvYXBwL2F1ZGlvL1RpY2suanMiLCJwdWJsaWMvYXBwL2F1ZGlvL1RyYWNrLmpzIiwicHVibGljL2FwcC9hdWRpby9hdWRpby1sb2FkZXIuanMiLCJwdWJsaWMvYXBwL2F1ZGlvL3ByZXNldHMuanMiLCJwdWJsaWMvYXBwL2NvbXBvbmVudHMvZHJ1bS1tYWNoaW5lL2RydW1NYWNoaW5lQ29udHJvbGxlci5qcyIsInB1YmxpYy9hcHAvY29tcG9uZW50cy90ZXN0L3Rlc3RDb250cm9sbGVyLmpzIiwicHVibGljL2FwcC9kaXJlY3RpdmVzL2NvbW1lbnREaXJlY3RpdmUuanMiLCJwdWJsaWMvYXBwL2RpcmVjdGl2ZXMvc2F2ZVByZXNldERpcmVjdGl2ZS5qcyIsInB1YmxpYy9hcHAvZGlyZWN0aXZlcy90aWNrU2xpZGVyRGlyZWN0aXZlLmpzIiwicHVibGljL2FwcC9kaXJlY3RpdmVzL3RyYWNrRGlyZWN0aXZlLmpzIiwicHVibGljL2FwcC9yb3V0ZXMuanMiLCJwdWJsaWMvYXBwL3V0aWxzL3V0aWxzLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeG1CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIGFwcC5qc1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBfcm91dGVzID0gcmVxdWlyZShcIi4vcm91dGVzXCIpO1xuXG52YXIgX2RydW1NYWNoaW5lQ29udHJvbGxlciA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudHMvZHJ1bS1tYWNoaW5lL2RydW1NYWNoaW5lQ29udHJvbGxlclwiKTtcblxudmFyIF90ZXN0Q29udHJvbGxlciA9IHJlcXVpcmUoXCIuL2NvbXBvbmVudHMvdGVzdC90ZXN0Q29udHJvbGxlclwiKTtcblxudmFyIF90cmFja0RpcmVjdGl2ZSA9IHJlcXVpcmUoXCIuL2RpcmVjdGl2ZXMvdHJhY2tEaXJlY3RpdmVcIik7XG5cbnZhciBfdGlja1NsaWRlckRpcmVjdGl2ZSA9IHJlcXVpcmUoXCIuL2RpcmVjdGl2ZXMvdGlja1NsaWRlckRpcmVjdGl2ZVwiKTtcblxudmFyIF9jb21tZW50RGlyZWN0aXZlID0gcmVxdWlyZShcIi4vZGlyZWN0aXZlcy9jb21tZW50RGlyZWN0aXZlXCIpO1xuXG52YXIgX3NhdmVQcmVzZXREaXJlY3RpdmUgPSByZXF1aXJlKFwiLi9kaXJlY3RpdmVzL3NhdmVQcmVzZXREaXJlY3RpdmVcIik7XG5cbihmdW5jdGlvbiAoKSB7XG5cbiAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoXCJteUFwcFwiLCBbXCJuZ1JvdXRlXCIsIFwibmdGaWxlU2F2ZXJcIiwgXCJuZ1Nhbml0aXplXCIsIFwidWkuc2VsZWN0XCJdKTtcblxuICAgIC8vIGNvbmZpZ3VyZSBhbmd1bGFyIHJvdXRlc1xuICAgIGFwcC5jb25maWcoW1wiJHJvdXRlUHJvdmlkZXJcIiwgX3JvdXRlcy5pbml0Um91dGVzXSk7XG5cbiAgICAvLyBiaW5kIGNvbnRyb2xsZXJzXG4gICAgYXBwLmNvbnRyb2xsZXIoXCJkcnVtTWFjaGluZUNvbnRyb2xsZXJcIiwgW1wiJHNjb3BlXCIsIFwiJGNvbXBpbGVcIiwgXCIkaHR0cFwiLCBcIiRpbnRlcnZhbFwiLCBcIkZpbGVTYXZlclwiLCBcIkJsb2JcIiwgXCJzb2NrZXRFdmVudHNcIiwgX2RydW1NYWNoaW5lQ29udHJvbGxlci5kcnVtTWFjaGluZUNvbnRyb2xsZXJdKTtcbiAgICBhcHAuY29udHJvbGxlcihcInRlc3RDb250cm9sbGVyXCIsIFsnJHNjb3BlJywgX3Rlc3RDb250cm9sbGVyLnRlc3RDb250cm9sbGVyXSk7XG5cbiAgICAvLyByZWdpc3RlciBkaXJlY3RpdmVzXG4gICAgYXBwLmRpcmVjdGl2ZShcInRpY2tTbGlkZXJcIiwgX3RpY2tTbGlkZXJEaXJlY3RpdmUudGlja1NsaWRlckRpcmVjdGl2ZSk7XG4gICAgYXBwLmRpcmVjdGl2ZShcInRoZVRyYWNrXCIsIFtcInN1cHBvcnRlZEF1ZGlvRm9ybWF0c1wiLCBfdHJhY2tEaXJlY3RpdmUudHJhY2tEaXJlY3RpdmVdKTtcbiAgICBhcHAuZGlyZWN0aXZlKFwiY29tbWVudFwiLCBfY29tbWVudERpcmVjdGl2ZS5jb21tZW50RGlyZWN0aXZlKTtcbiAgICBhcHAuZGlyZWN0aXZlKFwic2F2ZVByZXNldFwiLCBfc2F2ZVByZXNldERpcmVjdGl2ZS5zYXZlUHJlc2V0RGlyZWN0aXZlKTtcblxuICAgIHZhciBzdXBwb3J0ZWRBdWRpb0Zvcm1hdHMgPSBuZXcgU2V0KCk7XG4gICAgc3VwcG9ydGVkQXVkaW9Gb3JtYXRzLmFkZChcIndhdlwiKTtcbiAgICBzdXBwb3J0ZWRBdWRpb0Zvcm1hdHMuYWRkKFwiYXVkaW8vd2F2XCIpO1xuICAgIHN1cHBvcnRlZEF1ZGlvRm9ybWF0cy5hZGQoXCJhdWRpby94LXdhdlwiKTtcbiAgICBzdXBwb3J0ZWRBdWRpb0Zvcm1hdHMuYWRkKFwibXAzXCIpO1xuICAgIHN1cHBvcnRlZEF1ZGlvRm9ybWF0cy5hZGQoXCJhdWRpby9tcDNcIik7XG4gICAgc3VwcG9ydGVkQXVkaW9Gb3JtYXRzLmFkZChcImF1ZGlvL3gtbXAzXCIpO1xuICAgIHN1cHBvcnRlZEF1ZGlvRm9ybWF0cy5hZGQoXCJvZ2dcIik7XG4gICAgc3VwcG9ydGVkQXVkaW9Gb3JtYXRzLmFkZChcImF1ZGlvL29nZ1wiKTtcbiAgICBzdXBwb3J0ZWRBdWRpb0Zvcm1hdHMuYWRkKFwiYXVkaW8veC1vZ2dcIik7XG5cbiAgICB2YXIgc29ja2V0RXZlbnRzID0ge1xuICAgICAgICBuZXdQcmVzZXQ6IFwiTkVXX1BSRVNFVFwiLFxuICAgICAgICBwcmVzZXRTYXZlZDogXCJQUkVTRVRfU0FWRURcIixcbiAgICAgICAgcHJlc2V0Q29uZmxpY3Q6IFwiUFJFU0VUX0NPTkZMSUNUXCIsXG4gICAgICAgIGNvbW1lbnRTYXZlZDogXCJDT01NRU5UX1NBVkVEXCJcbiAgICB9O1xuXG4gICAgLy8gY29uc3RhbnRzXG4gICAgYXBwLmNvbnN0YW50KFwic3VwcG9ydGVkQXVkaW9Gb3JtYXRzXCIsIHN1cHBvcnRlZEF1ZGlvRm9ybWF0cyk7XG4gICAgYXBwLmNvbnN0YW50KFwic29ja2V0RXZlbnRzXCIsIHNvY2tldEV2ZW50cyk7XG59KSgpOyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkRydW1NYWNoaW5lID0gdW5kZWZpbmVkO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogRHJ1bU1hY2hpbmUuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9hdWRpb0xvYWRlciA9IHJlcXVpcmUoXCIuL2F1ZGlvLWxvYWRlclwiKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuLi91dGlscy91dGlsc1wiKTtcblxudmFyIF9UcmFjayA9IHJlcXVpcmUoXCIuL1RyYWNrXCIpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgRHJ1bU1hY2hpbmUgPSBleHBvcnRzLkRydW1NYWNoaW5lID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIERydW1NYWNoaW5lKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRHJ1bU1hY2hpbmUpO1xuXG4gICAgICAgIHRoaXMudGFnID0gXCJbRHJ1bU1hY2hpbmUuanNdXCI7XG4gICAgICAgIHRoaXMubnVtYmVyT2ZCZWF0cyA9IDE2O1xuICAgICAgICB2YXIgQXVkaW9Db250ZXh0ID0gd2luZG93LkF1ZGlvQ29udGV4dCB8fCB3aW5kb3cud2Via2l0QXVkaW9Db250ZXh0O1xuICAgICAgICB0aGlzLmF1ZGlvQ29udGV4dCA9IG5ldyBBdWRpb0NvbnRleHQoKTtcbiAgICAgICAgdGhpcy5wYW5uZXJOb2RlU3VwcG9ydGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuYnBtID0gMTIwO1xuICAgICAgICB0aGlzLmJwbU1pbiA9IDMwO1xuICAgICAgICB0aGlzLmJwbU1heCA9IDI0MDtcbiAgICAgICAgdGhpcy50aW1lU2lnbmF0dXJlID0ge1xuICAgICAgICAgICAgbnVtOiA0LFxuICAgICAgICAgICAgZGVuOiA0XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudGlja1RpbWUgPSA2MC4wIC8gdGhpcy5icG0gLyA0LjA7IC8vIDEvMTYgbm90ZVxuICAgICAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzU3RvcHBlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuYnVmZmVycyA9IHt9O1xuICAgICAgICB0aGlzLnRyYWNrcyA9IHt9O1xuICAgICAgICB0aGlzLmRlZmF1bHRCdWZmZXJzTG9hZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZGVmYXVsdFRyYWNrc0xvYWRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl90cmFja3NJblNvbG8gPSBuZXcgU2V0KCk7XG4gICAgICAgIHRoaXMuX3RyYWNrc0luTXV0ZSA9IG5ldyBTZXQoKTtcblxuICAgICAgICB0aGlzLmN1cnJlbnRUaWNrSW5kZXggPSAwO1xuXG4gICAgICAgIHRoaXMuY2FsbEJhY2tzSW5Mb29wID0gW107XG5cbiAgICAgICAgdGhpcy5zb3VuZFVSTHMgPSB7XG4gICAgICAgICAgICBraWNrOiBcImFwcC9hc3NldHMvYXVkaW8va2ljay53YXZcIixcbiAgICAgICAgICAgIHNuYXJlOiBcImFwcC9hc3NldHMvYXVkaW8vc25hcmUud2F2XCIsXG4gICAgICAgICAgICBoYXQ6IFwiYXBwL2Fzc2V0cy9hdWRpby9oYXQud2F2XCIsXG4gICAgICAgICAgICByaWRlOiBcImFwcC9hc3NldHMvYXVkaW8vcmlkZS53YXZcIlxuICAgICAgICB9O1xuXG4gICAgICAgIGlmICgoMCwgX3V0aWxzLmNoZWNrSWZpT1NkZXZpY2UpKCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2VuYWJsZUF1ZGlvQ29udGV4dEZvcmlPUygpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hdWRpb0NvbnRleHRFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlU3RlcmVvUGFubmVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRoaXMucGFubmVyTm9kZVN1cHBvcnRlZCA9IHRydWU7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlN0ZXJlbyBwYW5uZXIgc3VwcG9ydGVkXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTdGVyZW8gcGFubmVyIG5vdCBzdXBwb3J0ZWRcIik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKlxuICAgICAqIGdldCBicG1cbiAgICAgKi9cblxuXG4gICAgX2NyZWF0ZUNsYXNzKERydW1NYWNoaW5lLCBbe1xuICAgICAgICBrZXk6IFwiX2VuYWJsZUF1ZGlvQ29udGV4dEZvcmlPU1wiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2VuYWJsZUF1ZGlvQ29udGV4dEZvcmlPUygpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgYnRuID0gJChcIjxidXR0b24vPlwiLCB7XG4gICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6IFwiaGlkZGVuXCJcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGJ0bi5vbihcInRvdWNoc3RhcnRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYnVmZmVyID0gX3RoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZUJ1ZmZlcigxLCAxLCAyMjA1MCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBfdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZS5idWZmZXIgPSBidWZmZXI7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZS5zdGFydCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmF1ZGlvQ29udGV4dEVuYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkF1ZGlvQ29udGV4dCBlbmFibGVkIGZvciBpT1NcIik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBidG4udHJpZ2dlcihcInRvdWNoc3RhcnRcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcIl9sb2FkRGVmYXVsdEJ1ZmZlcnNcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9sb2FkRGVmYXVsdEJ1ZmZlcnMoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGN0eCA9IHRoaXMuYXVkaW9Db250ZXh0O1xuICAgICAgICAgICAgdmFyIHVybHMgPSB0aGlzLnNvdW5kVVJMcztcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChbKDAsIF9hdWRpb0xvYWRlci5hdWRpb0xvYWRlcikoY3R4LCB1cmxzLmtpY2spLCAoMCwgX2F1ZGlvTG9hZGVyLmF1ZGlvTG9hZGVyKShjdHgsIHVybHMuc25hcmUpLCAoMCwgX2F1ZGlvTG9hZGVyLmF1ZGlvTG9hZGVyKShjdHgsIHVybHMuaGF0KSwgKDAsIF9hdWRpb0xvYWRlci5hdWRpb0xvYWRlcikoY3R4LCB1cmxzLnJpZGUpXSkudGhlbihmdW5jdGlvbiAodmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5idWZmZXJzW1wia2lja1wiXSA9IHZhbHVlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLmJ1ZmZlcnNbXCJzbmFyZVwiXSA9IHZhbHVlc1sxXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLmJ1ZmZlcnNbXCJoYXRcIl0gPSB2YWx1ZXNbMl07XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5idWZmZXJzW1wicmlkZVwiXSA9IHZhbHVlc1szXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLmRlZmF1bHRCdWZmZXJzTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coX3RoaXMyLmJ1ZmZlcnMpO1xuXG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5kZWZhdWx0QnVmZmVyc0xvYWRlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGVmYXVsdCBidWZmZXJzIGxvYWRlZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5faW5pdERlZmF1bHRUcmFja3MoKTtcblxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFwiRGVmYXVsdCBidWZmZXJzIGxvYWRlZFwiKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiX2luaXREZWZhdWx0VHJhY2tzXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaW5pdERlZmF1bHRUcmFja3MoKSB7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5kZWZhdWx0QnVmZmVyc0xvYWRlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50cmFja3MgPSB7fTtcblxuICAgICAgICAgICAgdmFyIGtpY2tUcmFjayA9IG5ldyBfVHJhY2suVHJhY2sodGhpcywgXCJraWNrXCIsIHRoaXMuYnVmZmVyc1tcImtpY2tcIl0pO1xuICAgICAgICAgICAga2lja1RyYWNrLnNldFRpY2tzRnJvbUFycmF5KFswLCA0LCA4LCAxMl0pO1xuICAgICAgICAgICAgdmFyIHNuYXJlVHJhY2sgPSBuZXcgX1RyYWNrLlRyYWNrKHRoaXMsIFwic25hcmVcIiwgdGhpcy5idWZmZXJzW1wic25hcmVcIl0sIDEsIDAuMSk7XG4gICAgICAgICAgICBzbmFyZVRyYWNrLnNldFRpY2tzRnJvbUFycmF5KFs0LCAxMl0pO1xuICAgICAgICAgICAgdmFyIGhhdFRyYWNrID0gbmV3IF9UcmFjay5UcmFjayh0aGlzLCBcImhhdFwiLCB0aGlzLmJ1ZmZlcnNbXCJoYXRcIl0sIDAuODUsIC0xKTtcbiAgICAgICAgICAgIC8vIGhhdFRyYWNrLnNldFRpY2tzRnJvbUFycmF5KFsxLDIsMyw0LDUsNiw3LDgsOSwxMCwxMSwxMiwxMywxNCwxNSwxNl0pO1xuXG5cbiAgICAgICAgICAgIGhhdFRyYWNrLnNldFRpY2tzRnJvbUFycmF5KFt7XG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGV4OiAwLFxuICAgICAgICAgICAgICAgIHZvbHVtZTogMC41XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGV4OiAxLFxuICAgICAgICAgICAgICAgIHZvbHVtZTogMC41XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGV4OiAyLFxuICAgICAgICAgICAgICAgIHZvbHVtZTogMS4yXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGV4OiAzLFxuICAgICAgICAgICAgICAgIHZvbHVtZTogMC40XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGV4OiA0LFxuICAgICAgICAgICAgICAgIHZvbHVtZTogMC45XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGV4OiA1LFxuICAgICAgICAgICAgICAgIHZvbHVtZTogMC41XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGV4OiA2LFxuICAgICAgICAgICAgICAgIHZvbHVtZTogMVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpbmRleDogNyxcbiAgICAgICAgICAgICAgICB2b2x1bWU6IDAuNFxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpbmRleDogOCxcbiAgICAgICAgICAgICAgICB2b2x1bWU6IDAuOVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpbmRleDogOSxcbiAgICAgICAgICAgICAgICB2b2x1bWU6IDAuNVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpbmRleDogMTAsXG4gICAgICAgICAgICAgICAgdm9sdW1lOiAxXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGV4OiAxMSxcbiAgICAgICAgICAgICAgICB2b2x1bWU6IDAuNFxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpbmRleDogMTIsXG4gICAgICAgICAgICAgICAgdm9sdW1lOiAwLjlcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICAgICAgaW5kZXg6IDEzLFxuICAgICAgICAgICAgICAgIHZvbHVtZTogMC41XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGluZGV4OiAxNCxcbiAgICAgICAgICAgICAgICB2b2x1bWU6IDFcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICAgICAgaW5kZXg6IDE1LFxuICAgICAgICAgICAgICAgIHZvbHVtZTogMC40XG4gICAgICAgICAgICB9XSk7XG5cbiAgICAgICAgICAgIHRoaXMudHJhY2tzW2tpY2tUcmFjay5pZF0gPSBraWNrVHJhY2s7XG4gICAgICAgICAgICB0aGlzLnRyYWNrc1tzbmFyZVRyYWNrLmlkXSA9IHNuYXJlVHJhY2s7XG4gICAgICAgICAgICB0aGlzLnRyYWNrc1toYXRUcmFjay5pZF0gPSBoYXRUcmFjaztcblxuICAgICAgICAgICAgdGhpcy5kZWZhdWx0VHJhY2tzTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRGVmYXVsdCB0cmFja3MgbG9hZGVkXCIsIHRoaXMudHJhY2tzKTtcblxuICAgICAgICAgICAgLy8gdGhpcy5fc3RhcnQoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcIl9vbkJwbUNoYW5nZWRcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkJwbUNoYW5nZWQoKSB7XG4gICAgICAgICAgICB0aGlzLnRpY2tUaW1lID0gNjAuMCAvIHRoaXMuYnBtIC8gNC4wOyAvLyAxLzE2IG5vdGVcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcIl9zdGFydFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3N0YXJ0KCkge1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMuYXVkaW9Db250ZXh0RW5hYmxlZCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ2Fubm90IHBsYXk6IEF1ZGlvQ29udGV4dCBpcyBub3QgZW5hYmxlZC5cIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNhbm5vdCBwbGF5OiBpdCBpcyBhbHJlYWR5IHBsYXlpbmcuXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgKCF0aGlzLmRlZmF1bHRUcmFja3NMb2FkZWQpIHtcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhcIkNhbm5vdCBwbGF5OiBkZWZhdWx0IHRyYWNrcyBub3QgbG9hZGVkLlwiKTtcbiAgICAgICAgICAgIC8vICAgICByZXR1cm47XG4gICAgICAgICAgICAvLyB9XG5cblxuICAgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgICAgIHZhciBjdHggPSB0aGlzLmF1ZGlvQ29udGV4dDtcbiAgICAgICAgICAgIHZhciBzdGFydFRpbWUgPSBjdHguY3VycmVudFRpbWU7XG4gICAgICAgICAgICB2YXIgbmV4dFRpY2tUaW1lID0gc3RhcnRUaW1lICsgc2VsZi50aWNrVGltZTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IDA7XG4gICAgICAgICAgICB2YXIgdGltZU91dElEID0gdm9pZCAwO1xuICAgICAgICAgICAgdmFyIGZpcnN0TG9vcEVuZGVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHNjaGVkdWxlcigpIHtcblxuICAgICAgICAgICAgICAgIGlmIChzZWxmLmlzU3RvcHBlZCkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZU91dElEKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pc1BsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChuZXh0VGlja1RpbWUgPD0gY3R4LmN1cnJlbnRUaW1lICsgc2VsZi50aWNrVGltZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaXNQbGF5aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pc1N0b3BwZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goc2VsZi50cmFja3MsIGZ1bmN0aW9uIChpZCwgdHJhY2spIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyYWNrLm11dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdHJhY2suc2FtcGxlRGF0YS5kZWNvZGVkQXVkaW9CdWZmZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0cmFja1RpY2sgPSB0cmFjay50aWNrc1tpbmRleF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdHJhY2tUaWNrLmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpY2tTb3VuZCA9IGN0eC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2tTb3VuZC5idWZmZXIgPSB0cmFjay5zYW1wbGVEYXRhLmRlY29kZWRBdWRpb0J1ZmZlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aWNrR2Fpbk5vZGUgPSBjdHguY3JlYXRlR2FpbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGlja1NvdW5kLmNvbm5lY3QodGlja0dhaW5Ob2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2tHYWluTm9kZS5nYWluLnZhbHVlID0gdHJhY2tUaWNrLnZvbHVtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2tHYWluTm9kZS5jb25uZWN0KHRyYWNrLmdhaW5Ob2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2tTb3VuZC5zdGFydChuZXh0VGlja1RpbWUpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRUaWNrSW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZpb3VzSW5kZXggPSBpbmRleCA9PT0gMCA/IHNlbGYubnVtYmVyT2ZCZWF0cyAtIDEgOiBpbmRleCAtIDE7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmV2aW91c1ByZXZpb3VzID0gcHJldmlvdXNJbmRleCA9PT0gMCA/IHNlbGYubnVtYmVyT2ZCZWF0cyAtIDEgOiBwcmV2aW91c0luZGV4IC0gMTtcblxuICAgICAgICAgICAgICAgICAgICAvLyB0byBzeW5jcm9uaXplIHdlYiBhdWRpbyBhcGkgc2NoZWR1bGUgd2l0aCB1aSBiZWF0IGluZGljYXRvcnNcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0TG9vcEVuZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGxCYWNrc0luTG9vcC5mb3JFYWNoKGZ1bmN0aW9uIChmbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZuKHByZXZpb3VzUHJldmlvdXMsIHByZXZpb3VzSW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBuZXh0VGlja1RpbWUgKz0gc2VsZi50aWNrVGltZTtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSArK2luZGV4ID09PSBzZWxmLm51bWJlck9mQmVhdHMgPyAwIDogaW5kZXg7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgZmlyc3RMb29wRW5kZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRpbWVPdXRJRCA9IHdpbmRvdy5zZXRUaW1lb3V0KHNjaGVkdWxlciwgMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNjaGVkdWxlcigpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiX3N0b3BcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zdG9wKCkge1xuICAgICAgICAgICAgdGhpcy5pc1N0b3BwZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiX3BsYXlTb3VuZFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BsYXlTb3VuZChidWZmZXJOYW1lLCB0aW1lKSB7XG4gICAgICAgICAgICB2YXIgY3R4ID0gdGhpcy5hdWRpb0NvbnRleHQ7XG4gICAgICAgICAgICB2YXIgc291bmQgPSBjdHguY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICAgICAgICBzb3VuZC5idWZmZXIgPSB0aGlzLmJ1ZmZlcnNbYnVmZmVyTmFtZV07XG4gICAgICAgICAgICBzb3VuZC5jb25uZWN0KGN0eC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICBzb3VuZC5zdGFydCh0aW1lKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcInJlbW92ZVRyYWNrXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVUcmFjayh0cmFja0lEKSB7XG4gICAgICAgICAgICB2YXIgdHJhY2sgPSB0aGlzLnRyYWNrc1t0cmFja0lEXTtcbiAgICAgICAgICAgIHRoaXMuX3RyYWNrc0luU29sby5kZWxldGUodHJhY2spO1xuICAgICAgICAgICAgdGhpcy5fdHJhY2tzSW5NdXRlLmRlbGV0ZSh0cmFjayk7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy50cmFja3NbdHJhY2tJRF07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJzb2xvVHJhY2tcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNvbG9UcmFjayh0cmFja0lEKSB7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy50cmFja3MuaGFzT3duUHJvcGVydHkodHJhY2tJRCkpIHJldHVybjtcblxuICAgICAgICAgICAgdmFyIGZvY3VzVHJhY2sgPSB0aGlzLnRyYWNrc1t0cmFja0lEXTtcbiAgICAgICAgICAgIHZhciB0cmFja3NJblNvbG8gPSB0aGlzLl90cmFja3NJblNvbG87XG4gICAgICAgICAgICB2YXIgdHJhY2tzSW5NdXRlID0gdGhpcy5fdHJhY2tzSW5NdXRlO1xuXG4gICAgICAgICAgICAvLyBjYXNlIDE6IHRyYWNrIGlzIG5vdCBpbiBzb2xvIGFuZCBub3QgaW4gbXV0ZVxuICAgICAgICAgICAgaWYgKCF0cmFja3NJblNvbG8uaGFzKGZvY3VzVHJhY2spICYmICF0cmFja3NJbk11dGUuaGFzKGZvY3VzVHJhY2spKSB7XG4gICAgICAgICAgICAgICAgdHJhY2tzSW5Tb2xvLmFkZChmb2N1c1RyYWNrKTtcbiAgICAgICAgICAgICAgICBmb2N1c1RyYWNrLnNvbG8gPSB0cnVlO1xuICAgICAgICAgICAgICAgIGZvY3VzVHJhY2subXV0ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgJC5lYWNoKHRoaXMudHJhY2tzLCBmdW5jdGlvbiAoaWQsIHRyYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpZCA9PT0gdHJhY2tJRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0cmFja3NJblNvbG8uaGFzKHRyYWNrKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tzSW5NdXRlLmFkZCh0cmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFjay5tdXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrLnNvbG8gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjYXNlIDI6IHRyYWNrIGlzIGluIHNvbG9cbiAgICAgICAgICAgIGVsc2UgaWYgKHRyYWNrc0luU29sby5oYXMoZm9jdXNUcmFjaykpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tzSW5Tb2xvLmRlbGV0ZShmb2N1c1RyYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNUcmFjay5zb2xvID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRyYWNrc0luU29sby5zaXplID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tzSW5NdXRlLmFkZChmb2N1c1RyYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzVHJhY2subXV0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFja3NJbk11dGUuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrc0luU29sby5jbGVhcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKHRoaXMudHJhY2tzLCBmdW5jdGlvbiAoaWQsIHRyYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2subXV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrLnNvbG8gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gY2FzZSAzOiB0cmFjayBpcyBpbiBtdXRlXG4gICAgICAgICAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrc0luU29sby5hZGQoZm9jdXNUcmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb2N1c1RyYWNrLnNvbG8gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNUcmFjay5tdXRlID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0cmFja3NJblNvbG8uc2l6ZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaCh0aGlzLnRyYWNrcywgZnVuY3Rpb24gKGlkLCB0cmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQgIT09IHRyYWNrSUQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrc0luTXV0ZS5hZGQodHJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2subXV0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwibXV0ZVRyYWNrXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtdXRlVHJhY2sodHJhY2tJRCkge1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMudHJhY2tzLmhhc093blByb3BlcnR5KHRyYWNrSUQpKSByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBmb2N1c1RyYWNrID0gdGhpcy50cmFja3NbdHJhY2tJRF07XG4gICAgICAgICAgICB2YXIgdHJhY2tzSW5Tb2xvID0gdGhpcy5fdHJhY2tzSW5Tb2xvO1xuICAgICAgICAgICAgdmFyIHRyYWNrc0luTXV0ZSA9IHRoaXMuX3RyYWNrc0luTXV0ZTtcblxuICAgICAgICAgICAgLy8gY2FzZSAxOiB0cmFjayBub3QgaW4gc29sbyBvciBtdXRlXG4gICAgICAgICAgICBpZiAoIXRyYWNrc0luU29sby5oYXMoZm9jdXNUcmFjaykgJiYgIXRyYWNrc0luTXV0ZS5oYXMoZm9jdXNUcmFjaykpIHtcbiAgICAgICAgICAgICAgICB0cmFja3NJbk11dGUuYWRkKGZvY3VzVHJhY2spO1xuICAgICAgICAgICAgICAgIGZvY3VzVHJhY2subXV0ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgZm9jdXNUcmFjay5zb2xvID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNhc2UgMjogdHJhY2sgaXMgaW4gc29sb1xuICAgICAgICAgICAgZWxzZSBpZiAodHJhY2tzSW5Tb2xvLmhhcyhmb2N1c1RyYWNrKSkge1xuICAgICAgICAgICAgICAgICAgICB0cmFja3NJblNvbG8uZGVsZXRlKGZvY3VzVHJhY2spO1xuICAgICAgICAgICAgICAgICAgICB0cmFja3NJbk11dGUuYWRkKGZvY3VzVHJhY2spO1xuICAgICAgICAgICAgICAgICAgICBmb2N1c1RyYWNrLnNvbG8gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNUcmFjay5tdXRlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodHJhY2tzSW5Tb2xvLnNpemUgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICQuZWFjaCh0aGlzLnRyYWNrcywgZnVuY3Rpb24gKGlkLCB0cmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpZCAhPT0gdHJhY2tJRCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFja3NJbk11dGUuZGVsZXRlKHRyYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2subXV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gY2FzZSAzOiB0cmFjayBpcyBpbiBtdXRlXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHJhY2tzSW5NdXRlLmhhcyhmb2N1c1RyYWNrKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyYWNrc0luU29sby5zaXplID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrc0luTXV0ZS5kZWxldGUoZm9jdXNUcmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tzSW5Tb2xvLmFkZChmb2N1c1RyYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c1RyYWNrLm11dGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2N1c1RyYWNrLnNvbG8gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFja3NJbk11dGUuZGVsZXRlKGZvY3VzVHJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzVHJhY2subXV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJhZGRDYWxsQmFja0luTG9vcFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkQ2FsbEJhY2tJbkxvb3AoZm4pIHtcbiAgICAgICAgICAgIGlmICghKHR5cGVvZiBmbiA9PT0gXCJ1bmRlZmluZWRcIiA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKGZuKSkgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuO1xuICAgICAgICAgICAgdGhpcy5jYWxsQmFja3NJbkxvb3AucHVzaChmbik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJpc0luUmFuZ2VCUE1cIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzSW5SYW5nZUJQTSh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID49IHRoaXMuYnBtTWluICYmIHZhbHVlIDw9IHRoaXMuYnBtTWF4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcIl9jcmVhdGVFbXB0eVRpY2tzQXJyYXlcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVFbXB0eVRpY2tzQXJyYXkoKSB7XG4gICAgICAgICAgICB2YXIgdGlja3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5udW1iZXJPZkJlYXRzOyBpKyspIHtcblxuICAgICAgICAgICAgICAgIHRpY2tzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBpbmRleDogaSxcbiAgICAgICAgICAgICAgICAgICAgdm9sdW1lOiAwLFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmU6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGlja3M7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJfY2xlYXJUcmFja3NcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jbGVhclRyYWNrcygpIHtcbiAgICAgICAgICAgIHRoaXMuX3RyYWNrc0luU29sby5jbGVhcigpO1xuICAgICAgICAgICAgdGhpcy5fdHJhY2tzSW5NdXRlLmNsZWFyKCk7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLnRyYWNrcykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRyYWNrcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnRyYWNrc1trZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImFkZEVtcHR5VHJhY2tcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEVtcHR5VHJhY2soKSB7XG4gICAgICAgICAgICB2YXIgbmFtZSA9IFwidHJhY2tfXCIgKyAoT2JqZWN0LmtleXModGhpcy50cmFja3MpLmxlbmd0aCArIDEpO1xuICAgICAgICAgICAgdmFyIHRyYWNrID0gbmV3IF9UcmFjay5UcmFjayh0aGlzLCBuYW1lKTtcbiAgICAgICAgICAgIHRyYWNrLnNldFRpY2tzRnJvbUFycmF5KHRoaXMuX2NyZWF0ZUVtcHR5VGlja3NBcnJheSgpKTtcbiAgICAgICAgICAgIHRoaXMudHJhY2tzW3RyYWNrLmlkXSA9IHRyYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiY3JlYXRlVHJhY2tcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZVRyYWNrKG5hbWUsIHNvdW5kUGF0aCwgdm9sdW1lLCBwYW4sIHRpY2tzKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblxuICAgICAgICAgICAgICAgIHZhciB0cmFjayA9IG5ldyBfVHJhY2suVHJhY2soX3RoaXMzLCBuYW1lLCBzb3VuZFBhdGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRpY2tzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNrLnNldFRpY2tzRnJvbUFycmF5KHRpY2tzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0cmFjay5zZXRUaWNrc0Zyb21BcnJheShfdGhpczMuX2NyZWF0ZUVtcHR5VGlja3NBcnJheSgpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodm9sdW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNrLmdhaW5Ob2RlLmdhaW4udmFsdWUgPSB2b2x1bWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHBhbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAodHJhY2sucGFubmVyTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2sucGFubmVyTm9kZS5wYW4udmFsdWUgPSBwYW47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXNvbHZlKHRyYWNrKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwibG9hZFByZXNldFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFByZXNldChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmJwbSA9IGRhdGEuYnBtO1xuICAgICAgICAgICAgICAgIHRoaXMuX2NsZWFyVHJhY2tzKCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgIGRhdGEudHJhY2tzLmZvckVhY2goZnVuY3Rpb24gKHRyYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb21pc2VzLnB1c2goX3RoaXM0LmNyZWF0ZVRyYWNrKHRyYWNrLm5hbWUsIHRyYWNrLnNvdW5kUGF0aCwgdHJhY2sudm9sdW1lLCB0cmFjay5wYW4sIHRyYWNrLnRpY2tzKSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImJ1aWxkSnNvblByZXNldFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGRKc29uUHJlc2V0KG5hbWUsIGNhdGVnb3J5KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgICAgICBjYXRlZ29yeTogY2F0ZWdvcnksXG4gICAgICAgICAgICAgICAgYnBtOiB0aGlzLmJwbSxcbiAgICAgICAgICAgICAgICB0aW1lU2lnbmF0dXJlOiB0aGlzLnRpbWVTaWduYXR1cmVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHZhciB0cmFja3MgPSBbXTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaWQgaW4gdGhpcy50cmFja3MpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50cmFja3MuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0cmFjayA9IF90aGlzNS50cmFja3NbaWRdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHJhY2tEYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRyYWNrLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291bmRQYXRoOiBjYXRlZ29yeSArIFwiL1wiICsgdHJhY2suc2FtcGxlRGF0YS5maWxlTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2x1bWU6IHRyYWNrLmdhaW5Ob2RlLmdhaW4udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFuOiBfdGhpczUucGFubmVyTm9kZVN1cHBvcnRlZCA/IHRyYWNrLnBhbm5lck5vZGUucGFuLnZhbHVlIDogMFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpY2tzRGF0YSA9IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFjay50aWNrcy5mb3JFYWNoKGZ1bmN0aW9uICh0aWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGlja3NEYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmU6IHRpY2suYWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogdGljay5pbmRleCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9sdW1lOiB0aWNrLnZvbHVtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWNrRGF0YS50aWNrcyA9IHRpY2tzRGF0YTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2tzLnB1c2godHJhY2tEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRhdGEudHJhY2tzID0gdHJhY2tzO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcblxuICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiYnBtXCIsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JwbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHNldCBicG1cbiAgICAgICAgICovXG4gICAgICAgICxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsKSB7XG4gICAgICAgICAgICBpZiAodmFsICE9PSB0aGlzLl9icG0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9icG0gPSB2YWw7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25CcG1DaGFuZ2VkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRHJ1bU1hY2hpbmU7XG59KCk7IiwiLypcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogVGljay5qc1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIFRpY2sgPSBleHBvcnRzLlRpY2sgPSBmdW5jdGlvbiBUaWNrKCkge1xuICAgIHZhciBpbmRleCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogMDtcbiAgICB2YXIgYWN0aXZlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTtcbiAgICB2YXIgdm9sdW1lID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAxLjA7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGljayk7XG5cbiAgICB0aGlzLmluZGV4ID0gaW5kZXg7XG4gICAgdGhpcy5hY3RpdmUgPSBhY3RpdmU7XG4gICAgdGhpcy52b2x1bWUgPSB2b2x1bWU7XG59XG5cbi8vIGdldCB2b2x1bWUoKSB7XG4vLyAgICAgcmV0dXJuIHRoaXMuX3ZvbHVtZTtcbi8vIH1cbi8vXG4vLyBzZXQgdm9sdW1lKHZhbCkge1xuLy8gICAgIHRoaXMuX3ZvbHVtZSA9IHZhbCA+IDEgPyAxLjAgOiB2YWw7XG4vLyB9XG5cbjsiLCIvKlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBUcmFjay5qc1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuVHJhY2sgPSB1bmRlZmluZWQ7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9UaWNrID0gcmVxdWlyZShcIi4vVGlja1wiKTtcblxudmFyIF91dGlscyA9IHJlcXVpcmUoXCIuLi91dGlscy91dGlsc1wiKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIFRyYWNrID0gZXhwb3J0cy5UcmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUcmFjayhkcnVtTWFjaGluZSkge1xuICAgICAgICB2YXIgbmFtZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogXCJ0cmFja19kZWZhdWx0XCI7XG4gICAgICAgIHZhciBzb3VuZFBhdGggPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIHZvbHVtZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogMS4wO1xuXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgdmFyIHBhbiA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ICYmIGFyZ3VtZW50c1s0XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzRdIDogMDtcbiAgICAgICAgdmFyIG11dGUgPSBhcmd1bWVudHMubGVuZ3RoID4gNSAmJiBhcmd1bWVudHNbNV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s1XSA6IGZhbHNlO1xuXG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUcmFjayk7XG5cbiAgICAgICAgdGhpcy5pZCA9ICgwLCBfdXRpbHMuZ3VpZCkoKTtcbiAgICAgICAgdGhpcy5kcnVtTWFjaGluZSA9IGRydW1NYWNoaW5lO1xuICAgICAgICB0aGlzLmF1ZGlvQ29udGV4dCA9IGRydW1NYWNoaW5lLmF1ZGlvQ29udGV4dDtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcblxuICAgICAgICB0aGlzLnNhbXBsZURhdGEgPSB7XG4gICAgICAgICAgICBmaWxlTmFtZTogXCJcIixcbiAgICAgICAgICAgIGV4dGVuc2lvbjogXCJcIixcbiAgICAgICAgICAgIG9yaWdpbmFsQnVmZmVyOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBkZWNvZGVkQXVkaW9CdWZmZXI6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuc29sbyA9IGZhbHNlO1xuICAgICAgICB0aGlzLm11dGUgPSBtdXRlO1xuICAgICAgICB0aGlzLnRpY2tzID0gW107XG4gICAgICAgIHRoaXMucGFubmVyTm9kZVN1cHBvcnRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmdhaW5Ob2RlID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlR2FpbigpO1xuICAgICAgICB0aGlzLmdhaW5Ob2RlLmdhaW4udmFsdWUgPSB2b2x1bWU7XG5cbiAgICAgICAgaWYgKGRydW1NYWNoaW5lLnBhbm5lck5vZGVTdXBwb3J0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMucGFubmVyTm9kZSA9IHRoaXMuYXVkaW9Db250ZXh0LmNyZWF0ZVN0ZXJlb1Bhbm5lcigpO1xuICAgICAgICAgICAgdGhpcy5wYW5uZXJOb2RlLnBhbi52YWx1ZSA9IHBhbjtcbiAgICAgICAgICAgIHRoaXMuZ2Fpbk5vZGUuY29ubmVjdCh0aGlzLnBhbm5lck5vZGUpO1xuICAgICAgICAgICAgdGhpcy5wYW5uZXJOb2RlLmNvbm5lY3QodGhpcy5hdWRpb0NvbnRleHQuZGVzdGluYXRpb24pO1xuICAgICAgICAgICAgdGhpcy5wYW5uZXJOb2RlU3VwcG9ydGVkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuZ2Fpbk5vZGUuY29ubmVjdCh0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc291bmRQYXRoKSB7XG4gICAgICAgICAgICAoMCwgX3V0aWxzLmdldEFycmF5QXVkaW9CdWZmZXJGcm9tVXJsKSh0aGlzLmF1ZGlvQ29udGV4dCwgc291bmRQYXRoKS50aGVuKGZ1bmN0aW9uIChidWZmZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlsZU5hbWUgPSAoMCwgX3V0aWxzLmdldEZpbGVOYW1lRnJvbVBhdGgpKHNvdW5kUGF0aCk7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0U2FtcGxlRGF0YShmaWxlTmFtZSwgYnVmZmVyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5faW5pdFRpY2tzKCk7XG4gICAgfVxuXG4gICAgLy8gc2V0R2Fpbih2YWwpIHtcbiAgICAvLyAgICAgdGhpcy5nYWluTm9kZS5nYWluLnZhbHVlID0gdmFsID4gMSA/IDEuMCA6IHZhbDtcbiAgICAvLyB9XG5cblxuICAgIC8vIHNldFBhbih2YWwpIHtcbiAgICAvLyAgICAgaWYgKHZhbCA8IC0xKSB7XG4gICAgLy8gICAgICAgICB0aGlzLnBhbm5lck5vZGUucGFuLnZhbHVlID0gLTE7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgZWxzZSBpZiAodmFsID4gMSkge1xuICAgIC8vICAgICAgICAgdGhpcy5wYW5uZXJOb2RlLnBhbi52YWx1ZSA9IDE7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgZWxzZSB7XG4gICAgLy8gICAgICAgICB0aGlzLnBhbm5lck5vZGUucGFuLnZhbHVlID0gdmFsO1xuICAgIC8vICAgICB9XG4gICAgLy8gfVxuXG5cbiAgICAvKlxuICAgICAqXG4gICAgICovXG5cblxuICAgIF9jcmVhdGVDbGFzcyhUcmFjaywgW3tcbiAgICAgICAga2V5OiBcIl9pbml0VGlja3NcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbml0VGlja3MoKSB7XG4gICAgICAgICAgICB0aGlzLnRpY2tzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZHJ1bU1hY2hpbmUubnVtYmVyT2ZCZWF0czsgKytpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50aWNrcy5wdXNoKG5ldyBfVGljay5UaWNrKGkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcInNldFRpY2tcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFRpY2soaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBhY3RpdmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHRydWU7XG4gICAgICAgICAgICB2YXIgdm9sdW1lID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiAxLjA7XG5cbiAgICAgICAgICAgIGlmIChpbmRleCA8IDAgfHwgaW5kZXggPiB0aGlzLmRydW1NYWNoaW5lLm51bWJlck9mQmVhdHMgLSAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnRpY2tzW2luZGV4XS52b2x1bWUgPSB2b2x1bWU7XG4gICAgICAgICAgICB0aGlzLnRpY2tzW2luZGV4XS5hY3RpdmUgPSBhY3RpdmU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJzZXRUaWNrc0Zyb21BcnJheVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VGlja3NGcm9tQXJyYXkoZGF0YSkge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGRhdGEuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmICgodHlwZW9mIGUgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihlKSkgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuaW5kZXggPT09IFwidW5kZWZpbmVkXCIgfHwgZS5pbmRleCA8IDAgfHwgZS5pbmRleCA+IF90aGlzMi5kcnVtTWFjaGluZS5udW1iZXJPZkJlYXRzIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLnRpY2tzW2UuaW5kZXhdLnZvbHVtZSA9IGUudm9sdW1lICE9PSBcInVuZGVmaW5lZFwiID8gZS52b2x1bWUgOiAwO1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIudGlja3NbZS5pbmRleF0uYWN0aXZlID0gZS5hY3RpdmUgIT09IFwidW5kZWZpbmVkXCIgPyBlLmFjdGl2ZSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi50aWNrc1tlXS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc2V0QnVmZmVyKGJ1ZmZlciwgZmlsZU5hbWUpIHtcbiAgICAgICAgLy8gICAgIHRoaXMuYnVmZmVyID0gYnVmZmVyO1xuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coXCJUcmFjayBcIiArIHRoaXMubmFtZSArIFwiOiBhdWRpbyBidWZmZXIgY2hhbmdlZCAoIFwiICsgZmlsZU5hbWUgKyBcIiApXCIpO1xuICAgICAgICAvLyB9XG5cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcInNldEJ1ZmZlclwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0QnVmZmVyKGFycmF5QnVmZmVyLCBmaWxlTmFtZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMub3JpZ2luYWxCdWZmZXIgPSBhcnJheUJ1ZmZlcjtcbiAgICAgICAgICAgIHRoaXMuZHJ1bU1hY2hpbmUuYXVkaW9Db250ZXh0LmRlY29kZUF1ZGlvRGF0YShhcnJheUJ1ZmZlciwgZnVuY3Rpb24gKGRlY29kZWRBdWRpb0J1ZmZlcikge1xuICAgICAgICAgICAgICAgIF90aGlzMy5idWZmZXIgPSBkZWNvZGVkQXVkaW9CdWZmZXI7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJUcmFjayBcIiArIF90aGlzMy5uYW1lICsgXCI6IGF1ZGlvIGJ1ZmZlciBjaGFuZ2VkICggXCIgKyBmaWxlTmFtZSArIFwiIClcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcInBsYXlTb3VuZFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGxheVNvdW5kKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmF1ZGlvQ29udGV4dCB8fCAhdGhpcy5zYW1wbGVEYXRhLmRlY29kZWRBdWRpb0J1ZmZlcikgcmV0dXJuO1xuICAgICAgICAgICAgdmFyIHNvdW5kID0gdGhpcy5hdWRpb0NvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICAgICAgICBzb3VuZC5idWZmZXIgPSB0aGlzLnNhbXBsZURhdGEuZGVjb2RlZEF1ZGlvQnVmZmVyO1xuICAgICAgICAgICAgc291bmQuY29ubmVjdCh0aGlzLmF1ZGlvQ29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICBzb3VuZC5zdGFydCgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwic2V0U2FtcGxlRGF0YVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U2FtcGxlRGF0YShmaWxlTmFtZSwgYXJyYXlBdWRpb0J1ZmZlcikge1xuICAgICAgICAgICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmICghZmlsZU5hbWUgfHwgIWFycmF5QXVkaW9CdWZmZXIpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1pc3NpbmcgZmlsZU5hbWUgYW5kL29yIGFycmF5QXVkaW9CdWZmZXIgcGFyYW1ldGVyc1wiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZHJ1bU1hY2hpbmUuYXVkaW9Db250ZXh0LmRlY29kZUF1ZGlvRGF0YShhcnJheUF1ZGlvQnVmZmVyLCBmdW5jdGlvbiAoZGVjb2RlZEJ1ZmZlcikge1xuICAgICAgICAgICAgICAgIF90aGlzNC5zYW1wbGVEYXRhLmZpbGVOYW1lID0gZmlsZU5hbWU7XG4gICAgICAgICAgICAgICAgX3RoaXM0LnNhbXBsZURhdGEuZXh0ZW5zaW9uID0gKDAsIF91dGlscy5nZXRFeHRlbnNpb25Gcm9tRmlsZU5hbWUpKGZpbGVOYW1lKTtcbiAgICAgICAgICAgICAgICBfdGhpczQuc2FtcGxlRGF0YS5vcmlnaW5hbEJ1ZmZlciA9IGFycmF5QXVkaW9CdWZmZXI7XG4gICAgICAgICAgICAgICAgX3RoaXM0LnNhbXBsZURhdGEuZGVjb2RlZEF1ZGlvQnVmZmVyID0gZGVjb2RlZEJ1ZmZlcjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFRyYWNrO1xufSgpOyIsIi8qXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIGF1ZGlvLWxvYWRlci5qc1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuYXVkaW9Mb2FkZXIgPSBhdWRpb0xvYWRlcjtcbmZ1bmN0aW9uIGF1ZGlvTG9hZGVyKGF1ZGlvQ3R4LCB1cmwpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgaWYgKCFhdWRpb0N0eCkge1xuICAgICAgICAgICAgcmVqZWN0KFwiTWlzc2luZyBhdWRpbyBjb250ZXh0IHBhcmFtZXRlci5cIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXVybCkge1xuICAgICAgICAgICAgcmVqZWN0KFwiTWlzc2luZyB1cmwgcGFyYW1ldGVyXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICB4aHIub3BlbihcIkdFVFwiLCB1cmwpO1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gXCJhcnJheWJ1ZmZlclwiO1xuXG4gICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGF1ZGlvQ3R4LmRlY29kZUF1ZGlvRGF0YSh4aHIucmVzcG9uc2UsIGZ1bmN0aW9uIChkZWNvZGVkQnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGVjb2RlZEJ1ZmZlcik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHhoci5zZW5kKCk7XG4gICAgfSk7XG59IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbi8qKlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBwcmVzZXRzLmpzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqL1xuXG52YXIgZ3Jvb3Z5Um9ja1ByZXNldCA9IGV4cG9ydHMuZ3Jvb3Z5Um9ja1ByZXNldCA9IHtcbiAgICBuYW1lOiBcIkdyb292eSByb2NrXCIsXG4gICAgYnBtOiAxMjAsXG4gICAgY2F0ZWdvcnk6IFwiUm9ja1wiLFxuICAgIHRpbWVTaWduYXR1cmU6IHtcbiAgICAgICAgbnVtOiA0LFxuICAgICAgICBkZW46IDRcbiAgICB9LFxuICAgIHRyYWNrczogW3tcbiAgICAgICAgbmFtZTogXCJraWNrXCIsXG4gICAgICAgIHNvdW5kUGF0aDogXCJhcHAvYXNzZXRzL2F1ZGlvL3JvY2stbWV0YWwvcm9jay1raWNrLndhdlwiLFxuICAgICAgICB2b2x1bWU6IDEsXG4gICAgICAgIHBhbjogMCxcbiAgICAgICAgdGlja3M6IFt7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMCxcbiAgICAgICAgICAgIHZvbHVtZTogMVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogNCxcbiAgICAgICAgICAgIHZvbHVtZTogMVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogOCxcbiAgICAgICAgICAgIHZvbHVtZTogMVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMTAsXG4gICAgICAgICAgICB2b2x1bWU6IDFcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDEyLFxuICAgICAgICAgICAgdm9sdW1lOiAxXG4gICAgICAgIH1dXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcInNuYXJlXCIsXG4gICAgICAgIHNvdW5kUGF0aDogXCJhcHAvYXNzZXRzL2F1ZGlvL3JvY2stbWV0YWwvcm9jay1zbmFyZS53YXZcIixcbiAgICAgICAgdm9sdW1lOiAxLFxuICAgICAgICBwYW46IDAsXG4gICAgICAgIHRpY2tzOiBbe1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDQsXG4gICAgICAgICAgICB2b2x1bWU6IDFcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDEyLFxuICAgICAgICAgICAgdm9sdW1lOiAxXG4gICAgICAgIH1dXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcImdob3N0LXNuYXJlXCIsXG4gICAgICAgIHNvdW5kUGF0aDogXCJhcHAvYXNzZXRzL2F1ZGlvL3JvY2stbWV0YWwvcm9jay1zbmFyZS1naG9zdC53YXZcIixcbiAgICAgICAgdm9sdW1lOiAxLFxuICAgICAgICBwYW46IDAsXG4gICAgICAgIHRpY2tzOiBbe1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDE1LFxuICAgICAgICAgICAgdm9sdW1lOiAxXG4gICAgICAgIH1dXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcImhoIG9wZW5cIixcbiAgICAgICAgc291bmRQYXRoOiBcImFwcC9hc3NldHMvYXVkaW8vcm9jay1tZXRhbC9yb2NrLWhoLW9wZW4ud2F2XCIsXG4gICAgICAgIHZvbHVtZTogMC40LFxuICAgICAgICBwYW46IDAuNSxcbiAgICAgICAgdGlja3M6IFt7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogNCxcbiAgICAgICAgICAgIHZvbHVtZTogMC44XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgIGluZGV4OiA4LFxuICAgICAgICAgICAgdm9sdW1lOiAwLjhcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDEyLFxuICAgICAgICAgICAgdm9sdW1lOiAwLjhcbiAgICAgICAgfV1cbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiY3Jhc2hcIixcbiAgICAgICAgc291bmRQYXRoOiBcImFwcC9hc3NldHMvYXVkaW8vcm9jay1tZXRhbC9yb2NrLWNyYXNoLndhdlwiLFxuICAgICAgICB2b2x1bWU6IDAuNSxcbiAgICAgICAgcGFuOiAtMC41LFxuICAgICAgICB0aWNrczogW3tcbiAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgIGluZGV4OiAwLFxuICAgICAgICAgICAgdm9sdW1lOiAwLjhcbiAgICAgICAgfV1cbiAgICB9XVxufTtcblxudmFyIHBzeVRyYW5jZVByZXNldCA9IGV4cG9ydHMucHN5VHJhbmNlUHJlc2V0ID0ge1xuICAgIG5hbWU6IFwicHN5LXRyYW5jZVwiLFxuICAgIGNhdGVnb3J5OiBcIlRyYW5jZVwiLFxuICAgIGJwbTogMTQ1LFxuICAgIHRpbWVTaWduYXR1cmU6IHtcbiAgICAgICAgbnVtOiA0LFxuICAgICAgICBkZW46IDRcbiAgICB9LFxuICAgIHRyYWNrczogW3tcbiAgICAgICAgbmFtZTogXCJraWNrXCIsXG4gICAgICAgIHNvdW5kUGF0aDogXCJhcHAvYXNzZXRzL2F1ZGlvL3RyYW5jZS90cmFuY2Uta2ljay53YXZcIixcbiAgICAgICAgdm9sdW1lOiAxLFxuICAgICAgICBwYW46IDAsXG4gICAgICAgIHRpY2tzOiBbe1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDAsXG4gICAgICAgICAgICB2b2x1bWU6IDFcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDQsXG4gICAgICAgICAgICB2b2x1bWU6IDFcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDgsXG4gICAgICAgICAgICB2b2x1bWU6IDFcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDEyLFxuICAgICAgICAgICAgdm9sdW1lOiAxXG4gICAgICAgIH1dXG4gICAgfSwge1xuICAgICAgICBuYW1lOiBcImNsYXBcIixcbiAgICAgICAgc291bmRQYXRoOiBcImFwcC9hc3NldHMvYXVkaW8vdHJhbmNlL3RyYW5jZS1jbGFwLndhdlwiLFxuICAgICAgICB2b2x1bWU6IDEsXG4gICAgICAgIHBhbjogMCxcbiAgICAgICAgdGlja3M6IFt7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogNCxcbiAgICAgICAgICAgIHZvbHVtZTogMVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMTIsXG4gICAgICAgICAgICB2b2x1bWU6IDFcbiAgICAgICAgfV1cbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiaGggb3BlblwiLFxuICAgICAgICBzb3VuZFBhdGg6IFwiYXBwL2Fzc2V0cy9hdWRpby90cmFuY2UvdHJhbmNlLWhoLW9wZW4ud2F2XCIsXG4gICAgICAgIHZvbHVtZTogMC44LFxuICAgICAgICBwYW46IDAuMixcbiAgICAgICAgdGlja3M6IFt7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMixcbiAgICAgICAgICAgIHZvbHVtZTogMC44XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgIGluZGV4OiA2LFxuICAgICAgICAgICAgdm9sdW1lOiAwLjhcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDEwLFxuICAgICAgICAgICAgdm9sdW1lOiAwLjhcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDE0LFxuICAgICAgICAgICAgdm9sdW1lOiAwLjhcbiAgICAgICAgfV1cbiAgICB9LCB7XG4gICAgICAgIG5hbWU6IFwiYmFzc1wiLFxuICAgICAgICBzb3VuZFBhdGg6IFwiYXBwL2Fzc2V0cy9hdWRpby90cmFuY2UvdHJhbmNlLWJhc3MtQTEud2F2XCIsXG4gICAgICAgIHZvbHVtZTogMC44LFxuICAgICAgICBwYW46IDAsXG4gICAgICAgIHRpY2tzOiBbe1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDEsXG4gICAgICAgICAgICB2b2x1bWU6IDAuOFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMixcbiAgICAgICAgICAgIHZvbHVtZTogMC44XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgIGluZGV4OiAzLFxuICAgICAgICAgICAgdm9sdW1lOiAwLjhcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDUsXG4gICAgICAgICAgICB2b2x1bWU6IDAuOFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogNixcbiAgICAgICAgICAgIHZvbHVtZTogMC44XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgIGluZGV4OiA3LFxuICAgICAgICAgICAgdm9sdW1lOiAwLjhcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgICAgaW5kZXg6IDksXG4gICAgICAgICAgICB2b2x1bWU6IDAuOFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMTAsXG4gICAgICAgICAgICB2b2x1bWU6IDAuOFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMTEsXG4gICAgICAgICAgICB2b2x1bWU6IDAuOFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMTMsXG4gICAgICAgICAgICB2b2x1bWU6IDAuOFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMTQsXG4gICAgICAgICAgICB2b2x1bWU6IDAuOFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBhY3RpdmU6IHRydWUsXG4gICAgICAgICAgICBpbmRleDogMTUsXG4gICAgICAgICAgICB2b2x1bWU6IDAuOFxuICAgICAgICB9XVxuICAgIH1dXG59OyIsIlwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRydW1NYWNoaW5lQ29udHJvbGxlciA9IGRydW1NYWNoaW5lQ29udHJvbGxlcjtcblxudmFyIF9EcnVtTWFjaGluZSA9IHJlcXVpcmUoXCIuLi8uLi9hdWRpby9EcnVtTWFjaGluZVwiKTtcblxudmFyIF9wcmVzZXRzID0gcmVxdWlyZShcIi4uLy4uL2F1ZGlvL3ByZXNldHNcIik7XG5cbi8vIGNvbnN0IGJhc2VTZXJ2ZXJVcmwgPSBcImh0dHA6Ly9sb2NhbGhvc3Q6NDUwMFwiO1xuLy8gY29uc3QgYmFzZVNlcnZlclVybCA9IFwiaHR0cDovLzE5Mi4xNjguMS43Mjo0NTAwXCI7XG4vLyBjb25zdCBiYXNlU2VydmVyVXJsID0gXCJodHRwOi8vMTkyLjE2OC4xLjc1OjQ1MDBcIjtcbnZhciBiYXNlU2VydmVyVXJsID0gXCJodHRwczovL2dyb292ZS1tb25rZXkuaGVyb2t1YXBwLmNvbVwiOyAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIG1haW5Db250cm9sbGVyLmpzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuZnVuY3Rpb24gZHJ1bU1hY2hpbmVDb250cm9sbGVyKCRzY29wZSwgJGNvbXBpbGUsICRodHRwLCAkaW50ZXJ2YWwsIEZpbGVTYXZlciwgQmxvYiwgc29ja2V0RXZlbnRzKSB7XG5cbiAgICB2YXIgZHJ1bU1hY2hpbmUgPSBuZXcgX0RydW1NYWNoaW5lLkRydW1NYWNoaW5lKCk7XG4gICAgdmFyIGxvYWRpbmdDb250YWluZXIgPSAkKFwiI2xvYWRpbmdDb250YWluZXJcIik7XG4gICAgdmFyIGNvbW1lbnRzTG9hZGluZ092ZXJsYXkgPSAkKFwiI2NvbW1lbnRzTG9hZGluZ092ZXJsYXlcIik7XG4gICAgdmFyIGNvbW1lbnRzTG9hZGluZ1NwaW5uZXIgPSAkKFwiI2NvbW1lbnRzTG9hZGluZ1NwaW5uZXJcIik7XG4gICAgdmFyIHBsYXlCdG4gPSAkKFwiI3NlcXVlbmNlclBsYXlCdXR0b25cIik7XG4gICAgdmFyIHN0b3BCdG4gPSAkKFwiI3NlcXVlbmNlclN0b3BCdXR0b25cIik7XG4gICAgdmFyIGJwbVNsaWRlciA9ICQoXCIjc2VxdWVuY2VyQlBNc2xpZGVyXCIpO1xuXG4gICAgJHNjb3BlLnNhZmVBcHBseSA9IGZ1bmN0aW9uIChmbikge1xuICAgICAgICB2YXIgcGhhc2UgPSB0aGlzLiRyb290LiQkcGhhc2U7XG4gICAgICAgIGlmIChwaGFzZSA9PSAnJGFwcGx5JyB8fCBwaGFzZSA9PSAnJGRpZ2VzdCcpIHtcbiAgICAgICAgICAgIGlmIChmbiAmJiB0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4kYXBwbHkoZm4pO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgICRzY29wZS50aXRsZSA9IFwiTWFpbiBDb250cm9sbGVyXCI7XG4gICAgJHNjb3BlLnRyYWNrcyA9IFtdO1xuICAgICRzY29wZS50aWNrc0VsZW1lbnRzID0gW107XG4gICAgJHNjb3BlLmJwbSA9IGRydW1NYWNoaW5lLmJwbTtcbiAgICAkc2NvcGUuaXNQbGF5aW5nID0gZHJ1bU1hY2hpbmUuaXNQbGF5aW5nO1xuICAgICRzY29wZS5pc1N0b3BwZWQgPSBkcnVtTWFjaGluZS5pc1N0b3BwZWQ7XG4gICAgJHNjb3BlLnJlbW92ZVRyYWNrID0gcmVtb3ZlVHJhY2s7XG4gICAgJHNjb3BlLmludGVnZXJ2YWwgPSAvXlxcZCokLztcbiAgICAkc2NvcGUuYmVhdHMgPSBuZXcgQXJyYXkoZHJ1bU1hY2hpbmUubnVtYmVyT2ZCZWF0cykuZmlsbChmYWxzZSk7XG4gICAgJHNjb3BlLnVzZXJuYW1lID0gXCJcIjtcbiAgICAkc2NvcGUuY29tbWVudFRvUG9zdCA9IFwiXCI7XG4gICAgJHNjb3BlLmNvbW1lbnRzID0gW107XG4gICAgJHNjb3BlLmludmFsaWRVc2VybmFtZU1lc3NhZ2UgPSBcIkdpdmUgeWEgYSBuYW1lISAoMy0zMiBjaGFyYWN0ZXJzKVwiO1xuICAgICRzY29wZS5pbnZhbGlkQ29tbWVudE1lc3NhZ2UgPSBcIldyaXRlIHNvbWV0aGluZyBjb29sISAoMy0xMDAwIGNoYXJhY3RlcnMpXCI7XG5cbiAgICAkc2NvcGUucHJlc2V0ID0ge1xuICAgICAgICBuYW1lOiBcIlwiLFxuICAgICAgICBjYXRlZ29yeVNlbGVjdGVkOiB1bmRlZmluZWQsXG4gICAgICAgIGNhdGVnb3JpZXM6IFtdXG4gICAgfTtcblxuICAgICRzY29wZS50cmFja3MgPSBkcnVtTWFjaGluZS50cmFja3M7XG4gICAgJHNjb3BlLnNhZmVBcHBseSgpO1xuXG4gICAgLypcbiAgICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgKiBVSVxuICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAqL1xuXG4gICAgJChcIiNhY2NvcmRpb25cIikuYWNjb3JkaW9uKHtcbiAgICAgICAgYW5pbWF0ZTogMjAwLFxuICAgICAgICBjb2xsYXBzaWJsZTogdHJ1ZSxcbiAgICAgICAgYWN0aXZlOiBmYWxzZSxcbiAgICAgICAgaGVpZ2h0U3R5bGU6IFwiY29udGVudFwiLFxuICAgICAgICAvLyBpY29uczogeyBcImhlYWRlclwiOiBcInVpLWljb24tcGx1c1wiLCBcImFjdGl2ZUhlYWRlclwiOiBcInVpLWljb24tbWludXNcIiB9LFxuICAgICAgICBiZWZvcmVBY3RpdmF0ZTogZnVuY3Rpb24gYmVmb3JlQWN0aXZhdGUoKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmNvbW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGxvYWRDb21tZW50cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICAkKFwiI3Bvc3RDb21tZW50QnRuXCIpLmJ1dHRvbih7XG4gICAgICAgIGljb246IFwidWktaWNvbi1wZW5jaWxcIlxuICAgIH0pO1xuXG4gICAgLypcbiAgICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgKiBldmVudCBsaXN0ZW5lcnNcbiAgICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgKi9cblxuICAgICQod2luZG93KS5yZWFkeShmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIGJlYXRJbmRpY2F0b3JzQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJiZWF0SW5kaWNhdG9yc1wiKTtcbiAgICAgICAgdmFyIGJlYXRJbmRpY2F0b3JzID0gYmVhdEluZGljYXRvcnNDb250YWluZXIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImJlYXQtaW5kaWNhdG9yXCIpO1xuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUJlYXRJbmRpY2F0b3JzKHByZXZpb3VzVGlja0luZGV4LCB0aWNrSW5kZXgpIHtcbiAgICAgICAgICAgICQoYmVhdEluZGljYXRvcnNbcHJldmlvdXNUaWNrSW5kZXhdKS5yZW1vdmVDbGFzcyhcImJlYXQtaW5kaWNhdG9yLWFjdGl2ZVwiKTtcbiAgICAgICAgICAgICQoYmVhdEluZGljYXRvcnNbdGlja0luZGV4XSkuYWRkQ2xhc3MoXCJiZWF0LWluZGljYXRvci1hY3RpdmVcIik7XG4gICAgICAgIH1cblxuICAgICAgICBkcnVtTWFjaGluZS5hZGRDYWxsQmFja0luTG9vcCh1cGRhdGVCZWF0SW5kaWNhdG9ycyk7XG4gICAgfSk7XG5cbiAgICAvKlxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKGUpID0+IHtcbiAgICAgICAgc3dpdGNoIChlLmtleUNvZGUpIHtcbiAgICAgICAgICAgICBjYXNlIDMyOlxuICAgICAgICAgICAgICAgICBpZigkKFwidGV4dGFyZWEjY29tbWVudEFyZWEsIGlucHV0I3VzZXJuYW1lSW5wdXRcIikuaXMoXCI6Zm9jdXNcIikpe1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKCRzY29wZS5pc1N0b3BwZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcGxheShlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdG9wKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgICAvLyByZW1vdmUgc2Nyb2xsIGRvd24gb24gc3BhY2ViYXJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYoZS5rZXlDb2RlID09PSAzMiAmJiBlLnRhcmdldCA9PT0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgKi9cblxuICAgIC8qXG4gICAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICogcHVibGljXG4gICAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICovXG5cbiAgICAkc2NvcGUuc3RhcnRTZXF1ZW5jZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGRydW1NYWNoaW5lLl9zdGFydCgpO1xuICAgICAgICAkc2NvcGUuaXNQbGF5aW5nID0gdHJ1ZTtcbiAgICAgICAgJHNjb3BlLmlzU3RvcHBlZCA9IGZhbHNlO1xuICAgIH07XG5cbiAgICAkc2NvcGUuc3RvcFNlcXVlbmNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZHJ1bU1hY2hpbmUuX3N0b3AoKTtcbiAgICAgICAgJHNjb3BlLmlzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICAkc2NvcGUuaXNTdG9wcGVkID0gdHJ1ZTtcbiAgICAgICAgdmFyIGluZGljYXRvcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJlYXRJbmRpY2F0b3JzXCIpLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJiZWF0LWluZGljYXRvclwiKTtcbiAgICAgICAgJChpbmRpY2F0b3JzKS5yZW1vdmVDbGFzcyhcImJlYXQtaW5kaWNhdG9yLWFjdGl2ZVwiKTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmFkZFRyYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkcnVtTWFjaGluZS5hZGRFbXB0eVRyYWNrKCk7XG4gICAgfTtcblxuICAgICRzY29wZS5leHBvcnRNaWRpID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHZhciB0cmFja3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIGRydW1NYWNoaW5lLnRyYWNrcykge1xuICAgICAgICAgICAgaWYgKGRydW1NYWNoaW5lLnRyYWNrcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhY2sgPSBkcnVtTWFjaGluZS50cmFja3Nba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYWNrRGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRyYWNrLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBub3RlczogW11cbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgd2FpdENvdW50ZXIgPSAwO1xuICAgICAgICAgICAgICAgICAgICB0cmFjay50aWNrcy5mb3JFYWNoKGZ1bmN0aW9uICh0aWNrKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aWNrLmFjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RlRXZlbnREYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaXRjaDogW1wiQzRcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZlbG9jaXR5OiB0aWNrLnZvbHVtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IFwiMTZcIiAvLyAxLzE2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3YWl0Q291bnRlciA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHdhaXRQYXJhbSA9IFwiVFwiICsgd2FpdENvdW50ZXIgKiAzMjsgLy9udW1iZXIgb2YgdGlja3MgdG8gd2FpdCAoZWFjaCB0aWNrIGlzIDEvMTI4KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RlRXZlbnREYXRhW1wid2FpdFwiXSA9IHdhaXRQYXJhbTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFja0RhdGEubm90ZXMucHVzaChub3RlRXZlbnREYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3YWl0Q291bnRlciA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhaXRDb3VudGVyICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHRyYWNrcy5wdXNoKHRyYWNrRGF0YSk7XG4gICAgICAgICAgICAgICAgfSkoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgYnBtOiBkcnVtTWFjaGluZS5icG0sXG4gICAgICAgICAgICB0aW1lU2lnbmF0dXJlOiB7IG51bTogNCwgZGVuOiA0IH0sXG4gICAgICAgICAgICB0cmFja3M6IHRyYWNrc1xuICAgICAgICB9O1xuXG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIHVybDogYmFzZVNlcnZlclVybCArICcvYXBpL21pZGknLFxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogXCJhcnJheWJ1ZmZlclwiLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoZGF0YSlcblxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbcmVzcG9uc2UuZGF0YV0sIHsgdHlwZTogJ2F1ZGlvL21pZGknIH0pO1xuICAgICAgICAgICAgLy8gbGV0IGZpbGVOYW1lID0gcmVzcG9uc2UuaGVhZGVycygnY29udGVudC1kaXNwb3NpdGlvbicpO1xuICAgICAgICAgICAgRmlsZVNhdmVyLnNhdmVBcyhibG9iLCBcImxvb3AubWlkXCIpO1xuICAgICAgICB9LCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS5wb3B1bGF0ZUNhdGVnb3JpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgdXJsOiBiYXNlU2VydmVyVXJsICsgXCIvYXBpL2NhdGVnb3JpZXNcIixcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHZhciBjYXRlZ29yaWVzID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICAgICAvLyBjYXRlZ29yaWVzLmZvckVhY2goYyA9PiB7XG4gICAgICAgICAgICAgICAgLy8gICAgICRzY29wZS5jYXRlZ29yaWVzLnB1c2goYy5uYW1lKTtcbiAgICAgICAgICAgICAgICAvLyB9KTtcbiAgICAgICAgICAgICAgICAkc2NvcGUucHJlc2V0LmNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoY2F0ZWdvcmllcyk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgJHNjb3BlLmxvYWRQcmVzZXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgdXJsOiBiYXNlU2VydmVyVXJsICsgXCIvYXBpL3ByZXNldHNcIixcbiAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICB2YXIgcHJlc2V0cyA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBpZiAocHJlc2V0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRydW1NYWNoaW5lLmxvYWRQcmVzZXQocHJlc2V0c1swXSkudGhlbihmdW5jdGlvbiAodHJhY2tzKSB7XG5cbiAgICAgICAgICAgICAgICB0cmFja3MuZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgICAgICAgICBkcnVtTWFjaGluZS50cmFja3NbdC5pZF0gPSB0O1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJwbSA9IGRydW1NYWNoaW5lLmJwbTtcbiAgICAgICAgICAgICAgICBicG1TbGlkZXIuc2xpZGVyKFwidmFsdWVcIiwgJHNjb3BlLmJwbSk7XG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvclJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvclJlc3BvbnNlKTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS5zYXZlUHJlc2V0ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICB2YXIganNvblByZXNldCA9IGRydW1NYWNoaW5lLmJ1aWxkSnNvblByZXNldCgkc2NvcGUucHJlc2V0Lm5hbWUsICRzY29wZS5wcmVzZXQuY2F0ZWdvcnlTZWxlY3RlZC5uYW1lKTtcblxuICAgICAgICBmb3IgKHZhciBpZCBpbiBkcnVtTWFjaGluZS50cmFja3MpIHtcblxuICAgICAgICAgICAgaWYgKGRydW1NYWNoaW5lLnRyYWNrcy5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHJhY2sgPSBkcnVtTWFjaGluZS50cmFja3NbaWRdO1xuXG4gICAgICAgICAgICAgICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbdHJhY2suc2FtcGxlRGF0YS5vcmlnaW5hbEJ1ZmZlcl0sIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdHlwZTogdHJhY2suc2FtcGxlRGF0YS5leHRlbnNpb24gPyBcImF1ZGlvL1wiICsgdHJhY2suc2FtcGxlRGF0YS5leHRlbnNpb24gOiBcIm9jdGV0LXN0cmVhbVwiXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2N0ZXQtc3RyZWFtXCJcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZChcInNhbXBsZVwiLCBibG9iLCB0cmFjay5zYW1wbGVEYXRhLmZpbGVOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZChcInByZXNldFwiLCBqc29uUHJlc2V0KTtcblxuICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICAgICAgeGhyLm9wZW4oJ1BPU1QnLCBiYXNlU2VydmVyVXJsICsgJy9hcGkvcHJlc2V0cycsIHRydWUpO1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkFjY2VwdFwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XG4gICAgICAgIHhoci5vbmxvYWQgPSBoYW5kbGVyO1xuICAgICAgICB4aHIuc2VuZChmb3JtRGF0YSk7XG5cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlcihlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkc2NvcGUudXBsb2FkRmlsZXMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG5cbiAgICAgICAgLy8gJCgnaW5wdXRbdHlwZT1cImZpbGVcIl0nKS5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgICBsZXQgZmlsZUxpc3QgPSAkKHRoaXMpWzBdLmZpbGVzO1xuICAgICAgICAvL1xuICAgICAgICAvLyAgICAgZm9yKGxldCBpID0gMDsgaSA8IGZpbGVMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vICAgICAgICAgbGV0IGZpbGUgPSBmaWxlTGlzdFtpXTtcbiAgICAgICAgLy8gICAgICAgICBmb3JtRGF0YS5hcHBlbmQoZmlsZS5uYW1lLCBmaWxlKTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfSk7XG5cblxuICAgICAgICAvLyBkcnVtTWFjaGluZS50cmFja3MuZm9yRWFjaCh0cmFjayA9PiB7XG4gICAgICAgIC8vXG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyh0cmFjayk7XG4gICAgICAgIC8vICAgICBsZXQgYnVmZmVyID0gdHJhY2suYnVmZmVyO1xuICAgICAgICAvLyAgICAgbGV0IGJsb2IgPSBuZXcgQmxvYihidWZmZXIpO1xuICAgICAgICAvLyAgICAgZm9ybURhdGEuYXBwZW5kKHRyYWNrLm5hbWUsIGJsb2IsIFwiY2FtcGlvbmUud2F2XCIpO1xuICAgICAgICAvL1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICBmb3IgKHZhciBpZCBpbiBkcnVtTWFjaGluZS50cmFja3MpIHtcbiAgICAgICAgICAgIGlmIChkcnVtTWFjaGluZS50cmFja3MuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyYWNrID0gZHJ1bU1hY2hpbmUudHJhY2tzW2lkXTtcblxuICAgICAgICAgICAgICAgIHZhciBibG9iID0gbmV3IEJsb2IoW3RyYWNrLnNhbXBsZURhdGEub3JpZ2luYWxCdWZmZXJdLCB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHR5cGU6IHRyYWNrLnNhbXBsZURhdGEuZXh0ZW5zaW9uID8gXCJhdWRpby9cIiArIHRyYWNrLnNhbXBsZURhdGEuZXh0ZW5zaW9uIDogXCJvY3RldC1zdHJlYW1cIlxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9jdGV0LXN0cmVhbVwiXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoXCJzYW1wbGVcIiwgYmxvYiwgdHJhY2suc2FtcGxlRGF0YS5maWxlTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgbmFtZTogXCJ0cmFja1wiLFxuICAgICAgICAgICAgYnBtOiAxMjAsXG4gICAgICAgICAgICB0cmFja3M6IFt7XG4gICAgICAgICAgICAgICAgbmFtZTogXCJraWNrXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBuYW1lOiBcInNuYXJlXCJcbiAgICAgICAgICAgIH1dXG4gICAgICAgIH07XG5cbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKFwicHJlc2V0XCIsIEpTT04uc3RyaW5naWZ5KG9iaikpO1xuXG4gICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgICB4aHIub3BlbignUE9TVCcsIGJhc2VTZXJ2ZXJVcmwgKyAnL2FwaS91cGxvYWQnLCB0cnVlKTtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJBY2NlcHRcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgICAgICB4aHIub25sb2FkID0gaGFuZGxlcjtcbiAgICAgICAgeGhyLnNlbmQoZm9ybURhdGEpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZXIoZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyAkaHR0cCh7XG4gICAgICAgIC8vICAgICB1cmw6IFwiaHR0cDovL2xvY2FsaG9zdDo0NTAwL3VwbG9hZFwiLFxuICAgICAgICAvLyAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgLy8gICAgIHRyYW5zZm9ybVJlcXVlc3Q6IGFuZ3VsYXIuaWRlbnRpdHksXG4gICAgICAgIC8vICAgICBoZWFkZXI6IHtcbiAgICAgICAgLy8gICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiB1bmRlZmluZWQsXG4gICAgICAgIC8vICAgICB9LFxuICAgICAgICAvLyAgICAgZGF0YTogZm9ybURhdGFcbiAgICAgICAgLy8gfSkudGhlbihyZXNwb25zZSA9PiB7XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIC8vIH0sIGVycm9yID0+IHtcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgLy8gfSk7XG5cbiAgICB9O1xuXG4gICAgJHNjb3BlLnBvc3RDb21tZW50ID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgdXNlcm5hbWU6ICRzY29wZS51c2VybmFtZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICRzY29wZS5jb21tZW50VG9Qb3N0XG4gICAgICAgIH07XG5cbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgdXJsOiBiYXNlU2VydmVyVXJsICsgJy9hcGkvY29tbWVudHMnLFxuICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICBcIkFjY2VwdFwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGRhdGEpXG5cbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICAkc2NvcGUub25QcmVzZXRDYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICQoXCIuc2F2ZS1wcmVzZXQtY29udGFpbmVyXCIpLnJlbW92ZSgpO1xuICAgIH07XG5cbiAgICAkc2NvcGUub25QcmVzZXRTYXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUuc2F2ZVByZXNldCgpO1xuICAgIH07XG5cbiAgICAvKlxuICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAqIHByaXZhdGVcbiAgICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIHJlbW92ZVRyYWNrKHRyYWNrKSB7XG4gICAgICAgIGRydW1NYWNoaW5lLnJlbW92ZVRyYWNrKHRyYWNrLmlkKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0RGVmYXVsdFRyYWNrcygkc2NvcGUsIGRydW1NYWNoaW5lKSB7XG5cbiAgICAgICAgZW5hYmxlTG9hZGluZ1NwaW5uZXIoKTtcblxuICAgICAgICBkcnVtTWFjaGluZS5fbG9hZERlZmF1bHRCdWZmZXJzKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkcnVtTWFjaGluZS5faW5pdERlZmF1bHRUcmFja3MoKTtcbiAgICAgICAgICAgICRzY29wZS50cmFja3MgPSBkcnVtTWFjaGluZS50cmFja3M7XG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICBkaXNhYmxlTG9hZGluZ1NwaW5uZXIoKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXREQVRndWkoZHJ1bU1hY2hpbmUpIHtcbiAgICAgICAgdmFyIGd1aSA9IG5ldyBkYXQuR1VJKCk7XG4gICAgICAgIHZhciBicG1Db250cm9sbGVyID0gZ3VpLmFkZChkcnVtTWFjaGluZSwgXCJicG1cIiwgNTAuMCwgMjIwLjApO1xuXG4gICAgICAgIGJwbUNvbnRyb2xsZXIub25DaGFuZ2UoZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBkcnVtTWFjaGluZS5icG0gPSBNYXRoLmZsb29yKGRydW1NYWNoaW5lLmJwbSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXRTZXF1ZW5jZXJDb250cm9scyhzY29wZSwgZHJ1bU1hY2hpbmUpIHtcblxuICAgICAgICBwbGF5QnRuLm9uKFwibW91c2Vkb3duIHRvdWNoc3RhcnRcIiwgZnVuY3Rpb24gKGUpIHtcblxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuICAgICAgICAgICAgcGxheUJ0bi5jc3Moe1xuICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCIjNDQ0XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBwbGF5QnRuLm9uKFwibW91c2V1cCB0b3VjaGVuZFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgcGxheShlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc3RvcEJ0bi5vbihcIm1vdXNlZG93biB0b3VjaHN0YXJ0XCIsIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgIHN0b3BCdG4uY3NzKHtcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IFwiIzQ0NFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc3RvcEJ0bi5vbihcIm1vdXNldXAgdG91Y2hlbmRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHN0b3AoZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGJwbVNsaWRlci5zbGlkZXIoe1xuICAgICAgICAgICAgbWluOiBkcnVtTWFjaGluZS5icG1NaW4sXG4gICAgICAgICAgICBtYXg6IGRydW1NYWNoaW5lLmJwbU1heCxcbiAgICAgICAgICAgIG9yaWVudGF0aW9uOiBcImhvcml6b250YWxcIixcbiAgICAgICAgICAgIHZhbHVlOiBzY29wZS5icG0sXG4gICAgICAgICAgICBzbGlkZTogZnVuY3Rpb24gc2xpZGUoZXZlbnQsIHVpKSB7XG4gICAgICAgICAgICAgICAgZHJ1bU1hY2hpbmUuYnBtID0gdWkudmFsdWU7XG4gICAgICAgICAgICAgICAgc2NvcGUuYnBtID0gdWkudmFsdWU7XG4gICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmRyYWdnYWJsZSgpO1xuXG4gICAgICAgIHNjb3BlLnVwZGF0ZVNsaWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChkcnVtTWFjaGluZS5pc0luUmFuZ2VCUE0oc2NvcGUuYnBtKSkge1xuICAgICAgICAgICAgICAgIGJwbVNsaWRlci5zbGlkZXIoXCJ2YWx1ZVwiLCBzY29wZS5icG0pO1xuICAgICAgICAgICAgICAgIGRydW1NYWNoaW5lLmJwbSA9IHNjb3BlLmJwbTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwbGF5KGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIHBsYXlCdG4uY3NzKHtcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxuICAgICAgICAgICAgYmFja2dyb3VuZEltYWdlOiBcInVybCguL2FwcC9hc3NldHMvaWNvbnMvUGxheS01MC1ncmVlbi5wbmcpXCJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc3RvcEJ0bi5jc3Moe1xuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiBcInRyYW5zcGFyZW50XCIsXG4gICAgICAgICAgICBiYWNrZ3JvdW5kSW1hZ2U6IFwidXJsKC4vYXBwL2Fzc2V0cy9pY29ucy9TdG9wLTUwLXdoaXRlLnBuZylcIlxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuc3RhcnRTZXF1ZW5jZXIoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdG9wKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIHN0b3BCdG4uY3NzKHtcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxuICAgICAgICAgICAgYmFja2dyb3VuZEltYWdlOiBcInVybCguL2FwcC9hc3NldHMvaWNvbnMvU3RvcC01MC1yZWQucG5nKVwiXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHBsYXlCdG4uY3NzKHtcbiAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogXCJ0cmFuc3BhcmVudFwiLFxuICAgICAgICAgICAgYmFja2dyb3VuZEltYWdlOiBcInVybCguL2FwcC9hc3NldHMvaWNvbnMvUGxheS01MC13aGl0ZS5wbmcpXCJcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLnN0b3BTZXF1ZW5jZXIoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2FkUHJlc2V0RnJvbUpzb24oanNvbikge1xuXG4gICAgICAgIGVuYWJsZUxvYWRpbmdTcGlubmVyKCk7XG5cbiAgICAgICAgZHJ1bU1hY2hpbmUubG9hZFByZXNldChqc29uKS50aGVuKGZ1bmN0aW9uICh0cmFja3MpIHtcblxuICAgICAgICAgICAgdHJhY2tzLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICAgICAgICBkcnVtTWFjaGluZS50cmFja3NbdC5pZF0gPSB0O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICRzY29wZS5icG0gPSBkcnVtTWFjaGluZS5icG07XG4gICAgICAgICAgICBicG1TbGlkZXIuc2xpZGVyKFwidmFsdWVcIiwgJHNjb3BlLmJwbSk7XG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICBkaXNhYmxlTG9hZGluZ1NwaW5uZXIoKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXRFeHBvcnRNaWRpTWVudSgpIHtcblxuICAgICAgICB2YXIgQVBJID0gJChcIm5hdiNtZW51XCIpLmRhdGEoXCJtbWVudVwiKTtcbiAgICAgICAgdmFyIGxpID0gJCgnPGxpPjxhIGhyZWY9XCIjZXhwb3J0TWlkaVwiID5FeHBvcnQgbWlkaTwvYT48L2xpPicpO1xuICAgICAgICBsaS5jbGljaygkc2NvcGUuZXhwb3J0TWlkaSk7XG5cbiAgICAgICAgJChcIiNtZW51LWxpc3RcIikuZmluZChcIi5tbS1saXN0dmlld1wiKS5hcHBlbmQobGkpO1xuXG4gICAgICAgIEFQSS5pbml0UGFuZWxzKCQoXCIjbWVudS1saXN0XCIpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0UHJlc2V0c01lbnUoY2F0ZWdvcmllcykge1xuXG4gICAgICAgICQoJ2xpW2lkPVwicHJlc2V0c01lbnVcIl0nKS5yZW1vdmUoKTtcblxuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICB1cmw6IGJhc2VTZXJ2ZXJVcmwgKyBcIi9hcGkvcHJlc2V0c1wiLFxuICAgICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgIFwiQWNjZXB0XCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cbiAgICAgICAgICAgIHZhciBwcmVzZXRzRGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgICAgICAgICBpZiAocHJlc2V0c0RhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbGlQYXJlbnQgPSAkKCc8bGkgaWQ9XCJwcmVzZXRzTWVudVwiPjxhIGhyZWY9XCIjXCI+UHJlc2V0czwvYT48L2xpPicpO1xuICAgICAgICAgICAgdmFyIHVsUGFyZW50ID0gJChcIjx1bD48L3VsPlwiKTtcbiAgICAgICAgICAgIGxpUGFyZW50LmFwcGVuZCh1bFBhcmVudCk7XG5cbiAgICAgICAgICAgIGNhdGVnb3JpZXMuZm9yRWFjaChmdW5jdGlvbiAoY2F0ZWdvcnkpIHtcblxuICAgICAgICAgICAgICAgIHZhciBtYXRjaCA9IHByZXNldHNEYXRhLmZpbmQoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUuX2lkID09PSBjYXRlZ29yeS5uYW1lO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGNhdGVnb3J5UHJlc2V0cyA9IG1hdGNoLnByZXNldHM7XG5cbiAgICAgICAgICAgICAgICB2YXIgbGlDYXRlZ29yeSA9ICQoJzxsaT48YSBocmVmPVwiI1wiPicgKyBjYXRlZ29yeS5uYW1lICsgJzwvYT48L2xpPicpO1xuICAgICAgICAgICAgICAgIHZhciB1bCA9ICQoXCI8dWw+PC91bD5cIik7XG5cbiAgICAgICAgICAgICAgICBjYXRlZ29yeVByZXNldHMuZm9yRWFjaChmdW5jdGlvbiAocHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaSA9ICQoJzxsaT48YSBocmVmPVwiI1wiPicgKyBwcmVzZXQubmFtZSArICc8L2E+PC9saT4nKTtcbiAgICAgICAgICAgICAgICAgICAgbGkuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZFByZXNldEZyb21Kc29uKHByZXNldCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIHVsLmFwcGVuZChsaSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBsaUNhdGVnb3J5LmFwcGVuZCh1bCk7XG4gICAgICAgICAgICAgICAgdWxQYXJlbnQuYXBwZW5kKGxpQ2F0ZWdvcnkpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHZhciBBUEkgPSAkKFwibmF2I21lbnVcIikuZGF0YShcIm1tZW51XCIpO1xuICAgICAgICAgICAgJChcIiNtZW51LWxpc3RcIikuZmluZChcIi5tbS1saXN0dmlldyBsaTpmaXJzdFwiKS5hZnRlcihsaVBhcmVudCk7XG4gICAgICAgICAgICBBUEkuaW5pdFBhbmVscygkKFwiI21lbnUtbGlzdFwiKSk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvclJlc3BvbnNlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvclJlc3BvbnNlKTtcbiAgICAgICAgICAgIGluaXRFeHBvcnRNaWRpTWVudSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0U2F2ZVByZXNldE1lbnUoKSB7XG4gICAgICAgIHZhciBsaSA9ICQoJzxsaT48YSBocmVmPVwiI1wiPlNhdmUgcHJlc2V0PC9hPjwvbGk+Jyk7XG5cbiAgICAgICAgbGkuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHNhdmVQcmVzZXQgPSBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2F2ZS1wcmVzZXQnKSk7XG4gICAgICAgICAgICB2YXIgZG9tRWxlbSA9ICRjb21waWxlKHNhdmVQcmVzZXQpKCRzY29wZSk7XG4gICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkuYXBwZW5kKGRvbUVsZW0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB2YXIgQVBJID0gJChcIm5hdiNtZW51XCIpLmRhdGEoXCJtbWVudVwiKTtcbiAgICAgICAgJChcIiNtZW51LWxpc3RcIikuZmluZChcIi5tbS1saXN0dmlld1wiKS5hcHBlbmQobGkpO1xuICAgICAgICBBUEkuaW5pdFBhbmVscygkKFwiI21lbnUtbGlzdFwiKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbG9hZENvbW1lbnRzKCkge1xuXG4gICAgICAgIGVuYWJsZUNvbW1lbnRzTG9hZGluZ1NwaW5uZXIoKTtcblxuICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICB1cmw6IGJhc2VTZXJ2ZXJVcmwgKyAnL2FwaS9jb21tZW50cycsXG4gICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgXCJBY2NlcHRcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgJHNjb3BlLmNvbW1lbnRzID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICRzY29wZS5zYWZlQXBwbHkoKTtcbiAgICAgICAgICAgIGRpc2FibGVDb21tZW50c0xvYWRpbmdTcGlubmVyKCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBlbmFibGVMb2FkaW5nU3Bpbm5lcigpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsb2FkaW5nQ29udGFpbmVyLmFkZENsYXNzKFwibG9hZGluZy1hY3RpdmVcIik7XG4gICAgICAgIH0sIDApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc2FibGVMb2FkaW5nU3Bpbm5lcigpIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsb2FkaW5nQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwibG9hZGluZy1hY3RpdmVcIik7XG4gICAgICAgIH0sIDE1MDApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVuYWJsZUNvbW1lbnRzTG9hZGluZ1NwaW5uZXIoKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29tbWVudHNMb2FkaW5nT3ZlcmxheS5hZGRDbGFzcyhcImxvYWRpbmctYWN0aXZlXCIpO1xuICAgICAgICAgICAgY29tbWVudHNMb2FkaW5nU3Bpbm5lci5hZGRDbGFzcyhcImxvYWRpbmctYWN0aXZlXCIpO1xuICAgICAgICB9LCAxMDApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRpc2FibGVDb21tZW50c0xvYWRpbmdTcGlubmVyKCkge1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbW1lbnRzTG9hZGluZ092ZXJsYXkucmVtb3ZlQ2xhc3MoXCJsb2FkaW5nLWFjdGl2ZVwiKTtcbiAgICAgICAgICAgIGNvbW1lbnRzTG9hZGluZ1NwaW5uZXIucmVtb3ZlQ2xhc3MoXCJsb2FkaW5nLWFjdGl2ZVwiKTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0b2FzdEVycm9yKHRleHQpIHtcbiAgICAgICAgJC50b2FzdCh7XG4gICAgICAgICAgICB0ZXh0OiB0ZXh0LFxuICAgICAgICAgICAgc2hvd0hpZGVUcmFuc2l0aW9uOiAnc2xpZGUnLCAvLyBJdCBjYW4gYmUgcGxhaW4sIGZhZGUgb3Igc2xpZGVcbiAgICAgICAgICAgIGJnQ29sb3I6ICcjZmY0YTQwJywgLy8gQmFja2dyb3VuZCBjb2xvciBmb3IgdG9hc3RcbiAgICAgICAgICAgIHRleHRDb2xvcjogJyNmZmYnLCAvLyB0ZXh0IGNvbG9yXG4gICAgICAgICAgICBhbGxvd1RvYXN0Q2xvc2U6IGZhbHNlLCAvLyBTaG93IHRoZSBjbG9zZSBidXR0b24gb3Igbm90XG4gICAgICAgICAgICBoaWRlQWZ0ZXI6IDMwMDAsIC8vIGBmYWxzZWAgdG8gbWFrZSBpdCBzdGlja3kgb3IgdGltZSBpbiBtaWxpc2Vjb25kcyB0byBoaWRlIGFmdGVyXG4gICAgICAgICAgICBzdGFjazogNSwgLy8gYGZha3NlYCB0byBzaG93IG9uZSBzdGFjayBhdCBhIHRpbWUgY291bnQgc2hvd2luZyB0aGUgbnVtYmVyIG9mIHRvYXN0cyB0aGF0IGNhbiBiZSBzaG93biBhdCBvbmNlXG4gICAgICAgICAgICB0ZXh0QWxpZ246ICdsZWZ0JywgLy8gQWxpZ25tZW50IG9mIHRleHQgaS5lLiBsZWZ0LCByaWdodCwgY2VudGVyXG4gICAgICAgICAgICBwb3NpdGlvbjogJ3RvcC1yaWdodCcgLy8gYm90dG9tLWxlZnQgb3IgYm90dG9tLXJpZ2h0IG9yIGJvdHRvbS1jZW50ZXIgb3IgdG9wLWxlZnQgb3IgdG9wLXJpZ2h0IG9yIHRvcC1jZW50ZXIgb3IgbWlkLWNlbnRlciBvciBhbiBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBsZWZ0LCByaWdodCwgdG9wLCBib3R0b20gdmFsdWVzIHRvIHBvc2l0aW9uIHRoZSB0b2FzdCBvbiBwYWdlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRvYXN0T2sodGV4dCkge1xuICAgICAgICAkLnRvYXN0KHtcbiAgICAgICAgICAgIHRleHQ6IHRleHQsXG4gICAgICAgICAgICBzaG93SGlkZVRyYW5zaXRpb246ICdzbGlkZScsIC8vIEl0IGNhbiBiZSBwbGFpbiwgZmFkZSBvciBzbGlkZVxuICAgICAgICAgICAgYmdDb2xvcjogJyMwNWEyZmMnLCAvLyBCYWNrZ3JvdW5kIGNvbG9yIGZvciB0b2FzdFxuICAgICAgICAgICAgdGV4dENvbG9yOiAnI2ZmZicsIC8vIHRleHQgY29sb3JcbiAgICAgICAgICAgIGFsbG93VG9hc3RDbG9zZTogZmFsc2UsIC8vIFNob3cgdGhlIGNsb3NlIGJ1dHRvbiBvciBub3RcbiAgICAgICAgICAgIGhpZGVBZnRlcjogMzAwMCwgLy8gYGZhbHNlYCB0byBtYWtlIGl0IHN0aWNreSBvciB0aW1lIGluIG1pbGlzZWNvbmRzIHRvIGhpZGUgYWZ0ZXJcbiAgICAgICAgICAgIHN0YWNrOiA1LCAvLyBgZmFrc2VgIHRvIHNob3cgb25lIHN0YWNrIGF0IGEgdGltZSBjb3VudCBzaG93aW5nIHRoZSBudW1iZXIgb2YgdG9hc3RzIHRoYXQgY2FuIGJlIHNob3duIGF0IG9uY2VcbiAgICAgICAgICAgIHRleHRBbGlnbjogJ2xlZnQnLCAvLyBBbGlnbm1lbnQgb2YgdGV4dCBpLmUuIGxlZnQsIHJpZ2h0LCBjZW50ZXJcbiAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wLXJpZ2h0JyAvLyBib3R0b20tbGVmdCBvciBib3R0b20tcmlnaHQgb3IgYm90dG9tLWNlbnRlciBvciB0b3AtbGVmdCBvciB0b3AtcmlnaHQgb3IgdG9wLWNlbnRlciBvciBtaWQtY2VudGVyIG9yIGFuIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIGxlZnQsIHJpZ2h0LCB0b3AsIGJvdHRvbSB2YWx1ZXMgdG8gcG9zaXRpb24gdGhlIHRvYXN0IG9uIHBhZ2VcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICogaW5pdFxuICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAqL1xuXG4gICAgdmFyIHNvY2tldCA9IGlvLmNvbm5lY3QoYmFzZVNlcnZlclVybCk7XG4gICAgaW5pdFNlcXVlbmNlckNvbnRyb2xzKCRzY29wZSwgZHJ1bU1hY2hpbmUpO1xuXG4gICAgJCh3aW5kb3cpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaW5pdFNhdmVQcmVzZXRNZW51KCk7XG4gICAgICAgIGluaXRFeHBvcnRNaWRpTWVudSgpO1xuXG4gICAgICAgICRzY29wZS5wb3B1bGF0ZUNhdGVnb3JpZXMoKS50aGVuKGZ1bmN0aW9uIChjYXRlZ29yaWVzKSB7XG4gICAgICAgICAgICBpbml0UHJlc2V0c01lbnUoY2F0ZWdvcmllcyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkc2NvcGUucG9wdWxhdGVDYXRlZ29yaWVzKCkudGhlbihmdW5jdGlvbiAoY2F0ZWdvcmllcykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiJGludGVydmFsOiBwb3B1bGF0ZUNhdGVnb3JpZXNcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSwgMjAwMDApO1xuXG4gICAgICAgIHNvY2tldC5vbihzb2NrZXRFdmVudHMubmV3UHJlc2V0LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coc29ja2V0RXZlbnRzLnByZXNldFNhdmVkLCBkYXRhKTtcbiAgICAgICAgICAgIGluaXRQcmVzZXRzTWVudSgkc2NvcGUucHJlc2V0LmNhdGVnb3JpZXMpO1xuICAgICAgICB9KTtcblxuICAgICAgICBzb2NrZXQub24oc29ja2V0RXZlbnRzLnByZXNldFNhdmVkLCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgdG9hc3RPayhcIlByZXNldCBzYXZlZCFcIik7XG4gICAgICAgICAgICAkc2NvcGUub25QcmVzZXRDYW5jZWwoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgc29ja2V0Lm9uKHNvY2tldEV2ZW50cy5wcmVzZXRDb25mbGljdCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHNvY2tldEV2ZW50cy5wcmVzZXRDb25mbGljdCwgZGF0YSk7XG4gICAgICAgICAgICB0b2FzdEVycm9yKGRhdGEpO1xuICAgICAgICB9KTtcblxuICAgICAgICBzb2NrZXQub24oc29ja2V0RXZlbnRzLmNvbW1lbnRTYXZlZCwgZnVuY3Rpb24gKGNvbW1lbnQpIHtcbiAgICAgICAgICAgIC8vIHRvYXN0T2soXCJDb21tZW50IHBvc3RlZCFcIik7XG4gICAgICAgICAgICAkc2NvcGUuY29tbWVudHMuc3BsaWNlKDAsIDAsIGNvbW1lbnQpO1xuICAgICAgICAgICAgJHNjb3BlLmNvbW1lbnRUb1Bvc3QgPSBcIlwiO1xuICAgICAgICAgICAgJHNjb3BlLnNhZmVBcHBseSgpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy50ZXN0Q29udHJvbGxlciA9IHRlc3RDb250cm9sbGVyO1xuLypcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogdGVzdENvbnRyb2xsZXIuanNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICovXG5cbmZ1bmN0aW9uIHRlc3RDb250cm9sbGVyKCRzY29wZSkge1xuXG4gICAgJHNjb3BlLnRpdGxlID0gXCJUZXN0IENvbnRyb2xsZXJcIjtcbiAgICBjb25zb2xlLmxvZyhcIlRlc3QgQ29udHJvbGxlclwiKTtcbn0iLCIvKipcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogY29tbWVudERpcmVjdGl2ZS5qc1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuY29tbWVudERpcmVjdGl2ZSA9IGNvbW1lbnREaXJlY3RpdmU7XG5mdW5jdGlvbiBjb21tZW50RGlyZWN0aXZlKCkge1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBRScsXG4gICAgICAgIHJlcGxhY2U6ICdmYWxzZScsXG4gICAgICAgIHRlbXBsYXRlVXJsOiBcImFwcC9kaXJlY3RpdmVzL3RlbXBsYXRlcy9jb21tZW50RGlyZWN0aXZlLmh0bWxcIixcbiAgICAgICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHt9XG4gICAgfTtcbn0iLCIvKipcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogc2F2ZVByZXNldERpcmVjdGl2ZS5qc1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuc2F2ZVByZXNldERpcmVjdGl2ZSA9IHNhdmVQcmVzZXREaXJlY3RpdmU7XG5mdW5jdGlvbiBzYXZlUHJlc2V0RGlyZWN0aXZlKCkge1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBRScsXG4gICAgICAgIHJlcGxhY2U6ICdmYWxzZScsXG4gICAgICAgIHRlbXBsYXRlVXJsOiBcImFwcC9kaXJlY3RpdmVzL3RlbXBsYXRlcy9zYXZlUHJlc2V0Lmh0bWxcIixcbiAgICAgICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHtcblxuICAgICAgICAgICAgc2NvcGUudGFnSGFuZGxlciA9IGZ1bmN0aW9uICh0YWcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHNjb3BlLmludmFsaWRQcmVzZXROYW1lTWVzc2FnZSA9IFwiQ2hvb3NlIGEgcHJlc2V0IG5hbWUgKDYtMzIgY2hhcmFjdGVycylcIjtcbiAgICAgICAgICAgIHNjb3BlLmludmFsaWRDYXRlZ29yeU1lc3NhZ2UgPSBcIkNob29zZSBhIGNhdGVnb3J5XCI7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGluaXRVSSgpIHtcblxuICAgICAgICAgICAgICAgICQoXCIjcHJlc2V0Q2FuY2VsQnRuXCIpLmJ1dHRvbigpO1xuICAgICAgICAgICAgICAgICQoXCIjcHJlc2V0U2F2ZUJ0blwiKS5idXR0b24oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAqIGluaXRcbiAgICAgICAgICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIGluaXRVSSgpO1xuICAgICAgICB9XG5cbiAgICB9O1xufSIsIi8qKlxuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiB0aWNrU2xpZGVyRGlyZWN0aXZlLmpzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqL1xuXG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy50aWNrU2xpZGVyRGlyZWN0aXZlID0gdGlja1NsaWRlckRpcmVjdGl2ZTtcbmZ1bmN0aW9uIHRpY2tTbGlkZXJEaXJlY3RpdmUoKSB7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0FFJyxcbiAgICAgICAgcmVwbGFjZTogJ2ZhbHNlJyxcbiAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIHRpY2s6IFwiPVwiLFxuICAgICAgICAgICAgdGlja3NFbGVtZW50czogXCI9XCIsXG4gICAgICAgICAgICByZXNpemVUaWNrOiBcIj1cIlxuICAgICAgICB9LFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtLCBhdHRycykge1xuXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzY29wZS50aWNrKTtcbiAgICAgICAgICAgIHNjb3BlLnRpY2tzRWxlbWVudHMucHVzaChlbGVtKTtcblxuICAgICAgICAgICAgZWxlbS5zbGlkZXIoe1xuICAgICAgICAgICAgICAgIG1pbjogMCxcbiAgICAgICAgICAgICAgICBtYXg6IDEwMCxcbiAgICAgICAgICAgICAgICBvcmllbnRhdGlvbjogXCJ2ZXJ0aWNhbFwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBzY29wZS50aWNrLmFjdGl2ZSA/IHNjb3BlLnRpY2sudm9sdW1lICogMTAwIDogMCxcbiAgICAgICAgICAgICAgICBzbGlkZTogZnVuY3Rpb24gc2xpZGUoZXZlbnQsIHVpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHVpLnZhbHVlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS50aWNrLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudGljay5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudGljay52b2x1bWUgPSB1aS52YWx1ZSAqIDAuMDE7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHNjb3BlLnRpY2sudm9sdW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5kcmFnZ2FibGUoKTtcblxuICAgICAgICAgICAgLy8gc2NvcGUucmVzaXplVGljayhlbGVtKTtcbiAgICAgICAgfVxuICAgIH07XG59IiwiLyoqXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIHRyYWNrRGlyZWN0aXZlXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqL1xuXG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy50cmFja0RpcmVjdGl2ZSA9IHRyYWNrRGlyZWN0aXZlO1xuXG52YXIgX3V0aWxzID0gcmVxdWlyZShcIi4uL3V0aWxzL3V0aWxzXCIpO1xuXG5mdW5jdGlvbiB0cmFja0RpcmVjdGl2ZShzdXBwb3J0ZWRBdWRpb0Zvcm1hdHMpIHtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3RyaWN0OiAnQUUnLFxuICAgICAgICByZXBsYWNlOiAnZmFsc2UnLFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgdHJhY2s6IFwiPVwiLFxuICAgICAgICAgICAgdGlja3NFbGVtZW50czogXCI9XCIsXG4gICAgICAgICAgICByZW1vdmVUcmFjazogXCI9XCJcbiAgICAgICAgfSxcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiYXBwL2RpcmVjdGl2ZXMvdGVtcGxhdGVzL3RyYWNrRGlyZWN0aXZlLmh0bWxcIixcbiAgICAgICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbSwgYXR0cnMpIHtcblxuICAgICAgICAgICAgc2NvcGUucmVzaXplVGljayA9IHJlc2l6ZVRpY2s7XG4gICAgICAgICAgICBzY29wZS5oYW5kbGVGaWxlcyA9IGhhbmRsZUZpbGVzO1xuICAgICAgICAgICAgc2NvcGUucGxheVNvdW5kID0gcGxheVNvdW5kO1xuICAgICAgICAgICAgc2NvcGUub25Tb2xvVHJhY2sgPSBvblNvbG9UcmFjaztcbiAgICAgICAgICAgIHNjb3BlLm9uTXV0ZVRyYWNrID0gb25NdXRlVHJhY2s7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAqIHN0eWxlcyAmIHdpZGdldHNcbiAgICAgICAgICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIGVsZW0uZmluZCgnYnV0dG9uW25hbWU9XCJyZW1vdmVUcmFja0J1dHRvblwiXScpLmJ1dHRvbih7XG4gICAgICAgICAgICAgICAgaWNvbjogXCJ1aS1pY29uLWNsb3NlXCIsXG4gICAgICAgICAgICAgICAgc2hvd0xhYmVsOiBmYWxzZVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGVsZW0uZmluZCgnYnV0dG9uW25hbWU9XCJwbGF5U291bmRCdXR0b25cIl0nKS5idXR0b24oe1xuICAgICAgICAgICAgICAgIGljb246IFwidWktaWNvbi1jaXJjbGUtdHJpYW5nbGUtZVwiLFxuICAgICAgICAgICAgICAgIHNob3dMYWJlbDogZmFsc2VcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBlbGVtLmZpbmQoJ2RpdltpZD1cInRyYWNrVm9sdW1lU2xpZGVyXCJdJykuc2xpZGVyKHtcbiAgICAgICAgICAgICAgICBtaW46IDAsXG4gICAgICAgICAgICAgICAgbWF4OiAxMDAsXG4gICAgICAgICAgICAgICAgb3JpZW50YXRpb246IFwiaG9yaXpvbnRhbFwiLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBzY29wZS50cmFjay5nYWluTm9kZS5nYWluLnZhbHVlICogMTAwLFxuICAgICAgICAgICAgICAgIHNsaWRlOiBmdW5jdGlvbiBzbGlkZShldmVudCwgdWkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudHJhY2suZ2Fpbk5vZGUuZ2Fpbi52YWx1ZSA9IHVpLnZhbHVlICogMC4wMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5kcmFnZ2FibGUoKTtcblxuICAgICAgICAgICAgaWYgKHNjb3BlLnRyYWNrLnBhbm5lck5vZGVTdXBwb3J0ZWQpIHtcbiAgICAgICAgICAgICAgICBlbGVtLmZpbmQoJ2RpdltpZD1cInRyYWNrUGFuU2xpZGVyXCJdJykuc2xpZGVyKHtcbiAgICAgICAgICAgICAgICAgICAgbWluOiAtMTAwLFxuICAgICAgICAgICAgICAgICAgICBtYXg6IDEwMCxcbiAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb246IFwiaG9yaXpvbnRhbFwiLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogc2NvcGUudHJhY2sucGFubmVyTm9kZS5wYW4udmFsdWUgKiAxMDAsXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlOiBmdW5jdGlvbiBzbGlkZShldmVudCwgdWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnRyYWNrLnBhbm5lck5vZGUucGFuLnZhbHVlID0gdWkudmFsdWUgKiAwLjAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSkuZHJhZ2dhYmxlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVsZW0uZmluZCgnZGl2W2lkPVwidHJhY2tQYW5TbGlkZXJcIl0nKS5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBlbGVtLmZpbmQoXCIucGFuLWxhYmVsXCIpLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gcHVzaCBkb3duIHZvbHVtZSBzbGlkZXJcbiAgICAgICAgICAgICAgICBlbGVtLmZpbmQoJ2RpdltpZD1cInRyYWNrVm9sdW1lU2xpZGVyXCJdJykuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgLy8gbWFyZ2luVG9wOiAwLFxuICAgICAgICAgICAgICAgICAgICAvLyBwb3NpdGlvbjogXCJyZWxhdGl2ZVwiLFxuICAgICAgICAgICAgICAgICAgICAvLyBib3R0b206IDBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZWxlbS5maW5kKCdidXR0b25bbmFtZT1zb2xvVHJhY2tCdXR0b25dJykuYnV0dG9uKHt9KTtcblxuICAgICAgICAgICAgZWxlbS5maW5kKCdidXR0b25bbmFtZT1tdXRlVHJhY2tCdXR0b25dJykuYnV0dG9uKHt9KTtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICogZXZlbnQgbGlzdGVuZXJzXG4gICAgICAgICAgICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAvLyAkKHdpbmRvdykucmVzaXplKCgpID0+IHtcbiAgICAgICAgICAgIC8vICAgICBzY29wZS50aWNrc0VsZW1lbnRzLmZvckVhY2goKGUpID0+IHtcbiAgICAgICAgICAgIC8vICAgICAgICAgcmVzaXplVGljayhlKTtcbiAgICAgICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgICAgIC8vIH0pO1xuXG5cbiAgICAgICAgICAgIGVsZW0ub24oXCJkcmFnb3ZlclwiLCBvbkRyYWdPdmVyKTtcbiAgICAgICAgICAgIGVsZW0ub24oXCJkcm9wXCIsIG9uRHJvcCk7XG4gICAgICAgICAgICBlbGVtLm9uKFwiZHJhZ2xlYXZlXCIsIG9uRHJhZ0xlYXZlKTtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICogcHJpdmF0ZSBmdW5jdGlvbnNcbiAgICAgICAgICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHJlc2l6ZVRpY2sodGlja0VsZW0pIHtcbiAgICAgICAgICAgICAgICB2YXIgdGlja3NDb250YWluZXJXaWR0aCA9IGVsZW0uZmluZChcIi50aWNrcy1jb250YWluZXJcIikud2lkdGgoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aWNrc0NvbnRhaW5lcldpZHRoKTtcbiAgICAgICAgICAgICAgICB2YXIgbWFyZ2luID0gODtcbiAgICAgICAgICAgICAgICB2YXIgdGlja1dpZHRoID0gTWF0aC5mbG9vcigodGlja3NDb250YWluZXJXaWR0aCAtIDE1ICogbWFyZ2luKSAvIDE2LjApO1xuXG4gICAgICAgICAgICAgICAgLy8gdGlja0VsZW0uY3NzKHtcbiAgICAgICAgICAgICAgICAvLyAgICAgd2lkdGg6IDMyLFxuICAgICAgICAgICAgICAgIC8vICAgICBtYXJnaW5SaWdodDogXCI4cHggIWltcG9ydGFudFwiXG4gICAgICAgICAgICAgICAgLy8gfSk7XG5cblxuICAgICAgICAgICAgICAgIC8vIHRpY2tFbGVtLnBhcmVudCgpLmNzcyh7XG4gICAgICAgICAgICAgICAgLy8gICAgIHdpZHRoOiB0aWNrV2lkdGgsXG4gICAgICAgICAgICAgICAgLy8gICAgIG1hcmdpblJpZ2h0OiBtYXJnaW5cbiAgICAgICAgICAgICAgICAvLyB9KTtcblxuXG4gICAgICAgICAgICAgICAgLy8gdGlja0VsZW0uZmluZChcIi51aS1zbGlkZXItaGFuZGxlXCIpLmNzcyh7XG4gICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAvLyB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gaGFuZGxlRmlsZXMoZmlsZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWZpbGVzIHx8IGZpbGVzLmxlbmd0aCA8IDEpIHJldHVybjtcblxuICAgICAgICAgICAgICAgIHZhciBmaWxlID0gZmlsZXNbMF07XG4gICAgICAgICAgICAgICAgdmFyIGZpbGVFeHRlbnNpb24gPSAoMCwgX3V0aWxzLmdldEZpbGVFeHRlbnNpb24pKGZpbGUubmFtZSk7XG5cbiAgICAgICAgICAgICAgICAvLyBjaGVjaCBpZiBpdCBpcyBhbiBhdWRpbyBmaWxlIHdpdGggYSBzdXBwb3J0ZWQgZXh0ZW5zaW9uXG4gICAgICAgICAgICAgICAgaWYgKCFzdXBwb3J0ZWRBdWRpb0Zvcm1hdHMuaGFzKGZpbGVFeHRlbnNpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmlsZSBmb3JtYXQgbm90IHN1cHBvcnRlZCBieSBXZWIgQXVkaW8gQVBJOiBcIiwgZmlsZUV4dGVuc2lvbik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFycmF5QnVmZmVyID0gZXYudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudHJhY2suc2V0U2FtcGxlRGF0YShmaWxlLm5hbWUsIGFycmF5QnVmZmVyKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGZpbGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkRyYWdPdmVyKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWVsZW0uaGFzQ2xhc3MoXCJ0cmFjay1kcmFnZmlsZVwiKSkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtLmFkZENsYXNzKFwidHJhY2stZHJhZ2ZpbGVcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbkRyb3AoZSkge1xuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIGhhbmRsZUZpbGVzKGUub3JpZ2luYWxFdmVudC5kYXRhVHJhbnNmZXIuZmlsZXMpO1xuICAgICAgICAgICAgICAgIG9uRHJhZ0xlYXZlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uRHJhZ0xlYXZlKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoZWxlbS5oYXNDbGFzcyhcInRyYWNrLWRyYWdmaWxlXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3MoXCJ0cmFjay1kcmFnZmlsZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gcGxheVNvdW5kKCkge1xuICAgICAgICAgICAgICAgIHNjb3BlLnRyYWNrLnBsYXlTb3VuZCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvblNvbG9UcmFjaygpIHtcbiAgICAgICAgICAgICAgICBzY29wZS50cmFjay5kcnVtTWFjaGluZS5zb2xvVHJhY2soc2NvcGUudHJhY2suaWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBvbk11dGVUcmFjaygpIHtcbiAgICAgICAgICAgICAgICBzY29wZS50cmFjay5kcnVtTWFjaGluZS5tdXRlVHJhY2soc2NvcGUudHJhY2suaWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5pbml0Um91dGVzID0gaW5pdFJvdXRlcztcbi8qXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIHJvdXRlcy5qc1xuICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKi9cblxuZnVuY3Rpb24gaW5pdFJvdXRlcygkcm91dGVQcm92aWRlcikge1xuXG4gICAgJHJvdXRlUHJvdmlkZXIud2hlbignLycsIHtcbiAgICAgICAgY29udHJvbGxlcjogXCJkcnVtTWFjaGluZUNvbnRyb2xsZXJcIixcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiYXBwL2NvbXBvbmVudHMvZHJ1bS1tYWNoaW5lL2RydW1NYWNoaW5lVmlldy5odG1sXCJcbiAgICB9KTtcblxuICAgICRyb3V0ZVByb3ZpZGVyLndoZW4oJy90ZXN0Jywge1xuICAgICAgICBjb250cm9sbGVyOiBcInRlc3RDb250cm9sbGVyXCIsXG4gICAgICAgIHRlbXBsYXRlVXJsOiBcImFwcC9jb21wb25lbnRzL3Rlc3QvdGVzdFZpZXcuaHRtbFwiXG4gICAgfSk7XG5cbiAgICAkcm91dGVQcm92aWRlci5vdGhlcndpc2UoeyByZWRpcmVjdFRvOiAnLycgfSk7XG59IiwiLypcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogdXRpbHMuanNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICovXG5cblwidXNlIHN0cmljdFwiO1xuXG4vKlxuICogY2hlY2tJZmlPU2RldmljZVxuICovXG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuY2hlY2tJZmlPU2RldmljZSA9IGNoZWNrSWZpT1NkZXZpY2U7XG5leHBvcnRzLmd1aWQgPSBndWlkO1xuZXhwb3J0cy5nZXRFeHRlbnNpb25Gcm9tRmlsZU5hbWUgPSBnZXRFeHRlbnNpb25Gcm9tRmlsZU5hbWU7XG5leHBvcnRzLmdldEZpbGVOYW1lRnJvbVBhdGggPSBnZXRGaWxlTmFtZUZyb21QYXRoO1xuZXhwb3J0cy5nZXRBcnJheUF1ZGlvQnVmZmVyRnJvbVVybCA9IGdldEFycmF5QXVkaW9CdWZmZXJGcm9tVXJsO1xuZXhwb3J0cy5nZXRGaWxlRXh0ZW5zaW9uID0gZ2V0RmlsZUV4dGVuc2lvbjtcbmZ1bmN0aW9uIGNoZWNrSWZpT1NkZXZpY2UoKSB7XG4gICAgcmV0dXJuICgvaVBhZHxpUGhvbmV8aVBvZC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSAmJiAhd2luZG93Lk1TU3RyZWFtXG4gICAgKTtcbn1cblxuLypcbiAqIGdlbmVyYXRlIHV1aWRcbiAqL1xuZnVuY3Rpb24gZ3VpZCgpIHtcbiAgICB2YXIgdXVpZCA9ICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgZnVuY3Rpb24gKGMpIHtcbiAgICAgICAgdmFyIHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwLFxuICAgICAgICAgICAgdiA9IGMgPT0gJ3gnID8gciA6IHIgJiAweDMgfCAweDg7XG4gICAgICAgIHJldHVybiB2LnRvU3RyaW5nKDE2KTtcbiAgICB9KTtcbiAgICByZXR1cm4gdXVpZDtcbn1cblxuZnVuY3Rpb24gZ2V0RXh0ZW5zaW9uRnJvbUZpbGVOYW1lKGZpbGVOYW1lKSB7XG4gICAgdmFyIHJlID0gLyg/OlxcLihbXi5dKykpPyQvO1xuICAgIHZhciBleHQgPSByZS5leGVjKGZpbGVOYW1lKVsxXTtcbiAgICByZXR1cm4gZXh0O1xufVxuXG5mdW5jdGlvbiBnZXRGaWxlTmFtZUZyb21QYXRoKHBhdGgpIHtcbiAgICByZXR1cm4gcGF0aC5yZXBsYWNlKC9eLipbXFxcXFxcL10vLCAnJyk7XG59XG5cbmZ1bmN0aW9uIGdldEFycmF5QXVkaW9CdWZmZXJGcm9tVXJsKGF1ZGlvQ3R4LCB1cmwpIHtcblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cbiAgICAgICAgaWYgKCFhdWRpb0N0eCkge1xuICAgICAgICAgICAgcmVqZWN0KFwiTWlzc2luZyBhdWRpbyBjb250ZXh0IHBhcmFtZXRlci5cIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXVybCkge1xuICAgICAgICAgICAgcmVqZWN0KFwiTWlzc2luZyB1cmwgcGFyYW1ldGVyXCIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICB4aHIub3BlbihcIkdFVFwiLCB1cmwpO1xuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gXCJhcnJheWJ1ZmZlclwiO1xuXG4gICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXNvbHZlKHhoci5yZXNwb25zZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgeGhyLnNlbmQoKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0RmlsZUV4dGVuc2lvbihmaWxlTmFtZSkge1xuICAgIHJldHVybiBmaWxlTmFtZS5zdWJzdHIoZmlsZU5hbWUubGFzdEluZGV4T2YoJy4nKSArIDEpO1xufSJdfQ==\n"]}