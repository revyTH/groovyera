{"version":3,"sources":["app.bundle.min.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","_routes","_drumMachineController","_testController","_trackDirective","_tickSliderDirective","_commentDirective","_savePresetDirective","_loadSamples","app","angular","config","initRoutes","controller","drumMachineController","testController","directive","tickSliderDirective","trackDirective","commentDirective","savePresetDirective","loadSamples","supportedAudioFormats","Set","add","socketEvents","newPreset","newComment","constant","./components/drum-machine/drumMachineController","./components/test/testController","./directives/commentDirective","./directives/loadSamples","./directives/savePresetDirective","./directives/tickSliderDirective","./directives/trackDirective","./routes","2","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","DrumMachine","undefined","_typeof","Symbol","iterator","obj","constructor","prototype","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","_utils","_Track","this","tag","numberOfBeats","AudioContext","window","webkitAudioContext","audioContext","pannerNodeSupported","bpm","bpmMin","bpmMax","timeSignature","num","den","tickTime","isPlaying","isStopped","buffers","tracks","_tracksInSolo","_tracksInMute","currentTickIndex","callBacksInLoop","soundURLs","kick","snare","hat","ride","checkIfiOSdevice","_enableAudioContextForiOS","audioContextEnabled","createStereoPanner","console","log","_this","$","document","ready","btn","visibility","on","buffer","createBuffer","source","createBufferSource","start","trigger","scheduler","self","clearTimeout","timeOutID","nextTickTime","ctx","currentTime","each","id","track","mute","sampleData","decodedAudioBuffer","trackTick","ticks","index","active","tickSound","tickGainNode","createGain","connect","gain","volume","gainNode","previousIndex","previousPrevious","firstLoopEnded","forEach","fn","setTimeout","startTime","bufferName","time","sound","destination","trackID","delete","hasOwnProperty","focusTrack","tracksInSolo","tracksInMute","has","solo","size","clear","push","name","keys","Track","setTicksFromArray","_createEmptyTicksArray","soundPath","pan","_this2","Promise","resolve","reject","pannerNode","data","_this3","_clearTracks","promises","createTrack","all","category","_this4","trackData","fileName","ticksData","tick","JSON","stringify","get","_bpm","set","val","_onBpmChanged","../utils/utils","./Track","./audio-loader","3","Tick","arguments","4","_Tick","drumMachine","guid","extension","originalBuffer","getArrayAudioBufferFromUrl","then","getFileNameFromPath","setSampleData","_initTicks","arrayBuffer","decodeAudioData","arrayAudioBuffer","decodedBuffer","getExtensionFromFileName","./Tick","5","audioLoader","audioCtx","url","xhr","XMLHttpRequest","open","responseType","onload","response","send","getArrayBuffer","6","groovyRockPreset","psyTrancePreset","7","$scope","$compile","$http","$interval","serverBaseURL","FileSaver","Blob","removeTrack","play","preventDefault","stopPropagation","stopBtn","removeClass","playBtn","addClass","css","backgroundColor","startSequencer","stop","stopSequencer","loadPreset","scrollTo","enableLoadingSpinner","bpmSlider","slider","preset","text","safeApply","disableLoadingSpinner","error","initExportMidiMenu","API","li","click","exportMidi","find","append","initPanels","initPresetsMenu","categories","remove","method","headers","Accept","presetsData","liParent","ulParent","match","_id","categoryPresets","presets","liCategory","ul","after","errorResponse","initSavePresetMenu","savePreset","element","createElement","domElem","body","loadComments","enableCommentsLoadingSpinner","comments","disableCommentsLoadingSpinner","loadingContainer","commentsLoadingOverlay","commentsLoadingSpinner","toastError","toast","showHideTransition","bgColor","textColor","allowToastClose","hideAfter","stack","textAlign","position","toastOk","_DrumMachine","phase","$root","$$phase","$apply","title","ticksElements","integerval","beats","Array","fill","samplesData","samplesBuffers","username","commentToPost","invalidUsernameMessage","invalidCommentMessage","categorySelected","accordion","animate","collapsible","heightStyle","beforeActivate","button","icon","updateBeatIndicators","previousTickIndex","tickIndex","beatIndicators","beatIndicatorsContainer","getElementById","getElementsByClassName","addCallBackInLoop","addEventListener","keyCode","is","_audioLoader","playSoundFromBuffer","_start","_stop","indicators","addTrack","addEmptyTrack","notes","waitCounter","noteEventData","pitch","velocity","duration","waitParam","Content-Type","blob","type","saveAs","populateCategories","formData","FormData","jsonPreset","buildJsonPreset","setRequestHeader","status","onPresetCancel","uploadFiles","handler","postComment","message","onPresetSave","socket","io","scope","min","max","orientation","slide","event","ui","draggable","updateSlider","isInRangeBPM","_presets","comment","splice","commentForm","$setPristine","../../audio/DrumMachine","../../audio/audio-loader","../../audio/presets","8","9","restrict","replace","templateUrl","link","elem","attrs","10","initUI","showLabel","addEvents","close","playSampleFromServer","sample","path","loadSampleOnTrack","intervalID","setInterval","clearInterval","../audio/audio-loader","11","tagHandler","invalidPresetNameMessage","invalidCategoryMessage","12","resizeTick","13","tickElem","ticksContainerWidth","width","Math","floor","handleFiles","files","file","fileExtension","getFileExtension","reader","FileReader","ev","result","readAsArrayBuffer","onDragOver","hasClass","onDrop","originalEvent","dataTransfer","onDragLeave","playSound","playLoadedSample","onSoloTrack","soloTrack","onMuteTrack","muteTrack","loadSamplesFromServer","loadSamplesElem","el","$on","unbind","14","$routeProvider","when","otherwise","redirectTo","15","test","navigator","userAgent","MSStream","c","random","toString","exec","substr","lastIndexOf"],"mappings":"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","file":"app.bundle.min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * app.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nvar _routes = require(\"./routes\");\n\nvar _drumMachineController = require(\"./components/drum-machine/drumMachineController\");\n\nvar _testController = require(\"./components/test/testController\");\n\nvar _trackDirective = require(\"./directives/trackDirective\");\n\nvar _tickSliderDirective = require(\"./directives/tickSliderDirective\");\n\nvar _commentDirective = require(\"./directives/commentDirective\");\n\nvar _savePresetDirective = require(\"./directives/savePresetDirective\");\n\nvar _loadSamples = require(\"./directives/loadSamples\");\n\n(function () {\n\n    var app = angular.module(\"myApp\", [\"ngRoute\", \"ngFileSaver\", \"ngSanitize\", \"ui.select\"]);\n\n    // configure angular routes\n    app.config([\"$routeProvider\", _routes.initRoutes]);\n\n    // bind controllers\n    app.controller(\"drumMachineController\", [\"$scope\", \"$compile\", \"$http\", \"$interval\", \"serverBaseURL\", \"FileSaver\", \"Blob\", \"socketEvents\", _drumMachineController.drumMachineController]);\n    app.controller(\"testController\", ['$scope', _testController.testController]);\n\n    // register directives\n    app.directive(\"tickSlider\", _tickSliderDirective.tickSliderDirective);\n    app.directive(\"theTrack\", [\"$http\", \"$compile\", \"supportedAudioFormats\", _trackDirective.trackDirective]);\n    app.directive(\"comment\", _commentDirective.commentDirective);\n    app.directive(\"savePreset\", _savePresetDirective.savePresetDirective);\n    app.directive(\"loadSamples\", [\"$http\", \"supportedAudioFormats\", _loadSamples.loadSamples]);\n\n    var supportedAudioFormats = new Set();\n    supportedAudioFormats.add(\"wav\");\n    supportedAudioFormats.add(\"audio/wav\");\n    supportedAudioFormats.add(\"audio/x-wav\");\n    supportedAudioFormats.add(\"mp3\");\n    supportedAudioFormats.add(\"audio/mp3\");\n    supportedAudioFormats.add(\"audio/x-mp3\");\n    supportedAudioFormats.add(\"ogg\");\n    supportedAudioFormats.add(\"audio/ogg\");\n    supportedAudioFormats.add(\"audio/x-ogg\");\n\n    var socketEvents = {\n        newPreset: \"NEW_PRESET\",\n        newComment: \"NEW_COMMENT\"\n    };\n\n    // constants\n    app.constant(\"serverBaseURL\", \"https://groovyera.herokuapp.com\");\n    app.constant(\"supportedAudioFormats\", supportedAudioFormats);\n    app.constant(\"socketEvents\", socketEvents);\n})();\n},{\"./components/drum-machine/drumMachineController\":7,\"./components/test/testController\":8,\"./directives/commentDirective\":9,\"./directives/loadSamples\":10,\"./directives/savePresetDirective\":11,\"./directives/tickSliderDirective\":12,\"./directives/trackDirective\":13,\"./routes\":14}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.DrumMachine = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * ---------------------------------------------------------------------------------------\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * DrumMachine.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * ---------------------------------------------------------------------------------------\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _audioLoader = require(\"./audio-loader\");\n\nvar _utils = require(\"../utils/utils\");\n\nvar _Track = require(\"./Track\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DrumMachine = exports.DrumMachine = function () {\n    function DrumMachine() {\n        _classCallCheck(this, DrumMachine);\n\n        this.tag = \"[DrumMachine.js]\";\n        this.numberOfBeats = 16;\n        var AudioContext = window.AudioContext || window.webkitAudioContext;\n        this.audioContext = new AudioContext();\n        this.pannerNodeSupported = false;\n        this.bpm = 120;\n        this.bpmMin = 30;\n        this.bpmMax = 240;\n        this.timeSignature = {\n            num: 4,\n            den: 4\n        };\n        this.tickTime = 60.0 / this.bpm / 4.0; // 1/16 note\n        this.isPlaying = false;\n        this.isStopped = true;\n        this.buffers = {};\n        this.tracks = {};\n\n        // this.defaultBuffersLoaded = false;\n        // this.defaultTracksLoaded = false;\n\n        this._tracksInSolo = new Set();\n        this._tracksInMute = new Set();\n\n        this.currentTickIndex = 0;\n\n        this.callBacksInLoop = [];\n\n        this.soundURLs = {\n            kick: \"app/assets/audio/kick.wav\",\n            snare: \"app/assets/audio/snare.wav\",\n            hat: \"app/assets/audio/hat.wav\",\n            ride: \"app/assets/audio/ride.wav\"\n        };\n\n        if ((0, _utils.checkIfiOSdevice)()) {\n            this._enableAudioContextForiOS();\n        } else {\n            this.audioContextEnabled = true;\n        }\n\n        if (typeof this.audioContext.createStereoPanner === \"function\") {\n            this.pannerNodeSupported = true;\n            console.log(\"Stereo panner supported\");\n        } else {\n            console.log(\"Stereo panner not supported\");\n        }\n    }\n\n    /*\n     * get bpm\n     */\n\n\n    _createClass(DrumMachine, [{\n        key: \"_enableAudioContextForiOS\",\n        value: function _enableAudioContextForiOS() {\n            var _this = this;\n\n            $(document).ready(function () {\n                var btn = $(\"<button/>\", {\n                    visibility: \"hidden\"\n                });\n\n                btn.on(\"touchstart\", function () {\n                    var buffer = _this.audioContext.createBuffer(1, 1, 22050);\n                    var source = _this.audioContext.createBufferSource();\n                    source.buffer = buffer;\n                    source.start();\n\n                    _this.audioContextEnabled = true;\n                    console.log(\"AudioContext enabled for iOS\");\n                });\n\n                btn.trigger(\"touchstart\");\n            });\n        }\n\n        /*\n        _loadDefaultBuffers() {\n             let ctx = this.audioContext;\n            let urls = this.soundURLs;\n             return new Promise((resolve, reject) => {\n                Promise.all([\n                    audioLoader(ctx, urls.kick),\n                    audioLoader(ctx, urls.snare),\n                    audioLoader(ctx, urls.hat),\n                    audioLoader(ctx, urls.ride)\n                ]).then(values => {\n                    this.buffers[\"kick\"] = values[0];\n                    this.buffers[\"snare\"] = values[1];\n                    this.buffers[\"hat\"] = values[2];\n                    this.buffers[\"ride\"] = values[3];\n                    this.defaultBuffersLoaded = true;\n                    console.log(this.buffers);\n                     this.defaultBuffersLoaded = true;\n                    console.log(\"Default buffers loaded\");\n                    // this._initDefaultTracks();\n                     resolve(\"Default buffers loaded\");\n                 }, error => {\n                    reject(error);\n                });\n            });\n        }\n          _initDefaultTracks() {\n             if (!this.defaultBuffersLoaded) {\n                return;\n            }\n             this.tracks = {};\n             let kickTrack = new Track(this, \"kick\", this.buffers[\"kick\"]);\n            kickTrack.setTicksFromArray([0,4,8,12]);\n            let snareTrack = new Track(this, \"snare\", this.buffers[\"snare\"], 1, 0.1);\n            snareTrack.setTicksFromArray([4,12]);\n            let hatTrack = new Track(this, \"hat\", this.buffers[\"hat\"], 0.85, -1);\n            // hatTrack.setTicksFromArray([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]);\n              hatTrack.setTicksFromArray([\n                {\n                    active: true,\n                    index: 0,\n                    volume: 0.5\n                },\n                {\n                    active: true,\n                    index: 1,\n                    volume: 0.5\n                },\n                {\n                    active: true,\n                    index: 2,\n                    volume: 1.2\n                },\n                {\n                    active: true,\n                    index: 3,\n                    volume: 0.4\n                },\n                {\n                    active: true,\n                    index: 4,\n                    volume: 0.9\n                },\n                {\n                    active: true,\n                    index: 5,\n                    volume: 0.5\n                },\n                {\n                    active: true,\n                    index: 6,\n                    volume: 1\n                },\n                {\n                    active: true,\n                    index: 7,\n                    volume: 0.4\n                },\n                {\n                    active: true,\n                    index: 8,\n                    volume: 0.9\n                },\n                {\n                    active: true,\n                    index: 9,\n                    volume: 0.5\n                },\n                {\n                    active: true,\n                    index: 10,\n                    volume: 1\n                },\n                {\n                    active: true,\n                    index: 11,\n                    volume: 0.4\n                },\n                {\n                    active: true,\n                    index: 12,\n                    volume: 0.9\n                },\n                {\n                    active: true,\n                    index: 13,\n                    volume: 0.5\n                },\n                {\n                    active: true,\n                    index: 14,\n                    volume: 1\n                },\n                {\n                    active: true,\n                    index: 15,\n                    volume: 0.4\n                }\n            ]);\n             this.tracks[kickTrack.id] = kickTrack;\n            this.tracks[snareTrack.id] = snareTrack;\n            this.tracks[hatTrack.id] = hatTrack;\n             this.defaultTracksLoaded = true;\n            console.log(\"Default tracks loaded\" , this.tracks);\n             // this._start();\n        }\n        */\n\n    }, {\n        key: \"_onBpmChanged\",\n        value: function _onBpmChanged() {\n            this.tickTime = 60.0 / this.bpm / 4.0; // 1/16 note\n        }\n    }, {\n        key: \"_start\",\n        value: function _start() {\n\n            if (!this.audioContextEnabled) {\n                console.log(\"Cannot play: AudioContext is not enabled.\");\n                return;\n            }\n\n            if (this.isPlaying) {\n                console.log(\"Cannot play: it is already playing.\");\n                return;\n            }\n\n            this.isStopped = false;\n            var self = this;\n            var ctx = this.audioContext;\n            var startTime = ctx.currentTime;\n            var nextTickTime = startTime + self.tickTime;\n            var index = 0;\n            var timeOutID = void 0;\n            var firstLoopEnded = false;\n\n            function scheduler() {\n\n                if (self.isStopped) {\n                    clearTimeout(timeOutID);\n                    self.isPlaying = false;\n                    return;\n                }\n\n                if (nextTickTime <= ctx.currentTime + self.tickTime) {\n\n                    self.isPlaying = true;\n                    self.isStopped = false;\n\n                    $.each(self.tracks, function (id, track) {\n\n                        if (track.mute) {\n                            return;\n                        }\n\n                        if (!track.sampleData.decodedAudioBuffer) {\n                            return;\n                        }\n\n                        var trackTick = track.ticks[index];\n\n                        if (!trackTick.active) {\n                            return;\n                        }\n\n                        var tickSound = ctx.createBufferSource();\n                        tickSound.buffer = track.sampleData.decodedAudioBuffer;\n                        var tickGainNode = ctx.createGain();\n                        tickSound.connect(tickGainNode);\n                        tickGainNode.gain.value = trackTick.volume;\n                        tickGainNode.connect(track.gainNode);\n                        tickSound.start(nextTickTime);\n                    });\n\n                    self.currentTickIndex = index;\n                    var previousIndex = index === 0 ? self.numberOfBeats - 1 : index - 1;\n                    var previousPrevious = previousIndex === 0 ? self.numberOfBeats - 1 : previousIndex - 1;\n\n                    // to syncronize web audio api schedule with ui beat indicators\n                    if (firstLoopEnded) {\n                        self.callBacksInLoop.forEach(function (fn) {\n                            fn(previousPrevious, previousIndex);\n                        });\n                    }\n\n                    nextTickTime += self.tickTime;\n                    index = ++index === self.numberOfBeats ? 0 : index;\n                }\n\n                firstLoopEnded = true;\n                timeOutID = window.setTimeout(scheduler, 0);\n            }\n\n            scheduler();\n        }\n    }, {\n        key: \"_stop\",\n        value: function _stop() {\n            this.isStopped = true;\n        }\n    }, {\n        key: \"_playSound\",\n        value: function _playSound(bufferName, time) {\n            var ctx = this.audioContext;\n            var sound = ctx.createBufferSource();\n            sound.buffer = this.buffers[bufferName];\n            sound.connect(ctx.destination);\n            sound.start(time);\n        }\n    }, {\n        key: \"playSoundFromBuffer\",\n        value: function playSoundFromBuffer(buffer, time) {\n            if (!buffer) return;\n            var ctx = this.audioContext;\n\n            var sound = ctx.createBufferSource();\n            sound.buffer = buffer;\n            sound.connect(ctx.destination);\n            if (time) {\n                sound.start(time);\n            } else {\n                sound.start();\n            }\n        }\n    }, {\n        key: \"removeTrack\",\n        value: function removeTrack(trackID) {\n            var track = this.tracks[trackID];\n            this._tracksInSolo.delete(track);\n            this._tracksInMute.delete(track);\n            delete this.tracks[trackID];\n        }\n    }, {\n        key: \"soloTrack\",\n        value: function soloTrack(trackID) {\n\n            if (!this.tracks.hasOwnProperty(trackID)) return;\n\n            var focusTrack = this.tracks[trackID];\n            var tracksInSolo = this._tracksInSolo;\n            var tracksInMute = this._tracksInMute;\n\n            // case 1: track is not in solo and not in mute\n            if (!tracksInSolo.has(focusTrack) && !tracksInMute.has(focusTrack)) {\n                tracksInSolo.add(focusTrack);\n                focusTrack.solo = true;\n                focusTrack.mute = false;\n\n                $.each(this.tracks, function (id, track) {\n                    if (id === trackID) {\n                        return;\n                    }\n\n                    if (!tracksInSolo.has(track)) {\n                        tracksInMute.add(track);\n                        track.mute = true;\n                        track.solo = false;\n                    }\n                });\n            }\n\n            // case 2: track is in solo\n            else if (tracksInSolo.has(focusTrack)) {\n                    tracksInSolo.delete(focusTrack);\n                    focusTrack.solo = false;\n\n                    if (tracksInSolo.size > 0) {\n                        tracksInMute.add(focusTrack);\n                        focusTrack.mute = true;\n                    } else {\n                        tracksInMute.clear();\n                        tracksInSolo.clear();\n                        $.each(this.tracks, function (id, track) {\n                            track.mute = false;\n                            track.solo = false;\n                        });\n                    }\n                }\n\n                // case 3: track is in mute\n                else {\n\n                        tracksInSolo.add(focusTrack);\n                        focusTrack.solo = true;\n                        focusTrack.mute = false;\n\n                        if (tracksInSolo.size === 1) {\n                            $.each(this.tracks, function (id, track) {\n                                if (id !== trackID) {\n                                    tracksInMute.add(track);\n                                    track.mute = true;\n                                }\n                            });\n                        }\n                    }\n        }\n    }, {\n        key: \"muteTrack\",\n        value: function muteTrack(trackID) {\n\n            if (!this.tracks.hasOwnProperty(trackID)) return;\n\n            var focusTrack = this.tracks[trackID];\n            var tracksInSolo = this._tracksInSolo;\n            var tracksInMute = this._tracksInMute;\n\n            // case 1: track not in solo or mute\n            if (!tracksInSolo.has(focusTrack) && !tracksInMute.has(focusTrack)) {\n                tracksInMute.add(focusTrack);\n                focusTrack.mute = true;\n                focusTrack.solo = false;\n            }\n\n            // case 2: track is in solo\n            else if (tracksInSolo.has(focusTrack)) {\n                    tracksInSolo.delete(focusTrack);\n                    tracksInMute.add(focusTrack);\n                    focusTrack.solo = false;\n                    focusTrack.mute = true;\n\n                    if (tracksInSolo.size === 0) {\n                        $.each(this.tracks, function (id, track) {\n                            if (id !== trackID) {\n                                tracksInMute.delete(track);\n                                track.mute = false;\n                            }\n                        });\n                    }\n                }\n\n                // case 3: track is in mute\n                else if (tracksInMute.has(focusTrack)) {\n                        if (tracksInSolo.size > 0) {\n                            tracksInMute.delete(focusTrack);\n                            tracksInSolo.add(focusTrack);\n                            focusTrack.mute = false;\n                            focusTrack.solo = true;\n                        } else {\n                            tracksInMute.delete(focusTrack);\n                            focusTrack.mute = false;\n                        }\n                    }\n        }\n    }, {\n        key: \"addCallBackInLoop\",\n        value: function addCallBackInLoop(fn) {\n            if (!(typeof fn === \"undefined\" ? \"undefined\" : _typeof(fn)) === \"function\") return;\n            this.callBacksInLoop.push(fn);\n        }\n    }, {\n        key: \"isInRangeBPM\",\n        value: function isInRangeBPM(value) {\n            if (value >= this.bpmMin && value <= this.bpmMax) {\n                return true;\n            } else {\n                return false;\n            }\n        }\n    }, {\n        key: \"_createEmptyTicksArray\",\n        value: function _createEmptyTicksArray() {\n            var ticks = [];\n            for (var i = 0; i < this.numberOfBeats; i++) {\n\n                ticks.push({\n                    index: i,\n                    volume: 0,\n                    active: false\n                });\n            }\n            return ticks;\n        }\n    }, {\n        key: \"_clearTracks\",\n        value: function _clearTracks() {\n            this._tracksInSolo.clear();\n            this._tracksInMute.clear();\n\n            for (var key in this.tracks) {\n                if (this.tracks.hasOwnProperty(key)) {\n                    delete this.tracks[key];\n                }\n            }\n        }\n    }, {\n        key: \"addEmptyTrack\",\n        value: function addEmptyTrack() {\n            var name = \"track_\" + (Object.keys(this.tracks).length + 1);\n            var track = new _Track.Track(this, name);\n            track.setTicksFromArray(this._createEmptyTicksArray());\n            this.tracks[track.id] = track;\n        }\n    }, {\n        key: \"createTrack\",\n        value: function createTrack(name, soundPath, volume, pan, ticks) {\n            var _this2 = this;\n\n            return new Promise(function (resolve, reject) {\n\n                var track = new _Track.Track(_this2, name, soundPath);\n\n                if (ticks) {\n                    track.setTicksFromArray(ticks);\n                } else {\n                    track.setTicksFromArray(_this2._createEmptyTicksArray());\n                }\n\n                if (volume) {\n                    track.gainNode.gain.value = volume;\n                }\n\n                if (pan) {\n                    if (track.pannerNode) {\n                        track.pannerNode.pan.value = pan;\n                    }\n                }\n\n                resolve(track);\n            });\n        }\n    }, {\n        key: \"loadPreset\",\n        value: function loadPreset(data) {\n            var _this3 = this;\n\n            try {\n                this.bpm = data.bpm;\n                this._clearTracks();\n\n                var promises = [];\n\n                data.tracks.forEach(function (track) {\n                    promises.push(_this3.createTrack(track.name, track.soundPath, track.volume, track.pan, track.ticks));\n                });\n\n                return Promise.all(promises);\n            } catch (e) {\n                return new Promise(function (resolve, reject) {\n                    reject(e);\n                });\n            }\n        }\n    }, {\n        key: \"buildJsonPreset\",\n        value: function buildJsonPreset(name, category) {\n            var _this4 = this;\n\n            var data = {\n                name: name,\n                category: category,\n                bpm: this.bpm,\n                timeSignature: this.timeSignature\n            };\n\n            var tracks = [];\n\n            for (var id in this.tracks) {\n                if (this.tracks.hasOwnProperty(id)) {\n                    (function () {\n\n                        var track = _this4.tracks[id];\n\n                        var trackData = {\n                            name: track.name,\n                            soundPath: category + \"/\" + track.sampleData.fileName,\n                            volume: track.gainNode.gain.value,\n                            pan: _this4.pannerNodeSupported ? track.pannerNode.pan.value : 0\n                        };\n\n                        var ticksData = [];\n\n                        track.ticks.forEach(function (tick) {\n                            ticksData.push({\n                                active: tick.active,\n                                index: tick.index,\n                                volume: tick.volume\n                            });\n                        });\n\n                        trackData.ticks = ticksData;\n\n                        tracks.push(trackData);\n                    })();\n                }\n            }\n\n            data.tracks = tracks;\n            return JSON.stringify(data);\n        }\n    }, {\n        key: \"bpm\",\n        get: function get() {\n            return this._bpm;\n        }\n\n        /*\n         * set bpm\n         */\n        ,\n        set: function set(val) {\n            if (val !== this._bpm) {\n                this._bpm = val;\n                this._onBpmChanged();\n            }\n        }\n    }]);\n\n    return DrumMachine;\n}();\n},{\"../utils/utils\":15,\"./Track\":4,\"./audio-loader\":5}],3:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * Tick.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Tick = exports.Tick = function Tick() {\n    var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var active = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var volume = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1.0;\n\n    _classCallCheck(this, Tick);\n\n    this.index = index;\n    this.active = active;\n    this.volume = volume;\n}\n\n// get volume() {\n//     return this._volume;\n// }\n//\n// set volume(val) {\n//     this._volume = val > 1 ? 1.0 : val;\n// }\n\n;\n},{}],4:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * Track.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Track = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Tick = require(\"./Tick\");\n\nvar _utils = require(\"../utils/utils\");\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Track = exports.Track = function () {\n    function Track(drumMachine) {\n        var name = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"track_default\";\n        var soundPath = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : undefined;\n        var volume = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1.0;\n\n        var _this = this;\n\n        var pan = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n        var mute = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : false;\n\n        _classCallCheck(this, Track);\n\n        this.id = (0, _utils.guid)();\n        this.drumMachine = drumMachine;\n        this.audioContext = drumMachine.audioContext;\n        this.name = name;\n\n        this.sampleData = {\n            fileName: \"\",\n            extension: \"\",\n            originalBuffer: undefined,\n            decodedAudioBuffer: undefined\n        };\n\n        this.solo = false;\n        this.mute = mute;\n        this.ticks = [];\n        this.pannerNodeSupported = false;\n        this.gainNode = this.audioContext.createGain();\n        this.gainNode.gain.value = volume;\n\n        if (drumMachine.pannerNodeSupported) {\n            this.pannerNode = this.audioContext.createStereoPanner();\n            this.pannerNode.pan.value = pan;\n            this.gainNode.connect(this.pannerNode);\n            this.pannerNode.connect(this.audioContext.destination);\n            this.pannerNodeSupported = true;\n        } else {\n            this.gainNode.connect(this.audioContext.destination);\n        }\n\n        if (soundPath) {\n            (0, _utils.getArrayAudioBufferFromUrl)(this.audioContext, soundPath).then(function (buffer) {\n                var fileName = (0, _utils.getFileNameFromPath)(soundPath);\n                _this.setSampleData(fileName, buffer);\n            });\n        }\n\n        this._initTicks();\n    }\n\n    // setGain(val) {\n    //     this.gainNode.gain.value = val > 1 ? 1.0 : val;\n    // }\n\n\n    // setPan(val) {\n    //     if (val < -1) {\n    //         this.pannerNode.pan.value = -1;\n    //     }\n    //     else if (val > 1) {\n    //         this.pannerNode.pan.value = 1;\n    //     }\n    //     else {\n    //         this.pannerNode.pan.value = val;\n    //     }\n    // }\n\n\n    /*\n     *\n     */\n\n\n    _createClass(Track, [{\n        key: \"_initTicks\",\n        value: function _initTicks() {\n            this.ticks = [];\n            for (var i = 0; i < this.drumMachine.numberOfBeats; ++i) {\n                this.ticks.push(new _Tick.Tick(i));\n            }\n        }\n    }, {\n        key: \"setTick\",\n        value: function setTick(index) {\n            var active = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n            var volume = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1.0;\n\n            if (index < 0 || index > this.drumMachine.numberOfBeats - 1) {\n                return;\n            }\n\n            this.ticks[index].volume = volume;\n            this.ticks[index].active = active;\n        }\n    }, {\n        key: \"setTicksFromArray\",\n        value: function setTicksFromArray(data) {\n            var _this2 = this;\n\n            data.forEach(function (e) {\n                if ((typeof e === \"undefined\" ? \"undefined\" : _typeof(e)) === \"object\") {\n                    if (e.index === \"undefined\" || e.index < 0 || e.index > _this2.drumMachine.numberOfBeats - 1) {\n                        return;\n                    }\n\n                    _this2.ticks[e.index].volume = e.volume !== \"undefined\" ? e.volume : 0;\n                    _this2.ticks[e.index].active = e.active !== \"undefined\" ? e.active : false;\n                } else {\n                    _this2.ticks[e].active = true;\n                }\n            });\n        }\n    }, {\n        key: \"setBuffer\",\n        value: function setBuffer(arrayBuffer, fileName) {\n            var _this3 = this;\n\n            this.originalBuffer = arrayBuffer;\n            this.drumMachine.audioContext.decodeAudioData(arrayBuffer, function (decodedAudioBuffer) {\n                _this3.buffer = decodedAudioBuffer;\n                console.log(\"Track \" + _this3.name + \": audio buffer changed ( \" + fileName + \" )\");\n            });\n        }\n    }, {\n        key: \"playLoadedSample\",\n        value: function playLoadedSample() {\n            if (!this.audioContext || !this.sampleData.decodedAudioBuffer) return;\n            var sound = this.audioContext.createBufferSource();\n            sound.buffer = this.sampleData.decodedAudioBuffer;\n            sound.connect(this.audioContext.destination);\n            sound.start();\n        }\n    }, {\n        key: \"setSampleData\",\n        value: function setSampleData(fileName, arrayAudioBuffer) {\n            var _this4 = this;\n\n            if (!fileName || !arrayAudioBuffer) {\n                console.log(\"Missing fileName and/or arrayAudioBuffer parameters\");\n                return;\n            }\n\n            this.drumMachine.audioContext.decodeAudioData(arrayAudioBuffer, function (decodedBuffer) {\n                _this4.sampleData.fileName = fileName;\n                _this4.sampleData.extension = (0, _utils.getExtensionFromFileName)(fileName);\n                _this4.sampleData.originalBuffer = arrayAudioBuffer;\n                _this4.sampleData.decodedAudioBuffer = decodedBuffer;\n            });\n        }\n    }]);\n\n    return Track;\n}();\n},{\"../utils/utils\":15,\"./Tick\":3}],5:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * audio-loader.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.audioLoader = audioLoader;\nexports.getArrayBuffer = getArrayBuffer;\nfunction audioLoader(audioCtx, url) {\n\n    return new Promise(function (resolve, reject) {\n\n        if (!audioCtx) {\n            reject(\"Missing audio context parameter.\");\n            return;\n        }\n\n        if (!url) {\n            reject(\"Missing url parameter\");\n            return;\n        }\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"GET\", url);\n        xhr.responseType = \"arraybuffer\";\n\n        xhr.onload = function () {\n            try {\n                audioCtx.decodeAudioData(xhr.response, function (decodedBuffer) {\n                    resolve(decodedBuffer);\n                });\n            } catch (e) {\n                reject(e);\n            }\n        };\n\n        xhr.send();\n    });\n}\n\nfunction getArrayBuffer(audioCtx, url) {\n\n    return new Promise(function (resolve, reject) {\n\n        if (!audioCtx) {\n            reject(\"Missing audio context parameter.\");\n            return;\n        }\n\n        if (!url) {\n            reject(\"Missing url parameter\");\n            return;\n        }\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"GET\", url);\n        xhr.responseType = \"arraybuffer\";\n\n        xhr.onload = function () {\n            resolve(xhr.response);\n        };\n\n        xhr.send();\n    });\n}\n},{}],6:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * ---------------------------------------------------------------------------------------\n * presets.js\n * ---------------------------------------------------------------------------------------\n */\n\nvar groovyRockPreset = exports.groovyRockPreset = {\n    name: \"Straight rock\",\n    bpm: 120,\n    category: \"rock\",\n    timeSignature: {\n        num: 4,\n        den: 4\n    },\n    tracks: [{\n        name: \"kick\",\n        soundPath: \"app/assets/samples/rock/rock-kick.wav\",\n        volume: 1,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 0,\n            volume: 1\n        }, {\n            active: true,\n            index: 8,\n            volume: 1\n        }, {\n            active: true,\n            index: 10,\n            volume: 1\n        }]\n    }, {\n        name: \"snare\",\n        soundPath: \"app/assets/samples/rock/rock-snare.wav\",\n        volume: 1,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 4,\n            volume: 1\n        }, {\n            active: true,\n            index: 12,\n            volume: 1\n        }]\n    }, {\n        name: \"hh open\",\n        soundPath: \"app/assets/samples/rock/rock-hh-open.wav\",\n        volume: 0.4,\n        pan: 0.4,\n        ticks: [{\n            active: true,\n            index: 4,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 8,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 12,\n            volume: 0.8\n        }]\n    }, {\n        name: \"crash\",\n        soundPath: \"app/assets/samples/rock/rock-crash.wav\",\n        volume: 0.5,\n        pan: -0.5,\n        ticks: [{\n            active: true,\n            index: 0,\n            volume: 0.8\n        }]\n    }]\n};\n\nvar psyTrancePreset = exports.psyTrancePreset = {\n    name: \"psy-trance\",\n    category: \"trance\",\n    bpm: 145,\n    timeSignature: {\n        num: 4,\n        den: 4\n    },\n    tracks: [{\n        name: \"kick\",\n        soundPath: \"app/assets/samples/trance/trance-kick.wav\",\n        volume: 1,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 0,\n            volume: 1\n        }, {\n            active: true,\n            index: 4,\n            volume: 1\n        }, {\n            active: true,\n            index: 8,\n            volume: 1\n        }, {\n            active: true,\n            index: 12,\n            volume: 1\n        }]\n    }, {\n        name: \"clap\",\n        soundPath: \"app/assets/samples/trance/trance-clap.wav\",\n        volume: 1,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 4,\n            volume: 1\n        }, {\n            active: true,\n            index: 12,\n            volume: 1\n        }]\n    }, {\n        name: \"hh open\",\n        soundPath: \"app/assets/samples/trance/trance-hh-open.wav\",\n        volume: 0.8,\n        pan: 0.2,\n        ticks: [{\n            active: true,\n            index: 2,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 6,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 10,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 14,\n            volume: 0.8\n        }]\n    }, {\n        name: \"bass\",\n        soundPath: \"app/assets/samples/trance/trance-bass-A1.wav\",\n        volume: 0.8,\n        pan: 0,\n        ticks: [{\n            active: true,\n            index: 1,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 2,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 3,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 5,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 6,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 7,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 9,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 10,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 11,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 13,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 14,\n            volume: 0.8\n        }, {\n            active: true,\n            index: 15,\n            volume: 0.8\n        }]\n    }]\n};\n},{}],7:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.drumMachineController = drumMachineController;\n\nvar _DrumMachine = require(\"../../audio/DrumMachine\");\n\nvar _audioLoader = require(\"../../audio/audio-loader\");\n\nvar _presets = require(\"../../audio/presets\");\n\n/**\n * ---------------------------------------------------------------------------------------\n * mainController.js\n * ---------------------------------------------------------------------------------------\n */\n\nfunction drumMachineController($scope, $compile, $http, $interval, serverBaseURL, FileSaver, Blob, socketEvents) {\n\n    var drumMachine = new _DrumMachine.DrumMachine();\n    var loadingContainer = $(\"#loadingContainer\");\n    var commentsLoadingOverlay = $(\"#commentsLoadingOverlay\");\n    var commentsLoadingSpinner = $(\"#commentsLoadingSpinner\");\n    var playBtn = $(\"#sequencerPlayButton\");\n    var stopBtn = $(\"#sequencerStopButton\");\n    var bpmSlider = $(\"#sequencerBPMslider\");\n\n    $scope.safeApply = function (fn) {\n        var phase = this.$root.$$phase;\n        if (phase == '$apply' || phase == '$digest') {\n            if (fn && typeof fn === 'function') {\n                fn();\n            }\n        } else {\n            this.$apply(fn);\n        }\n    };\n\n    $scope.title = \"Main Controller\";\n    $scope.tracks = [];\n    $scope.ticksElements = [];\n    $scope.audioContext = drumMachine.audioContext;\n    $scope.bpm = drumMachine.bpm;\n    $scope.isPlaying = drumMachine.isPlaying;\n    $scope.isStopped = drumMachine.isStopped;\n    $scope.removeTrack = removeTrack;\n    $scope.integerval = /^\\d*$/;\n    $scope.beats = new Array(drumMachine.numberOfBeats).fill(false);\n    $scope.samplesData = {};\n    $scope.samplesBuffers = {};\n    $scope.username = \"\";\n    $scope.commentToPost = \"\";\n    $scope.comments = [];\n    $scope.invalidUsernameMessage = \"Give ya a name! (3-32 characters)\";\n    $scope.invalidCommentMessage = \"Write something cool! (3-1000 characters)\";\n\n    $scope.preset = {\n        name: \"\",\n        categorySelected: undefined,\n        categories: []\n    };\n\n    $scope.tracks = drumMachine.tracks;\n    $scope.safeApply();\n\n    /*\n     * ---------------------------------------------------------------------------------------\n     * UI\n     * ---------------------------------------------------------------------------------------\n     */\n\n    $(\"#accordion\").accordion({\n        animate: 200,\n        collapsible: true,\n        active: false,\n        heightStyle: \"content\",\n        // icons: { \"header\": \"ui-icon-plus\", \"activeHeader\": \"ui-icon-minus\" },\n        beforeActivate: function beforeActivate() {\n            if ($scope.comments.length === 0) {\n                loadComments();\n            }\n        }\n    });\n\n    $(\"#postCommentBtn\").button({\n        icon: \"ui-icon-pencil\"\n    });\n\n    /*\n     * ---------------------------------------------------------------------------------------\n     * event listeners\n     * ---------------------------------------------------------------------------------------\n     */\n\n    $(window).ready(function () {\n\n        var beatIndicatorsContainer = document.getElementById(\"beatIndicators\");\n        var beatIndicators = beatIndicatorsContainer.getElementsByClassName(\"beat-indicator\");\n\n        function updateBeatIndicators(previousTickIndex, tickIndex) {\n            $(beatIndicators[previousTickIndex]).removeClass(\"beat-indicator-active\");\n            $(beatIndicators[tickIndex]).addClass(\"beat-indicator-active\");\n        }\n\n        drumMachine.addCallBackInLoop(updateBeatIndicators);\n    });\n\n    window.addEventListener(\"keyup\", function (e) {\n        switch (e.keyCode) {\n\n            //space\n            case 32:\n\n                if ($('textarea#commentArea, input#usernameInput, input[name=\"trackName\"], input[name=\"presetName\"]').is(\":focus\")) {\n                    e.stopPropagation();\n                } else if ($scope.isStopped) {\n                    play(e);\n                } else {\n                    stop(e);\n                }\n                break;\n\n            default:\n                break;\n        }\n    });\n\n    window.addEventListener(\"keydown\", function (e) {\n        switch (e.keyCode) {\n\n            //space\n            case 32:\n\n                if ($('textarea#commentArea, input#usernameInput, input[name=\"trackName\"], input[name=\"presetName\"]').is(\":focus\")) {\n                    e.stopPropagation();\n                } else {\n                    e.preventDefault();\n                    e.stopPropagation();\n                }\n\n                break;\n\n            default:\n                break;\n        }\n    });\n\n    // remove scroll down on spacebar\n    window.addEventListener('keydown', function (e) {\n        if (e.keyCode === 32 && e.target === document.body) {\n            e.preventDefault();\n        }\n    });\n\n    /*\n     * ---------------------------------------------------------------------------------------\n     * public\n     * ---------------------------------------------------------------------------------------\n     */\n\n    $scope.enableLoadingSpinner = enableLoadingSpinner;\n    $scope.disableLoadingSpinner = disableLoadingSpinner;\n\n    $scope.audioLoader = _audioLoader.audioLoader;\n    $scope.playSoundFromBuffer = drumMachine.playSoundFromBuffer;\n\n    $scope.startSequencer = function () {\n        drumMachine._start();\n        $scope.isPlaying = true;\n        $scope.isStopped = false;\n    };\n\n    $scope.stopSequencer = function () {\n        drumMachine._stop();\n        $scope.isPlaying = false;\n        $scope.isStopped = true;\n        var indicators = document.getElementById(\"beatIndicators\").getElementsByClassName(\"beat-indicator\");\n        $(indicators).removeClass(\"beat-indicator-active\");\n    };\n\n    $scope.addTrack = function () {\n        drumMachine.addEmptyTrack();\n    };\n\n    $scope.exportMidi = function () {\n\n        var tracks = [];\n        for (var key in drumMachine.tracks) {\n            if (drumMachine.tracks.hasOwnProperty(key)) {\n                (function () {\n\n                    var track = drumMachine.tracks[key];\n                    var trackData = {\n                        name: track.name,\n                        notes: []\n                    };\n\n                    var waitCounter = 0;\n                    track.ticks.forEach(function (tick) {\n\n                        if (tick.active) {\n                            var noteEventData = {\n                                pitch: [\"C4\"],\n                                velocity: tick.volume,\n                                duration: \"16\" // 1/16\n                            };\n\n                            if (waitCounter > 0) {\n                                var waitParam = \"T\" + waitCounter * 32; //number of ticks to wait (each tick is 1/128)\n                                noteEventData[\"wait\"] = waitParam;\n                            }\n\n                            trackData.notes.push(noteEventData);\n                            waitCounter = 0;\n                        } else {\n                            waitCounter += 1;\n                        }\n                    });\n\n                    tracks.push(trackData);\n                })();\n            }\n        }\n\n        var data = {\n            bpm: drumMachine.bpm,\n            timeSignature: { num: 4, den: 4 },\n            tracks: tracks\n        };\n\n        $http({\n            url: serverBaseURL + '/api/midi',\n            method: \"POST\",\n            responseType: \"arraybuffer\",\n            headers: {\n                \"Content-Type\": \"application/json\"\n            },\n            data: JSON.stringify(data)\n\n        }).then(function (response) {\n            console.log(response);\n            var blob = new Blob([response.data], { type: 'audio/midi' });\n            // let fileName = response.headers('content-disposition');\n            FileSaver.saveAs(blob, \"loop.mid\");\n        }, function (response) {\n            console.log(response);\n        });\n    };\n\n    $scope.populateCategories = function () {\n        return new Promise(function (resolve, reject) {\n            $http({\n                url: serverBaseURL + \"/api/categories\",\n                method: \"GET\",\n                headers: {\n                    \"Accept\": \"application/json\"\n                }\n            }).then(function (response) {\n                // console.log(response);\n                var categories = response.data;\n                // categories.forEach(c => {\n                //     $scope.categories.push(c.name);\n                // });\n                $scope.preset.categories = categories;\n                resolve(categories);\n            }, function (error) {\n                console.log(error);\n                reject(error);\n            });\n        });\n    };\n\n    /*\n    $scope.loadPreset = () => {\n         $http({\n            url: serverBaseURL + \"/api/presets\",\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n        }).then(response => {\n             let presets = response.data;\n            if (presets.length === 0) {\n                return;\n            }\n             drumMachine.loadPreset(presets[0]).then(tracks => {\n                 tracks.forEach(t => {\n                    drumMachine.tracks[t.id] = t;\n                });\n                 $scope.bpm = drumMachine.bpm;\n                bpmSlider.slider(\"value\", $scope.bpm);\n                $scope.$apply();\n              }, error => {\n                console.log(error);\n            });\n         }, errorResponse => {\n            console.log(errorResponse);\n        });\n     };\n    */\n\n    $scope.savePreset = function () {\n\n        var formData = new FormData();\n        var jsonPreset = drumMachine.buildJsonPreset($scope.preset.name, $scope.preset.categorySelected.name);\n\n        for (var id in drumMachine.tracks) {\n\n            if (drumMachine.tracks.hasOwnProperty(id)) {\n                var track = drumMachine.tracks[id];\n\n                var blob = new Blob([track.sampleData.originalBuffer], {\n                    // type: track.sampleData.extension ? \"audio/\" + track.sampleData.extension : \"octet-stream\"\n                    type: \"octet-stream\"\n                });\n\n                formData.append(\"sample\", blob, track.sampleData.fileName);\n            }\n        }\n\n        formData.append(\"preset\", jsonPreset);\n\n        var xhr = new XMLHttpRequest();\n\n        xhr.open('POST', serverBaseURL + '/api/presets', true);\n        xhr.setRequestHeader(\"Accept\", \"application/json\");\n        xhr.onload = function () {\n            // created\n            if (xhr.status === 201) {\n                toastOk(\"Preset saved! ;-)\");\n                $scope.onPresetCancel();\n            } else if (xhr.status === 409) {\n                console.log(xhr.response);\n                toastError(\"Preset name \" + $scope.preset.name + \" already taken for category \" + $scope.preset.categorySelected.name);\n            } else {\n                toastError(\"Ops! Something went wrong :-(\");\n                $scope.onPresetCancel();\n            }\n        };\n        xhr.send(formData);\n    };\n\n    $scope.uploadFiles = function () {\n\n        var formData = new FormData();\n\n        // $('input[type=\"file\"]').each(function(index) {\n        //\n        //     let fileList = $(this)[0].files;\n        //\n        //     for(let i = 0; i < fileList.length; i++) {\n        //         let file = fileList[i];\n        //         formData.append(file.name, file);\n        //     }\n        // });\n\n\n        // drumMachine.tracks.forEach(track => {\n        //\n        //     console.log(track);\n        //     let buffer = track.buffer;\n        //     let blob = new Blob(buffer);\n        //     formData.append(track.name, blob, \"campione.wav\");\n        //\n        // });\n\n        for (var id in drumMachine.tracks) {\n            if (drumMachine.tracks.hasOwnProperty(id)) {\n                var track = drumMachine.tracks[id];\n\n                var blob = new Blob([track.sampleData.originalBuffer], {\n                    // type: track.sampleData.extension ? \"audio/\" + track.sampleData.extension : \"octet-stream\"\n                    type: \"octet-stream\"\n                });\n\n                formData.append(\"sample\", blob, track.sampleData.fileName);\n            }\n        }\n\n        var obj = {\n            name: \"track\",\n            bpm: 120,\n            tracks: [{\n                name: \"kick\"\n            }, {\n                name: \"snare\"\n            }]\n        };\n\n        formData.append(\"preset\", JSON.stringify(obj));\n\n        var xhr = new XMLHttpRequest();\n\n        xhr.open('POST', serverBaseURL + '/api/upload', true);\n        xhr.setRequestHeader(\"Accept\", \"application/json\");\n        xhr.onload = handler;\n        xhr.send(formData);\n\n        function handler(e) {\n            console.log(e);\n        }\n\n        // $http({\n        //     url: \"http://localhost:4500/upload\",\n        //     method: \"POST\",\n        //     transformRequest: angular.identity,\n        //     header: {\n        //         \"Content-Type\": undefined,\n        //     },\n        //     data: formData\n        // }).then(response => {\n        //     console.log(response);\n        // }, error => {\n        //     console.log(error);\n        // });\n\n    };\n\n    $scope.postComment = function () {\n\n        var data = {\n            username: $scope.username,\n            message: $scope.commentToPost\n        };\n\n        $http({\n            url: serverBaseURL + '/api/comments',\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\"\n            },\n            data: JSON.stringify(data)\n\n        }).then(function (response) {\n            console.log(response);\n        }, function (response) {\n            console.log(response);\n        });\n    };\n\n    $scope.onPresetCancel = function () {\n        $(\".save-preset-container\").remove();\n    };\n\n    $scope.onPresetSave = function () {\n        $scope.savePreset();\n    };\n\n    /*\n     * ---------------------------------------------------------------------------------------\n     * private\n     * ---------------------------------------------------------------------------------------\n     */\n\n    function removeTrack(track) {\n        drumMachine.removeTrack(track.id);\n    }\n\n    function initDefaultTracks($scope, drumMachine) {\n\n        enableLoadingSpinner();\n\n        drumMachine._loadDefaultBuffers().then(function () {\n            drumMachine._initDefaultTracks();\n            $scope.tracks = drumMachine.tracks;\n            $scope.$apply();\n            disableLoadingSpinner();\n        }, function (error) {\n            console.log(error);\n        });\n    }\n\n    function initDATgui(drumMachine) {\n        var gui = new dat.GUI();\n        var bpmController = gui.add(drumMachine, \"bpm\", 50.0, 220.0);\n\n        bpmController.onChange(function (value) {\n            drumMachine.bpm = Math.floor(drumMachine.bpm);\n        });\n    }\n\n    function initSequencerControls(scope, drumMachine) {\n\n        playBtn.on(\"mousedown touchstart\", function (e) {\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            playBtn.css({\n                backgroundColor: \"#444\"\n            });\n        });\n\n        playBtn.on(\"mouseup touchend\", function (e) {\n            play(e);\n        });\n\n        stopBtn.on(\"mousedown touchstart\", function (e) {\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            stopBtn.css({\n                backgroundColor: \"#444\"\n            });\n        });\n\n        stopBtn.on(\"mouseup touchend\", function (e) {\n            stop(e);\n        });\n\n        bpmSlider.slider({\n            min: drumMachine.bpmMin,\n            max: drumMachine.bpmMax,\n            orientation: \"horizontal\",\n            value: scope.bpm,\n            slide: function slide(event, ui) {\n                drumMachine.bpm = ui.value;\n                scope.bpm = ui.value;\n                scope.$apply();\n            }\n        }).draggable();\n\n        scope.updateSlider = function () {\n            if (drumMachine.isInRangeBPM(scope.bpm)) {\n                bpmSlider.slider(\"value\", scope.bpm);\n                drumMachine.bpm = scope.bpm;\n            }\n        };\n    }\n\n    function play(e) {\n        if (e) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n\n        // playBtn.css({\n        //     backgroundColor: \"transparent\",\n        //     backgroundImage: \"url(./app/assets/icons/Play-50-green.png)\"\n        // });\n        //\n        // stopBtn.css({\n        //     backgroundColor: \"transparent\",\n        //     backgroundImage: \"url(./app/assets/icons/Stop-50-white.png)\"\n        // });\n\n        stopBtn.removeClass(\"sequencer-stop-active\");\n        playBtn.removeClass(\"sequencer-play-inactive\");\n\n        stopBtn.addClass(\"sequencer-stop-inactive\");\n        playBtn.addClass(\"sequencer-play-active\");\n\n        playBtn.css({\n            backgroundColor: \"transparent\"\n        });\n\n        stopBtn.css({\n            backgroundColor: \"transparent\"\n        });\n\n        $scope.startSequencer();\n    }\n\n    function stop(e) {\n        if (e) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n\n        // stopBtn.css({\n        //     backgroundColor: \"transparent\",\n        //     backgroundImage: \"url(./app/assets/icons/Stop-50-red.png)\"\n        // });\n        //\n        // playBtn.css({\n        //     backgroundColor: \"transparent\",\n        //     backgroundImage: \"url(./app/assets/icons/Play-50-white.png)\"\n        // });\n\n        playBtn.removeClass(\"sequencer-play-active\");\n        stopBtn.removeClass(\"sequencer-stop-inactive\");\n        playBtn.addClass(\"sequencer-play-inactive\");\n        stopBtn.addClass(\"sequencer-stop-active\");\n\n        playBtn.css({\n            backgroundColor: \"transparent\"\n        });\n\n        stopBtn.css({\n            backgroundColor: \"transparent\"\n        });\n\n        $scope.stopSequencer();\n    }\n\n    function loadPreset(data) {\n        window.scrollTo(0, 0);\n        enableLoadingSpinner();\n\n        drumMachine.loadPreset(data).then(function (tracks) {\n\n            tracks.forEach(function (t) {\n                drumMachine.tracks[t.id] = t;\n            });\n\n            $scope.bpm = drumMachine.bpm;\n            bpmSlider.slider(\"value\", $scope.bpm);\n            $scope.preset.name = data.name;\n            $(\"#presetTitle\").text($scope.preset.name);\n            $scope.safeApply();\n            disableLoadingSpinner();\n        }, function (error) {\n            console.log(error);\n        });\n    }\n\n    function initExportMidiMenu() {\n\n        var API = $(\"nav#menu\").data(\"mmenu\");\n        var li = $('<li><a href=\"#exportMidi\" >Export midi</a></li>');\n        li.click($scope.exportMidi);\n\n        $(\"#menu-list\").find(\".mm-listview\").append(li);\n\n        API.initPanels($(\"#menu-list\"));\n    }\n\n    function initPresetsMenu(categories) {\n\n        $('li[id=\"presetsMenu\"]').remove();\n\n        $http({\n            url: serverBaseURL + \"/api/presets\",\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n        }).then(function (response) {\n\n            var presetsData = response.data;\n            if (presetsData.length === 0) {\n                return;\n            }\n\n            var liParent = $('<li id=\"presetsMenu\"><a href=\"#\">Presets</a></li>');\n            var ulParent = $(\"<ul></ul>\");\n            liParent.append(ulParent);\n\n            categories.forEach(function (category) {\n\n                var match = presetsData.find(function (e) {\n                    return e._id === category.name;\n                });\n\n                if (!match) {\n                    return;\n                }\n\n                var categoryPresets = match.presets;\n\n                var liCategory = $('<li><a href=\"#\">' + category.name + '</a></li>');\n                var ul = $(\"<ul></ul>\");\n\n                categoryPresets.forEach(function (preset) {\n                    var li = $('<li><a href=\"#\">' + preset.name + '</a></li>');\n                    li.click(function () {\n                        loadPreset(preset);\n                    });\n\n                    ul.append(li);\n                });\n\n                liCategory.append(ul);\n                ulParent.append(liCategory);\n            });\n\n            var API = $(\"nav#menu\").data(\"mmenu\");\n            $(\"#menu-list\").find(\".mm-listview li:first\").after(liParent);\n            API.initPanels($(\"#menu-list\"));\n        }, function (errorResponse) {\n            console.log(errorResponse);\n            initExportMidiMenu();\n        });\n    }\n\n    function initSavePresetMenu() {\n        var li = $('<li><a href=\"#\">Save preset</a></li>');\n\n        li.click(function () {\n            var savePreset = angular.element(document.createElement('save-preset'));\n            var domElem = $compile(savePreset)($scope);\n            angular.element(document.body).append(domElem);\n        });\n\n        var API = $(\"nav#menu\").data(\"mmenu\");\n        $(\"#menu-list\").find(\".mm-listview\").append(li);\n        API.initPanels($(\"#menu-list\"));\n    }\n\n    function loadComments() {\n\n        enableCommentsLoadingSpinner();\n\n        $http({\n            url: serverBaseURL + '/api/comments',\n            method: \"GET\",\n            headers: {\n                \"Accept\": \"application/json\"\n            }\n\n        }).then(function (response) {\n            console.log(response);\n            $scope.comments = response.data;\n            $scope.safeApply();\n            disableCommentsLoadingSpinner();\n        }, function (response) {\n            console.log(response);\n        });\n    }\n\n    function enableLoadingSpinner() {\n        setTimeout(function () {\n            window.scrollTo(0, 0);\n            loadingContainer.addClass(\"loading-active\");\n        }, 0);\n    }\n\n    function disableLoadingSpinner() {\n        setTimeout(function () {\n            window.scrollTo(0, 0);\n            loadingContainer.removeClass(\"loading-active\");\n        }, 1500);\n    }\n\n    function enableCommentsLoadingSpinner() {\n        setTimeout(function () {\n            commentsLoadingOverlay.addClass(\"loading-active\");\n            commentsLoadingSpinner.addClass(\"loading-active\");\n        }, 0);\n    }\n\n    function disableCommentsLoadingSpinner() {\n        setTimeout(function () {\n            commentsLoadingOverlay.removeClass(\"loading-active\");\n            commentsLoadingSpinner.removeClass(\"loading-active\");\n        }, 100);\n    }\n\n    function toastError(text) {\n        $.toast({\n            text: text,\n            showHideTransition: 'slide', // It can be plain, fade or slide\n            bgColor: '#ff4a40', // Background color for toast\n            textColor: '#fff', // text color\n            allowToastClose: false, // Show the close button or not\n            hideAfter: 3000, // `false` to make it sticky or time in miliseconds to hide after\n            stack: 5, // `fakse` to show one stack at a time count showing the number of toasts that can be shown at once\n            textAlign: 'left', // Alignment of text i.e. left, right, center\n            position: 'top-right' // bottom-left or bottom-right or bottom-center or top-left or top-right or top-center or mid-center or an object representing the left, right, top, bottom values to position the toast on page\n        });\n    }\n\n    function toastOk(text) {\n        $.toast({\n            text: text,\n            showHideTransition: 'slide', // It can be plain, fade or slide\n            bgColor: '#05a2fc', // Background color for toast\n            textColor: '#fff', // text color\n            allowToastClose: false, // Show the close button or not\n            hideAfter: 3000, // `false` to make it sticky or time in miliseconds to hide after\n            stack: 5, // `fakse` to show one stack at a time count showing the number of toasts that can be shown at once\n            textAlign: 'left', // Alignment of text i.e. left, right, center\n            position: 'top-right' // bottom-left or bottom-right or bottom-center or top-left or top-right or top-center or mid-center or an object representing the left, right, top, bottom values to position the toast on page\n        });\n    }\n\n    /**\n     * ---------------------------------------------------------------------------------------\n     * init\n     * ---------------------------------------------------------------------------------------\n     */\n\n    var socket = io.connect(serverBaseURL);\n    initSequencerControls($scope, drumMachine);\n    loadPreset(_presets.groovyRockPreset);\n    window.scrollTo(0, 0);\n\n    $(window).ready(function () {\n        window.scrollTo(0, 0);\n        initSavePresetMenu();\n        initExportMidiMenu();\n\n        $scope.populateCategories().then(function (categories) {\n            initPresetsMenu(categories);\n        });\n\n        $interval(function () {\n            $scope.populateCategories().then(function (categories) {\n                console.log(\"$interval: populateCategories\");\n            });\n        }, 20000);\n\n        socket.on(socketEvents.newPreset, function (data) {\n            console.log(socketEvents.newPreset, data);\n            initPresetsMenu($scope.preset.categories);\n        });\n\n        socket.on(socketEvents.newComment, function (comment) {\n            // toastOk(\"Comment posted!\");\n            $scope.comments.splice(0, 0, comment);\n            $scope.commentToPost = \"\";\n            $scope.commentForm.$setPristine();\n            $scope.safeApply();\n        });\n    });\n}\n},{\"../../audio/DrumMachine\":2,\"../../audio/audio-loader\":5,\"../../audio/presets\":6}],8:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.testController = testController;\n/*\n * ---------------------------------------------------------------------------------------\n * testController.js\n * ---------------------------------------------------------------------------------------\n */\n\nfunction testController($scope) {\n\n    $scope.title = \"Test Controller\";\n    console.log(\"Test Controller\");\n}\n},{}],9:[function(require,module,exports){\n/**\n * ---------------------------------------------------------------------------------------\n * commentDirective.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.commentDirective = commentDirective;\nfunction commentDirective() {\n\n    return {\n        restrict: 'AE',\n        replace: 'false',\n        templateUrl: \"app/directives/templates/commentDirective.html\",\n        link: function link(scope, elem, attrs) {}\n    };\n}\n},{}],10:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.loadSamples = loadSamples;\n\nvar _audioLoader = require(\"../audio/audio-loader\");\n\n\"use strict\"; /**\n               * ---------------------------------------------------------------------------------------\n               * loadSoundsDirective.js\n               * ---------------------------------------------------------------------------------------\n               */\n\nfunction loadSamples($http, supportedAudioFormats) {\n\n    var serverBaseURL = \"https://groovyera.herokuapp.com\";\n\n    return {\n        restrict: 'AE',\n        replace: 'false',\n        // scope: {\n        //     samplesData: \"=\"\n        // },\n        templateUrl: \"app/directives/templates/loadSamples.html\",\n        link: function link(scope, elem, attrs) {\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * styles & widgets\n             * ---------------------------------------------------------------------------------------\n             */\n\n            function initUI() {\n                $(\".samples-accordion\").accordion({\n                    animate: 200,\n                    collapsible: true,\n                    active: false,\n                    heightStyle: \"content\"\n                });\n\n                elem.find('button[name=\"playSampleButton\"]').button({\n                    icon: \"ui-icon-circle-triangle-e\",\n                    showLabel: false\n                });\n\n                elem.find('button[name=\"loadSampleButton\"]').button({\n                    icon: \"ui-icon-check\",\n                    showLabel: false\n                });\n\n                elem.find('button[id=\"samplesCancelBtn\"]').button();\n\n                elem.css(\"display\", \"block\");\n\n                scope.disableLoadingSpinner();\n            }\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * event listeners\n             * ---------------------------------------------------------------------------------------\n             */\n\n            function addEvents() {}\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * functions\n             * ---------------------------------------------------------------------------------------\n             */\n\n            scope.close = function () {\n                $(\"#angularView\").css(\"display\", \"block\");\n                elem.remove();\n            };\n\n            scope.playSampleFromServer = function (sample) {\n                if (!sample) return;\n\n                if (scope.samplesBuffers.hasOwnProperty(sample.path)) {\n                    var buffer = scope.samplesBuffers[sample.path];\n                    scope.playSoundFromBuffer(buffer);\n                } else {\n                    scope.audioLoader(scope.audioContext, sample.path).then(function (buffer) {\n                        scope.samplesBuffers[sample.path] = buffer;\n                        scope.playSoundFromBuffer(buffer);\n                    });\n                }\n            };\n\n            scope.loadSampleOnTrack = function (sample) {\n                if (!sample) return;\n\n                (0, _audioLoader.getArrayBuffer)(scope.audioContext, sample.path).then(function (arrayBuffer) {\n                    scope.track.setSampleData(sample.name, arrayBuffer);\n                    scope.close();\n                });\n            };\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * init\n             * ---------------------------------------------------------------------------------------\n             */\n\n            function init() {\n                // hide content behind\n                $(\"#angularView\").css(\"display\", \"none\");\n\n                var intervalID = setInterval(function () {\n\n                    var result = $(\".samples-accordion\");\n\n                    if (result.length > 0) {\n\n                        clearInterval(intervalID);\n\n                        initUI();\n                        addEvents();\n                    }\n                }, 200);\n            }\n\n            init();\n        }\n    };\n}\n},{\"../audio/audio-loader\":5}],11:[function(require,module,exports){\n/**\n * ---------------------------------------------------------------------------------------\n * savePresetDirective.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.savePresetDirective = savePresetDirective;\nfunction savePresetDirective() {\n\n    return {\n        restrict: 'AE',\n        replace: 'false',\n        templateUrl: \"app/directives/templates/savePreset.html\",\n        link: function link(scope, elem, attrs) {\n\n            scope.tagHandler = function (tag) {\n                return null;\n            };\n\n            scope.invalidPresetNameMessage = \"Choose a preset name (4-24 characters)\";\n            scope.invalidCategoryMessage = \"Choose a category\";\n\n            function initUI() {\n\n                $(\"#presetCancelBtn\").button();\n                $(\"#presetSaveBtn\").button();\n            }\n\n            /**\n             * ---------------------------------------------------------------------------------------\n             * init\n             * ---------------------------------------------------------------------------------------\n             */\n\n            initUI();\n        }\n\n    };\n}\n},{}],12:[function(require,module,exports){\n/**\n * ---------------------------------------------------------------------------------------\n * tickSliderDirective.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.tickSliderDirective = tickSliderDirective;\nfunction tickSliderDirective() {\n\n    return {\n        restrict: 'AE',\n        replace: 'false',\n        scope: {\n            tick: \"=\",\n            ticksElements: \"=\",\n            resizeTick: \"=\"\n        },\n        link: function link(scope, elem, attrs) {\n\n            // console.log(scope.tick);\n            scope.ticksElements.push(elem);\n\n            elem.slider({\n                min: 0,\n                max: 100,\n                orientation: \"vertical\",\n                value: scope.tick.active ? scope.tick.volume * 100 : 0,\n                slide: function slide(event, ui) {\n\n                    if (ui.value === 0) {\n                        scope.tick.active = false;\n                    } else {\n                        scope.tick.active = true;\n                    }\n\n                    scope.tick.volume = ui.value * 0.01;\n                    // console.log(scope.tick.volume);\n                }\n            }).draggable();\n\n            // scope.resizeTick(elem);\n        }\n    };\n}\n},{}],13:[function(require,module,exports){\n/**\n * ---------------------------------------------------------------------------------------\n * trackDirective\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.trackDirective = trackDirective;\n\nvar _utils = require(\"../utils/utils\");\n\nfunction trackDirective($http, $compile, supportedAudioFormats) {\n\n    return {\n        restrict: 'AE',\n        replace: 'false',\n        scope: {\n            track: \"=\",\n            ticksElements: \"=\",\n            samplesData: \"=\",\n            samplesBuffers: \"=\",\n            removeTrack: \"=\",\n            audioContext: \"=\",\n            audioLoader: \"=\",\n            playSoundFromBuffer: \"=\",\n            enableLoadingSpinner: \"=\",\n            disableLoadingSpinner: \"=\"\n        },\n        templateUrl: \"app/directives/templates/trackDirective.html\",\n        link: function link(scope, elem, attrs) {\n\n            var serverBaseURL = \"https://groovyera.herokuapp.com\";\n\n            scope.resizeTick = resizeTick;\n            scope.handleFiles = handleFiles;\n            scope.playSound = playSound;\n            scope.onSoloTrack = onSoloTrack;\n            scope.onMuteTrack = onMuteTrack;\n            scope.loadSamplesFromServer = loadSamplesFromServer;\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * styles & widgets\n             * ---------------------------------------------------------------------------------------\n             */\n\n            elem.find('button[name=\"removeTrackButton\"]').button({\n                icon: \"ui-icon-close\",\n                showLabel: false\n            });\n\n            elem.find('button[name=\"playSoundButton\"]').button({\n                icon: \"ui-icon-circle-triangle-e\",\n                showLabel: false\n            });\n\n            elem.find('button[name=\"loadSoundFromServerBtn\"]').button();\n\n            elem.find('div[id=\"trackVolumeSlider\"]').slider({\n                min: 0,\n                max: 100,\n                orientation: \"horizontal\",\n                value: scope.track.gainNode.gain.value * 100,\n                slide: function slide(event, ui) {\n                    scope.track.gainNode.gain.value = ui.value * 0.01;\n                }\n            }).draggable();\n\n            if (scope.track.pannerNodeSupported) {\n                elem.find('div[id=\"trackPanSlider\"]').slider({\n                    min: -100,\n                    max: 100,\n                    orientation: \"horizontal\",\n                    value: scope.track.pannerNode.pan.value * 100,\n                    slide: function slide(event, ui) {\n                        scope.track.pannerNode.pan.value = ui.value * 0.01;\n                    }\n                }).draggable();\n            } else {\n                elem.find('div[id=\"trackPanSlider\"]').remove();\n                elem.find(\".pan-label\").remove();\n\n                // push down volume slider\n                elem.find('div[id=\"trackVolumeSlider\"]').css({\n                    // marginTop: 0,\n                    // position: \"relative\",\n                    // bottom: 0\n                });\n            }\n\n            elem.find('button[name=\"soloTrackButton\"]').button();\n\n            elem.find('button[name=\"muteTrackButton\"]').button();\n\n            elem.find('button[name=\"loadSoundFromServerBtn\"]').button({\n                showLabel: false,\n                icon: \"ui-icon-volume-on\"\n            });\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * event listeners\n             * ---------------------------------------------------------------------------------------\n             */\n\n            scope.$on(\"$destroy\", function () {\n                elem.unbind(\"dragover\", onDragOver);\n                elem.unbind(\"drop\", onDrop);\n                elem.unbind(\"dragleave\", onDragLeave);\n            });\n\n            elem.on(\"dragover\", onDragOver);\n            elem.on(\"drop\", onDrop);\n            elem.on(\"dragleave\", onDragLeave);\n\n            /*\n             * ---------------------------------------------------------------------------------------\n             * private functions\n             * ---------------------------------------------------------------------------------------\n             */\n\n            function resizeTick(tickElem) {\n                var ticksContainerWidth = elem.find(\".ticks-container\").width();\n                console.log(ticksContainerWidth);\n                var margin = 8;\n                var tickWidth = Math.floor((ticksContainerWidth - 15 * margin) / 16.0);\n\n                // tickElem.css({\n                //     width: 32,\n                //     marginRight: \"8px !important\"\n                // });\n\n\n                // tickElem.parent().css({\n                //     width: tickWidth,\n                //     marginRight: margin\n                // });\n\n\n                // tickElem.find(\".ui-slider-handle\").css({\n                //\n                // });\n            }\n\n            function handleFiles(files) {\n                if (!files || files.length < 1) return;\n\n                var file = files[0];\n                var fileExtension = (0, _utils.getFileExtension)(file.name);\n\n                // chech if it is an audio file with a supported extension\n                if (!supportedAudioFormats.has(fileExtension)) {\n                    console.log(\"File format not supported by Web Audio API: \", fileExtension);\n                    return;\n                }\n\n                var reader = new FileReader();\n\n                reader.onload = function (ev) {\n                    var arrayBuffer = ev.target.result;\n                    scope.track.setSampleData(file.name, arrayBuffer);\n                };\n\n                reader.readAsArrayBuffer(file);\n            }\n\n            function onDragOver(e) {\n                if (!elem.hasClass(\"track-dragfile\")) {\n                    elem.addClass(\"track-dragfile\");\n                }\n                e.stopPropagation();\n                e.preventDefault();\n            }\n\n            function onDrop(e) {\n                e.stopPropagation();\n                e.preventDefault();\n                handleFiles(e.originalEvent.dataTransfer.files);\n                onDragLeave();\n            }\n\n            function onDragLeave(e) {\n                if (elem.hasClass(\"track-dragfile\")) {\n                    elem.removeClass(\"track-dragfile\");\n                }\n                if (e) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                }\n            }\n\n            function playSound() {\n                scope.track.playLoadedSample();\n            }\n\n            function onSoloTrack() {\n                scope.track.drumMachine.soloTrack(scope.track.id);\n            }\n\n            function onMuteTrack() {\n                scope.track.drumMachine.muteTrack(scope.track.id);\n            }\n\n            function loadSamplesFromServer() {\n\n                scope.enableLoadingSpinner();\n\n                $http({\n                    url: serverBaseURL + \"/api/samples\",\n                    method: \"GET\",\n                    headers: {\n                        \"Accept\": \"application/json\"\n                    }\n                }).then(function (response) {\n\n                    scope.samplesData = response.data;\n\n                    var loadSamplesElem = $('<load-samples></load-samples>');\n                    var el = $compile(loadSamplesElem)(scope);\n                    $(\"body\").append(el);\n                });\n            }\n        }\n    };\n}\n},{\"../utils/utils\":15}],14:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.initRoutes = initRoutes;\n/*\n * ---------------------------------------------------------------------------------------\n * routes.js\n * ---------------------------------------------------------------------------------------\n */\n\nfunction initRoutes($routeProvider) {\n\n    $routeProvider.when('/', {\n        controller: \"drumMachineController\",\n        templateUrl: \"app/components/drum-machine/drumMachineView.html\"\n    });\n\n    $routeProvider.when('/test', {\n        controller: \"testController\",\n        templateUrl: \"app/components/test/testView.html\"\n    });\n\n    $routeProvider.otherwise({ redirectTo: '/' });\n}\n},{}],15:[function(require,module,exports){\n/*\n * ---------------------------------------------------------------------------------------\n * utils.js\n * ---------------------------------------------------------------------------------------\n */\n\n\"use strict\";\n\n/*\n * checkIfiOSdevice\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.checkIfiOSdevice = checkIfiOSdevice;\nexports.guid = guid;\nexports.getExtensionFromFileName = getExtensionFromFileName;\nexports.getFileNameFromPath = getFileNameFromPath;\nexports.getArrayAudioBufferFromUrl = getArrayAudioBufferFromUrl;\nexports.getFileExtension = getFileExtension;\nfunction checkIfiOSdevice() {\n    return (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream\n    );\n}\n\n/*\n * generate uuid\n */\nfunction guid() {\n    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = Math.random() * 16 | 0,\n            v = c == 'x' ? r : r & 0x3 | 0x8;\n        return v.toString(16);\n    });\n    return uuid;\n}\n\nfunction getExtensionFromFileName(fileName) {\n    var re = /(?:\\.([^.]+))?$/;\n    var ext = re.exec(fileName)[1];\n    return ext;\n}\n\nfunction getFileNameFromPath(path) {\n    return path.replace(/^.*[\\\\\\/]/, '');\n}\n\nfunction getArrayAudioBufferFromUrl(audioCtx, url) {\n\n    return new Promise(function (resolve, reject) {\n\n        if (!audioCtx) {\n            reject(\"Missing audio context parameter.\");\n            return;\n        }\n\n        if (!url) {\n            reject(\"Missing url parameter\");\n            return;\n        }\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(\"GET\", url);\n        xhr.responseType = \"arraybuffer\";\n\n        xhr.onload = function () {\n            resolve(xhr.response);\n        };\n\n        xhr.send();\n    });\n}\n\nfunction getFileExtension(fileName) {\n    return fileName.substr(fileName.lastIndexOf('.') + 1);\n}\n},{}]},{},[1]);\n"]}